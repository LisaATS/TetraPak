ApplyLicence As screen:
    Height: =//Max(App.Height, App.MinScreenHeight)
    OnVisible: |+
        =
        
        ClearCollect(Factory,Distinct(ShowColumns(Filter(TPL_Login,IsFactoryDirector=true),"FactoryName"),FactoryName));
        //整合搜索用户&无账号人员姓名
        
        Set(Ispatch,true);
        Set(isTimeWrong,false);
        
        //判断当前状态时新建还是修改
        Switch(
            JudgeEditMode,
            "New",//如果是新建审批单，清空
            false
        /*Reset(Dropdown_EndTime_1);
        Reset(Dropdown_AppliDept);
        Reset(TextInput_OpDirector_2);
        Reset(TextInput_OpUnit_6);
        Reset(TextInput_OpUnit);
        Reset(TextInput_ProjLeder);
        Reset('TextInput_ProjLederM/P');
        Reset(TextInput_OpDirector);
        Reset('TextInput_OpDirectorM/P');
        Reset(ComboBox_OnSiteGuardian);
        Reset('TextInputTextInput_OnSiteGuardianM/P');
        Reset(DatePicker_StartDate);
        Reset(Dropdown_StartTime);
        Reset(DatePicker_EndDate);
        Reset(Dropdown_EndTime);
        Reset(Dropdown_StartTime_1);
        Reset(TextInput_OpAr);
        Reset(TextInput_MainTools);
        Reset(Checkbox_Heights);
        Reset(Checkbox_Hoisting);
        Reset(Checkbox_Limited);
        Reset(Checkbox_HotWork);
        Reset(Checkbox_TemporaryElectricity);
        Reset(TextInput_OpCountent);
        Reset(Radio_IsPatrol);
        Reset(DataCardValue17_1);
        Reset(DataCardValue17);
        Reset(ComboBox1);
        Reset(TextInput_OtherCoWoker);
        Set(Vis_Current,"Normal");
        
        
        
        //创建一条新的申请界面
        Set(NewProjID,First(Sort(TPL_NormalLicence,ProjID,SortOrder.Descending)).ProjID+1);
        
        ClearCollect(
            Licences, 
            {LicenceN: "Normal", State: true },
            {LicenceN: "High", State: Checkbox_Heights.Value },
            {LicenceN: "Lifting", State: Checkbox_Hoisting.Value },
            {LicenceN: "Confined Space", State: Checkbox_Limited.Value },
            {LicenceN: "Hot", State: Checkbox_HotWork.Value },
            {LicenceN: "Temporary Electricity", State: Checkbox_TemporaryElectricity.Value }
        );
        
        //各个作业安全控制条例
        ClearCollect(Gal_HighWorkSafetyControl,AddColumns(Sort(Filter(TPL_SafetyControl,Not(IsBlank(Content))&&LicenseType="High Work Permit"),ID,SortOrder.Ascending),"Confirm",false));
        ClearCollect(Gal_ConfinedSpaceSafetyControl,AddColumns(Sort(Filter(TPL_SafetyControl,Not(IsBlank(Content))&&LicenseType="Confined Space Work Permit"),ID,SortOrder.Ascending),"Confirm",false));
        ClearCollect(Gal_LiftingWorkControl,AddColumns(Sort(Filter(TPL_SafetyControl,Not(IsBlank(Content))&&LicenseType="Lifting Work Permit"),ID,SortOrder.Ascending),"Confirm",false));
        ClearCollect(Gal_HotWorkSafetyControl,AddColumns(Sort(Filter(TPL_SafetyControl,Not(IsBlank(Content))&&LicenseType="Hot Work"),ID,SortOrder.Ascending),"Confirm",false));
        ClearCollect(Gal_TemporaryElectricityUseWorkSafetyControl,AddColumns(Sort(Filter(TPL_SafetyControl,Not(IsBlank(Content))&&LicenseType="Temporary Electricity Use Work Permit"),ID,SortOrder.Ascending),"Confirm",false));
        
        //High表初始化
        ClearCollect(
            HW_Tools, 
            {ToolsN: "自动升降平台/曲臂车", State: Checkbox_Tools1.Value },
            {ToolsN: "脚手架", State: Checkbox_Tools2.Value },
            {ToolsN: "梯子", State: Checkbox_Tools3.Value }
        );
        Clear(Gal_CollectMsg);
        Clear(Gal_HW_NameID);
        Clear(Gal_LW_EquipmentsID);
        Clear(Gal_LW_NameID);
        Clear(Gal_LW_CommanderID);
        Clear(Gal_FW_NameID);
        Clear(Gal_TEU_NameID);
        
        //2
        Reset(Radio_HWLevel);
        Reset(TextInput_HWHazard1);
        Reset(TextInput_HWHazard2);
        Reset(TextInput_HWHazard3);
        Reset(Checkbox_Tools1);
        Reset(Checkbox_Tools2);
        Reset(Checkbox_Tools3);
        Reset(TextInput_HWOtherTools);
        Reset(DataCardValue_ConstructionSchemeHigh);
        
        //3
        Reset(TextInput_SuspendedObject);
        Reset(TextInput_SuspendedObjectWeight);
        Reset(TextInput_LiftingCapacity);
        Reset(TextInput_LWHazard1);
        Reset(TextInput_LWHazard2);
        Reset(TextInput_LWHazard3);
        Reset(DataCardValue_ConstructionSchemeLifting);
        
        //4
        Reset(TextInput_CSW_Worker);
        Reset(TextInput_CSWHazard1);
        Reset(TextInput_CSWHazard2);
        Reset(TextInput_CSWHazard3);
        Reset(DataCardValue_ConstructionSchemeConfined);
        Reset(TextInput_Ventilation);
        
        //5
        Reset(TextInput_FWHazard1);
        Reset(TextInput_FWHazard2);
        Reset(TextInput_FWHazard3);
        Reset(TextInput_FWTools);
        Reset(Radio_FWLevel);
        Reset(TextInput_FWHazard1_4);
        Reset(TextInput_FWHazard1_5);
        Reset(TextInput_FWHazard1_6);
        Reset(Dropdown_OpDept_4);
        Reset(DataCardValue_ConstructionSchemeHot);
        Reset(TextInput_FWOtherTool);
        Reset(TextInput_FWOtherToolNumber);
        
        //6
        Reset(TextInput_TotalLoad);
        Reset(TextInput_WorkingVoltage);
        Reset(TextInput_PowerAccessPoint);
        Reset(TextInput_TEUHazard1);
        Reset(TextInput_TEUHazard2);
        Reset(TextInput_TEUHazard3);
        Reset(DataCardValue_ConstructionSchemeTemporaryElectricity);
        
        Set(Ispatch,true)*/
        ,
        "Change",//如果是修改审批单
        ClearCollect(
            Licences, 
            {LicenceN: "Normal", State: true },
            {LicenceN: "High", State: Checkbox_Heights.Value },
            {LicenceN: "Lifting", State: Checkbox_Hoisting.Value },
            {LicenceN: "Confined Space", State: Checkbox_Limited.Value },
            {LicenceN: "Hot", State: Checkbox_HotWork.Value },
            {LicenceN: "Temporary Electricity", State: Checkbox_TemporaryElectricity.Value }
        );
        )
        
        
        
        

    Btn_Clean1 As button:
        BorderThickness: =1
        DisplayMode: =
        FocusedBorderThickness: =1
        FontWeight: =FontWeight.Normal
        Height: =28
        OnSelect: |-
            =Reset(Dropdown_EndTime_1);
            Reset(Dropdown_AppliDept);
            Reset(TextInput_OpDirector_2);
            Reset(TextInput_OpUnit_6);
            Reset(TextInput_OpUnit);
            Reset(TextInput_ProjLeder);
            Reset('TextInput_ProjLederM/P');
            Reset(TextInput_OpDirector);
            Reset('TextInput_OpDirectorM/P');
            Reset(ComboBox_OnSiteGuardian);
            Reset('TextInputTextInput_OnSiteGuardianM/P');
            Reset(DatePicker_StartDate);
            Reset(Dropdown_StartTime);
            Reset(DatePicker_EndDate);
            Reset(Dropdown_EndTime);
            Reset(Dropdown_StartTime_1);
            Reset(TextInput_OpAr);
            Reset(TextInput_MainTools);
            Reset(Checkbox_Heights);
            Reset(Checkbox_Hoisting);
            Reset(Checkbox_Limited);
            Reset(Checkbox_HotWork);
            Reset(Checkbox_TemporaryElectricity);
            Reset(TextInput_OpCountent);
            Reset(Radio_IsPatrol);
            Reset(DataCardValue17_1);
            Reset(DataCardValue17);
            Reset(ComboBox1);
            Reset(TextInput_OtherCoWoker);
            Reset(Radio_IsBackup);
            Set(Vis_Current,"Normal");
            
            
            
            
            //创建一条新的申请界面
            Set(NewProjID,First(Sort(TPL_NormalLicence,ProjID,SortOrder.Descending)).ProjID+1);
            
            ClearCollect(
                Licences, 
                {LicenceN: "Normal", State: true },
                {LicenceN: "High", State: Checkbox_Heights.Value },
                {LicenceN: "Lifting", State: Checkbox_Hoisting.Value },
                {LicenceN: "Confined Space", State: Checkbox_Limited.Value },
                {LicenceN: "Hot", State: Checkbox_HotWork.Value },
                {LicenceN: "Temporary Electricity", State: Checkbox_TemporaryElectricity.Value }
            );
            
            //各个作业安全控制条例
            ClearCollect(Gal_HighWorkSafetyControl,AddColumns(Sort(Filter(TPL_SafetyControl,Not(IsBlank(Content))&&LicenseType="High Work Permit"),ID,SortOrder.Ascending),"Confirm",false));
            ClearCollect(Gal_ConfinedSpaceSafetyControl,AddColumns(Sort(Filter(TPL_SafetyControl,Not(IsBlank(Content))&&LicenseType="Confined Space Work Permit"),ID,SortOrder.Ascending),"Confirm",false));
            ClearCollect(Gal_LiftingWorkControl,AddColumns(Sort(Filter(TPL_SafetyControl,Not(IsBlank(Content))&&LicenseType="Lifting Work Permit"),ID,SortOrder.Ascending),"Confirm",false));
            ClearCollect(Gal_HotWorkSafetyControl,AddColumns(Sort(Filter(TPL_SafetyControl,Not(IsBlank(Content))&&LicenseType="Hot Work"),ID,SortOrder.Ascending),"Confirm",false));
            ClearCollect(Gal_TemporaryElectricityUseWorkSafetyControl,AddColumns(Sort(Filter(TPL_SafetyControl,Not(IsBlank(Content))&&LicenseType="Temporary Electricity Use Work Permit"),ID,SortOrder.Ascending),"Confirm",false));
            
            //High表初始化
            ClearCollect(
                HW_Tools, 
                {ToolsN: "自动升降平台/曲臂车", State: Checkbox_Tools1.Value },
                {ToolsN: "脚手架", State: Checkbox_Tools2.Value },
                {ToolsN: "梯子", State: Checkbox_Tools3.Value }
            );
            Clear(Gal_CollectMsg);
            Clear(Gal_HW_NameID);
            Clear(Gal_LW_EquipmentsID);
            Clear(Gal_LW_NameID);
            Clear(Gal_LW_CommanderID);
            Clear(Gal_FW_NameID);
            Clear(Gal_TEU_NameID);
            
            //2
            Reset(Radio_HWLevel);
            Reset(TextInput_HWHazard1);
            Reset(TextInput_HWHazard2);
            Reset(TextInput_HWHazard3);
            Reset(Checkbox_Tools1);
            Reset(Checkbox_Tools2);
            Reset(Checkbox_Tools3);
            Reset(TextInput_HWOtherTools);
            Reset(DataCardValue_ConstructionSchemeHigh);
            
            //3
            Reset(TextInput_SuspendedObject);
            Reset(TextInput_SuspendedObjectWeight);
            Reset(TextInput_LiftingCapacity);
            Reset(TextInput_LWHazard1);
            Reset(TextInput_LWHazard2);
            Reset(TextInput_LWHazard3);
            Reset(DataCardValue_ConstructionSchemeLifting);
            
            //4
            Reset(TextInput_CSW_Worker);
            Reset(TextInput_CSWHazard1);
            Reset(TextInput_CSWHazard2);
            Reset(TextInput_CSWHazard3);
            Reset(DataCardValue_ConstructionSchemeConfined);
            Reset(TextInput_Ventilation);
            
            //5
            Reset(TextInput_FWHazard1);
            Reset(TextInput_FWHazard2);
            Reset(TextInput_FWHazard3);
            Reset(TextInput_FWTools);
            Reset(Radio_FWLevel);
            Reset(TextInput_FWHazard1_4);
            Reset(TextInput_FWHazard1_5);
            Reset(TextInput_FWHazard1_6);
            Reset(Dropdown_OpDept_4);
            Reset(DataCardValue_ConstructionSchemeHot);
            Reset(TextInput_FWOtherTool);
            Reset(TextInput_FWOtherToolNumber);
            
            //6
            Reset(TextInput_TotalLoad);
            Reset(TextInput_WorkingVoltage);
            Reset(TextInput_PowerAccessPoint);
            Reset(TextInput_TEUHazard1);
            Reset(TextInput_TEUHazard2);
            Reset(TextInput_TEUHazard3);
            Reset(DataCardValue_ConstructionSchemeTemporaryElectricity);
            
            Set(Ispatch,true);
        RadiusBottomLeft: =2
        RadiusBottomRight: =2
        RadiusTopLeft: =2
        RadiusTopRight: =2
        Size: =12
        Text: ="清空"
        Visible: =Vis_Del
        Width: =102
        X: =4
        Y: =1071
        ZIndex: =2

    Btn_Sub1 As button:
        BorderThickness: =1
        DisplayMode: =
        FocusedBorderThickness: =1
        FontWeight: =FontWeight.Normal
        Height: =28
        OnSelect: |+
            =ClearCollect(Gal_Ispatch,{Value:true});
            If(
                ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                (
                    (DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)>1440||
                DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)<0
                )
                ||
                DateValue(DatePicker_StartDate.SelectedDate)<>Today()
                ),
                Set(isTimeWrong,true),
                Set(isTimeWrong,false)
            );
            
            //normal表为空, 提醒
            //If("Normal" in Concat(Filter(Licences,State=true),LicenceN),
            If(IsBlank(TextInput_OpUnit_6.Text)||IsBlank(TextInput_OpUnit.Text)||IsBlank('TextInput_ProjLederM/P'.Text)||IsBlank(TextInput_OpDirector.Text)||IsBlank('TextInput_OpDirectorM/P'.Text)||IsBlank('TextInputTextInput_OnSiteGuardianM/P'.Text)||IsBlank(TextInput_OpAr.Text)||IsBlank(TextInput_MainTools.Text)||IsBlank(TextInput_OpCountent.Text)||IsBlank(TextInput_OpDirector_2.Text)||IsBlank(Concat(ComboBox1.SelectedItems,";"))||IsBlank(Radio_IsBackup.Selected.Value),
            Notify("请检查Normal表", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}));
            If(isTimeWrong=true,Notify("特种作业只能当天申请，且工作时间不超过24小时", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}));
            If(
                !IsBlank(LookUp(DataCardValue17_1.Attachments,!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")).Name)||
                IsEmpty(DataCardValue17_1.Attachments),//限制上传的文件格式以及文件不为空
                Notify("培训照片请上传图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            );
            If(
                !IsBlank(LookUp(DataCardValue17.Attachments,!EndsWith(ThisRecord.Name,"pdf")&&!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")).Name)||
                IsEmpty(DataCardValue17.Attachments),//限制上传的文件格式以及文件不为空
                Notify("交底材料请上传Pdf或图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            );
            
            
            
            
            //High表为空, 提醒
            If("High" in Concat(Filter(Licences,State=true),LicenceN),
            If(IsBlank(TextInput_HWHazard1.Text)||IsBlank(TextInput_HWHazard2.Text)||IsBlank(TextInput_HWHazard3.Text)||IsBlank(Radio_HWLevel.Selected.Value),
            Notify("请检查High表", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //High表安全控制提醒
            If("High" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery3_8.AllItems,If(IsBlank(ThisRecord.Radio_PatrolTnspection_23.Selected),
            Notify("请确认High表安全控制措施", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))));
            //登高人员信息表不能为空
            If("High" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery5_7.AllItems,If(!IsBlank(ThisRecord.TextInput_HW_Name.Text)&&(ThisRecord.Image_Photo_3.Image<>SampleImage||!IsBlank(ThisRecord.TextInput_HW_ID.Text)),"",Notify("请完善登高作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            If(Gallery5_7.AllItemsCount=0,Notify("请完善登高作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))
            );
            //施工方案不能为空
            /*If("High" in Concat(Filter(Licences,State=true),LicenceN),
            If(
                !IsBlank(LookUp(DataCardValue_ConstructionSchemeHigh.Attachments,!EndsWith(ThisRecord.Name,"pdf")&&!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")&&!EndsWith(ThisRecord.Name,"doc")&&!EndsWith(ThisRecord.Name,"docx")).Name)||
                IsBlank(LookUp(DataCardValue_ConstructionSchemeHigh.Attachments,"" in ThisRecord.Name).Name),//限制上传的文件格式以及文件不为空
                Notify("登高作业施工方案请上传Word/Pdf/图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            ));*/
            
            
            //Lifting表为空, 提醒
            If("Lifting" in Concat(Filter(Licences,State=true),LicenceN),
            If(IsBlank(TextInput_SuspendedObject.Text)||IsBlank(TextInput_SuspendedObjectWeight.Text)||IsBlank(TextInput_LiftingCapacity.Text)||IsBlank(TextInput_LWHazard1.Text)||IsBlank(TextInput_LWHazard2.Text)||IsBlank(TextInput_LWHazard3.Text),
            Notify("请检查Lifting表", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //Lifting表安全控制提醒
            If("Lifting" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery3_7.AllItems,If(IsBlank(ThisRecord.Radio_PatrolTnspection_22.Selected),Notify("请确认Lifting表安全控制措施", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))));
            //吊装设备信息表不能为空
            If("Lifting" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery5_1.AllItems,If(IsBlank(ThisRecord.TextInput_LW_Equipments.Text)||IsBlank(ThisRecord.TextInput_LW_EquipmentsID.Text),Notify("请完善吊装设备信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            If(Gallery5_1.AllItemsCount=0,Notify("请完善吊装设备信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //吊装人员信息表不能为空
            If("Lifting" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery5_2.AllItems,If(!IsBlank(ThisRecord.TextInput_LW_Worker.Text)&&(ThisRecord.Image_Photo_4.Image<>SampleImage||!IsBlank(ThisRecord.TextInput_LW_ID.Text)),"",Notify("请完善吊装作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            If(Gallery5_2.AllItemsCount=0,Notify("请完善吊装作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //吊装指挥人员信息表不能为空
            If("Lifting" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery5_3.AllItems,If(!IsBlank(ThisRecord.TextInput_LW_Commander.Text)&&(ThisRecord.Image_Photo_5.Image<>SampleImage||!IsBlank(ThisRecord.TextInput_LW_CommanderID.Text)),"",Notify("请完善吊装指挥人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            If(Gallery5_3.AllItemsCount=0,Notify("请完善吊装指挥人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //施工方案不能为空
            /*If("Lifting" in Concat(Filter(Licences,State=true),LicenceN),
            If(
                !IsBlank(LookUp(DataCardValue_ConstructionSchemeLifting.Attachments,!EndsWith(ThisRecord.Name,"pdf")&&!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")&&!EndsWith(ThisRecord.Name,"doc")&&!EndsWith(ThisRecord.Name,"docx")).Name)||
                IsBlank(LookUp(DataCardValue_ConstructionSchemeLifting.Attachments,"" in ThisRecord.Name).Name),//限制上传的文件格式以及文件不为空
                Notify("吊装作业施工方案请上传Word/Pdf/图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            ));*/
            
            
            //Confined Space表为空, 提醒
            If("Confined Space" in Concat(Filter(Licences,State=true),LicenceN),
            If(IsBlank(TextInput_CSW_Worker.Text)||IsBlank(TextInput_CSWHazard1.Text)||IsBlank(TextInput_CSWHazard2.Text)||IsBlank(TextInput_CSWHazard3.Text)||IsBlank(TextInput_Ventilation.Text)||IsBlank(TextInput_CSW_Worker.Text),
            Notify("请检查Confined Space表", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //Confined Space表安全控制提醒
            If("Confined Space" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery3_4.AllItems,If(IsBlank(ThisRecord.Radio_PatrolTnspection_19.Selected),Notify("请确认Confined Space表安全控制措施", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))));
            //施工方案不能为空
            /*If("Confined Space" in Concat(Filter(Licences,State=true),LicenceN),
            If(
                !IsBlank(LookUp(DataCardValue_ConstructionSchemeConfined.Attachments,!EndsWith(ThisRecord.Name,"pdf")&&!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")&&!EndsWith(ThisRecord.Name,"doc")&&!EndsWith(ThisRecord.Name,"docx")).Name)||
                IsBlank(LookUp(DataCardValue_ConstructionSchemeConfined.Attachments,"" in ThisRecord.Name).Name),//限制上传的文件格式以及文件不为空
                Notify("有限空间作业施工方案请上传Word/Pdf/图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            ));*/
            
            
            
            
            
            //Hot表为空, 提醒
            If("Hot" in Concat(Filter(Licences,State=true),LicenceN),
            If(IsBlank(TextInput_FWHazard1.Text)||IsBlank(TextInput_FWHazard2.Text)||IsBlank(TextInput_FWHazard3.Text)||IsBlank(TextInput_FWHazard1_4.Text)||IsBlank(TextInput_FWHazard1_5.Text)||IsBlank(TextInput_FWHazard1_6.Text)||IsBlank(Radio_FWLevel.SelectedText)||IsBlank(TextInput_FWTools.Text),
            Notify("请检查Hot表", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //Hot表安全控制提醒
            If("Hot" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery3_5.AllItems,If(IsBlank(ThisRecord.Radio_PatrolTnspection_20.Selected),
            Notify("请确认Hot表安全控制措施", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))));
            //动火作业人员信息不能为空
            If("Hot" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery5_5.AllItems,If(!IsBlank(ThisRecord.TextInput_HW_Worker.Text)&&(ThisRecord.Image_Photo_6.Image<>SampleImage||!IsBlank(ThisRecord.TextInput__HW_ID.Text)),"",Notify("请完善动火作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            If(Gallery5_5.AllItemsCount=0,Notify("请完善动火作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //施工方案不能为空
            /*If("Hot" in Concat(Filter(Licences,State=true),LicenceN),
            If(
                !IsBlank(LookUp(DataCardValue_ConstructionSchemeHot.Attachments,!EndsWith(ThisRecord.Name,"pdf")&&!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")&&!EndsWith(ThisRecord.Name,"doc")&&!EndsWith(ThisRecord.Name,"docx")).Name)||
                IsBlank(LookUp(DataCardValue_ConstructionSchemeHot.Attachments,"" in ThisRecord.Name).Name),//限制上传的文件格式以及文件不为空
                Notify("动火作业施工方案请上传Word/Pdf/图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            ));*/
            
            
            
            
            //Temporary Electricity表为空, 提醒
            If("Temporary Electricity" in Concat(Filter(Licences,State=true),LicenceN),
            If(IsBlank(TextInput_TotalLoad.Text)||IsBlank(TextInput_WorkingVoltage.Text)||IsBlank(TextInput_PowerAccessPoint.Text)||IsBlank(TextInput_TEUHazard1.Text)||IsBlank(TextInput_TEUHazard2.Text)||IsBlank(TextInput_TEUHazard3.Text),
            Notify("请检查Temporary Electricity表", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //Temporary Electricity表安全控制提醒
            If("Temporary Electricity" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery3_6.AllItems,If(IsBlank(ThisRecord.Radio_PatrolTnspection_21.Selected),
            Notify("请确认Temporary Electricity表安全控制措施", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))));
            //临时用电作业人员信息不能为空
            If("Temporary Electricity" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery5_4.AllItems,If(!IsBlank(ThisRecord.TextInput_TEU_Worker.Text)&&(ThisRecord.Image_Photo_7.Image<>SampleImage||!IsBlank(ThisRecord.TextInput_TEU_ID.Text)),"",Notify("临时用电作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            If(Gallery5_4.AllItemsCount=0,Notify("临时用电作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //施工方案不能为空
            /*If("Temporary Electricity" in Concat(Filter(Licences,State=true),LicenceN),
            If(
                !IsBlank(LookUp(DataCardValue_ConstructionSchemeTemporaryElectricity.Attachments,!EndsWith(ThisRecord.Name,"pdf")&&!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")&&!EndsWith(ThisRecord.Name,"doc")&&!EndsWith(ThisRecord.Name,"docx")).Name)||
                IsBlank(LookUp(DataCardValue_ConstructionSchemeTemporaryElectricity.Attachments,"" in ThisRecord.Name).Name),//限制上传的文件格式以及文件不为空
                Notify("临时用电作业施工方案请上传Word/Pdf/图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            ));*/
            
            
            
            
            
            
            
            
            
            
            If(Not("false" in Concat(Gal_Ispatch,Value,";")),
            Set(NewProjID,First(Sort(TPL_NormalLicence,ProjID,SortOrder.Descending)).ProjID+1);//防止重复
            ForAll(Filter(Licences,State=true),
            Switch(LicenceN,
            //上传normal表信息&normoal表人员信息证照上传
            "Normal",
            Patch(TPL_NormalLicence,
            {
                ProjID:NewProjID,//当前项目ID
                ProjName:TextInput_OpUnit_6.Text,//项目名称
                ApplicationDept:Dropdown_AppliDept.Selected.Value,//申请部门
                OpUnit:TextInput_OpUnit.Text,//作业单位
                OpDirector:TextInput_OpDirector.Text,//作业单位负责人
                'OpDirectorM/P':'TextInput_OpDirectorM/P'.Text,
                StartTime:DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0),//结束时间
                ProjLeader:TextInput_ProjLeder.Text,//项目负责人
                'ProjLeaderM/P':'TextInput_ProjLederM/P'.Text,
                OnSiteGuardian:TextInput_OpDirector_2.Text,//现场监护人
                'OnSiteGuardianM/P':'TextInputTextInput_OnSiteGuardianM/P'.Text,
                OpDept:Concat(Col_SortedDept,ThisRecord.Value,";"),//作业区域所在部门
                OpAr:TextInput_OpAr.Text,//详细作业区域
                MainTools:TextInput_MainTools.Text,//主要作业工具
                OtherLicenses:If(CountRows(Filter(Licences,State=true))=1,"无",Concat(Filter(Licences,State=true&&LicenceN<>"Normal"),LicenceN,";")),//用封号;连接特殊许可证作为该字段内容
                OpCountent:TextInput_OpCountent.Text,//施工内容
                IsPatrol:Switch(Radio_IsPatrol.Selected.Value,"是",true,"否",false),//是否巡检
                IsBackUp:Switch(Radio_IsBackup.Selected.Value,"是",true,"否",false),//是否备案
                ProjState:"审批中",//默认审批状态
                NeedFactorDire:If(Radio_FWLevel.Selected.Value="一级"&&First(Filter(Licences,LicenceN="Hot")).State,true,false),//是否需要厂长
                FactoryName:If(Radio_FWLevel.Selected.Value="一级"&&First(Filter(Licences,LicenceN="Hot")).State,Dropdown_OpDept_4.SelectedText.Value,""),//工厂名
                OtherCoWoker:TextInput_OtherCoWoker.Text//其他协作人员
            });
            ForAll(Filter(Gal_CollectMsg,ID_Type<>""),Patch(TPL_InfoGathering,
            {
                ProjID:NewProjID,
                PhotoType:"其他证件",
                Photograph:ThisRecord.Photo,
                Name:ThisRecord.ID_Type
            }));
            ForAll(
            ShowColumns(Col_SortedDept,"Value"),
            Switch(
            ThisRecord.Value,
            "生产",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=NewProjID),{HoaProduce:"作业区域需审批"}),
            "印前",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=NewProjID),{HoaPrepress:"作业区域需审批"}),
            "印刷",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=NewProjID),{HoaPrint:"作业区域需审批"}),
            "复合",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=NewProjID),{HoaComposite:"作业区域需审批"}),
            "分切",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=NewProjID),{HoaCutting:"作业区域需审批"}),
            "维修",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=NewProjID),{HoaMaintenance:"作业区域需审批"}),
            "仓库",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=NewProjID),{HoaWarehouse:"作业区域需审批"}),
            "质量",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=NewProjID),{HoaQuality:"作业区域需审批"}),
            "WCM",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=NewProjID),{HoaWCM:"作业区域需审批"}),
            "CBRE",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=NewProjID),{HoaCBRE:"作业区域需审批"}),
            "EHS",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=NewProjID),{HoaEHS:"作业区域需审批"}))
            );
            //一般施工许可证文件上传
            TPL_UpLoadFile2.Run(
                 {
                     contentBytes: First(DataCardValue17_1.Attachments).Value,
                     //name: First(DataCardValue17_1.Attachments).Name name: NewProjID&"_TrainingPhoto_"&First(Split(First(DataCardValue17_1.Attachments).Name,".")).Value&"."&Last(Split(First(DataCardValue17_1.Attachments).Name,".")).Value
                     name: NewProjID&"_TrainingPhoto_"&First(DataCardValue17_1.Attachments).Name
                 }
             );
            //Reset(DataCardValue17_1);
            ForAll(
                DataCardValue17.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        //name: NewProjID&"_DiscloseInformation."&Last(Split(First(DataCardValue17.Attachments).Name,".")).Value
                        name: NewProjID&"_DiscloseInformation_"&ThisRecord.Name
                    }
                )
            );
            //Reset(DataCardValue17);
            ,
            
            
            
            
            //上传High表信息&High表人员信息证照上传&High安全控制信息上传
            "High",
            Patch(TPL_HighWork,
            {
                ProjID:NewProjID,//当前项目ID
                OpUnit:TextInput_OpUnit.Text,//作业单位
                OnSiteGuardian:TextInput_OpDirector_2.Text,//现场监护人
                OpAr:TextInput_OpAr.Text,//作业地点
                OpCountent:TextInput_OpCountent.Text,//作业内容
                StartTime:DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0),//结束时间
                HWLevel:Radio_HWLevel.Selected.Value,//登高作业等级
                HWHazard1:TextInput_HWHazard1.Text,//存在的危害因素
                HWHazard2:TextInput_HWHazard2.Text,//可能导致的后果
                HWHazard3:TextInput_HWHazard3.Text,//相应的管控措施
                HWTools:Concat(Filter(HW_Tools,State=true),ToolsN,";"),//主要工具
                HWOtherTools:TextInput_HWOtherTools.Text//其他工具
            });
            ForAll(Filter(Gal_HW_NameID,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:NewProjID,//当前项目ID
                PhotoType:"登高作业人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            }));
            ForAll(
                Gallery3_8.AllItems,
                Switch(ItemID,
                1,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)})
            ))
            /*;
            //登高作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeHigh.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        //contentBytes: First(DataCardValue_ConstructionSchemeHigh.Attachments).Value,
                        //name: NewProjID&"_CSHighWork."&Last(Split(First(DataCardValue_ConstructionSchemeHigh.Attachments).Name,".")).Value
                        contentBytes: ThisRecord.Value,
                        name: NewProjID&"_CSHighWork_"&ThisRecord.Name
                    }
                )
            )*/,
            //Reset(DataCardValue_ConstructionSchemeHigh),
            
            //上传Lifting表信息&Lifting表人员信息证照上传&Lifting安全控制信息上传
            "Lifting",Patch(TPL_LiftingWork,
            {
                ProjID:NewProjID,//当前项目ID
                OpAr:TextInput_OpAr.Text,//作业地点
                OpCountent:TextInput_OpCountent.Text,//作业内容
                SuspendedObject:TextInput_SuspendedObject.Text,//被吊物
                SuspendedObjectWeight:Int(TextInput_SuspendedObjectWeight.Text),//被吊物重量
                LiftingCapacity:Int(TextInput_LiftingCapacity.Text),//起重能力
                OpUnit:TextInput_OpUnit.Text,//作业单位
                StartTime:DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0),//结束时间
                OnSiteGuardian:TextInput_OpDirector_2.Text,//现场监护人
                LWHazard1:TextInput_LWHazard1.Text,//存在的危害因素
                LWHazard2:TextInput_LWHazard2.Text,//可能导致的后果
                LWHazard3:TextInput_LWHazard3.Text//相应的管控措施
            });
            ForAll(Filter(Gal_LW_EquipmentsID,Equipments<>""),Patch(TPL_InfoGathering,
            {
                ProjID:NewProjID,//当前项目ID
                PhotoType:"吊装设备信息",
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Equipments
            }));
            ForAll(Filter(Gal_LW_NameID,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:NewProjID,//当前项目ID
                PhotoType:"吊装作业人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            }));
            ForAll(Filter(Gal_LW_CommanderID,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:NewProjID,//当前项目ID
                PhotoType:"吊装指挥人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            }));
            ForAll(
                Gallery3_7.AllItems,
                Switch(ItemID,
                1,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)})
            ))
            /*;
            //吊装作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeLifting.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        name: NewProjID&"_CSLiftingWork_"&ThisRecord.Name
                    }
                )
            )*/
            ,
            //Reset(DataCardValue_ConstructionSchemeLifting)
            
            
            //上传 有限空间作业 表信息&有限空间作业 安全控制信息上传
            "Confined Space",Patch(TPL_ConfinedSpaceWork,
            {
                ProjID:NewProjID,//当前项目ID
                OpUnit:TextInput_OpUnit.Text,//作业单位
                Worker:TextInput_CSW_Worker.Text,//作业人员
                OpAr:TextInput_OpAr.Text,//作业地点
                OnSiteGuardian:TextInput_OpDirector_2.Text,//现场监护人
                StartTime:DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0),//结束时间
                OpCountent:TextInput_OpCountent.Text,//作业内容
                CSWHazard1:TextInput_CSWHazard1.Text,//存在的危害因素
                CSWHazard2:TextInput_CSWHazard2.Text,//可能导致的后果
                CSWHazard3:TextInput_CSWHazard3.Text,//相应的管控措施
                GasDetectionTime:TextInput_Ventilation.Text//通风起止时间
            });
            /*ForAll(Gallery3_9.AllItems,
            If(ThisRecord.TextInput3.Text<>"",Patch(TPL_GasDetection,
            {
                ProjID:NewProjID,
                Sampler:ThisRecord.TextInput3.Text,
                SampleT:ThisRecord.TextInput3_1.Text,
                SampleP:ThisRecord.TextInput3_2.Text,
                OxyContent:ThisRecord.TextInput3_3.Text,
                CombustibleGas:ThisRecord.TextInput3_4.Text,
                CarbonMonoxide:ThisRecord.TextInput3_5.Text,
                HydrogenSulfide:ThisRecord.TextInput3_6.Text
            })));*/
            ForAll(
                Gallery3_4.AllItems,
                Switch(ItemID,
                1,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)})
            ))
            /*;
            //有限空间作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeConfined.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        //contentBytes: First(DataCardValue_ConstructionSchemeConfined.Attachments).Value,
                        //name: NewProjID&"_CSConfinedSpaceWork."&Last(Split(First(DataCardValue_ConstructionSchemeConfined.Attachments).Name,".")).Value
                        contentBytes: ThisRecord.Value,
                        name: NewProjID&"_CSConfinedSpaceWork_"&ThisRecord.Name
                    }
                )
            )*/
            ,
            //Reset(DataCardValue_ConstructionSchemeConfined)
            
            //上传Hot表信息&Hot表人员信息证照上传&Hot安全控制信息上传
            "Hot",Patch(TPL_HotWork,
            {
                ProjID:NewProjID,//当前项目ID
                OpAr:TextInput_OpAr.Text,//作业地点
                OpUnit:TextInput_OpUnit.Text,//作业单位
                OnSiteGuardian:TextInput_OpDirector_2.Text,//现场监护人
                StartTime:DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0),//结束时间
                OpCountent:TextInput_OpCountent.Text,//作业内容
                FWTools:TextInput_FWTools.Text,//动火作业工具
                FWHazard1:TextInput_FWHazard1.Text,//存在的危害因素
                FWHazard2:TextInput_FWHazard2.Text,//可能导致的后果
                FWHazard3:TextInput_FWHazard3.Text,//相应的管控措施
                FWLevel:Radio_FWLevel.SelectedText.Value,//动火作业级别
                FireHose:Int(TextInput_FWHazard1_4.Text),//消防水带数量
                FireExtinguisher:Int(TextInput_FWHazard1_5.Text),//灭火器数量
                FireBlanket:Int(TextInput_FWHazard1_6.Text),//防火毯数量
                FireOther:TextInput_FWOtherTool.Text, //其他防火器材名字
                FireOtherNumber:Int(TextInput_FWOtherToolNumber.Text) //其他防火器材数量
            });
            ForAll(Filter(Gal_FW_NameID,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:NewProjID,//当前项目ID
                PhotoType:"动火作业人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            }));
            ForAll(
                Gallery3_5.AllItems,
                Switch(ItemID,
                1,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)})
            ))
            /*;
            //动火作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeHot.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        //contentBytes: First(DataCardValue_ConstructionSchemeHot.Attachments).Value,
                        //name: NewProjID&"_CSHotWork."&Last(Split(First(DataCardValue_ConstructionSchemeHot.Attachments).Name,".")).Value
                        contentBytes: ThisRecord.Value,
                        name: NewProjID&"_CSHotWork_"&ThisRecord.Name
                    }
                )
            )*/
            ,
            //Reset(DataCardValue_ConstructionSchemeHot),
            
            //上传临时用电表信息&临时用电表人员信息证照上传&临时用电安全控制信息上传
            "Temporary Electricity",Patch(TPL_TemporaryElectricityUseWork,
            {
                ProjID:NewProjID,//当前项目ID
                OpAr:TextInput_OpAr.Text,//作业地点
                OpUnit:TextInput_OpUnit.Text,//作业单位
                OnSiteGuardian:TextInput_OpDirector_2.Text,//现场监护人
                OpCountent:TextInput_OpCountent.Text,//作业内容
                TotalLoad:TextInput_TotalLoad.Text,//用电设备总负荷
                WorkingVoltage:TextInput_WorkingVoltage.Text,//工作电压
                PowerAccessPoint:TextInput_PowerAccessPoint.Text,//电源接入点
                StartTime:DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0),//结束时间
                TEUHazard1:TextInput_TEUHazard1.Text,//存在的危害因素
                TEUHazard2:TextInput_TEUHazard2.Text,//可能导致的后果
                TEUHazard3:TextInput_TEUHazard3.Text//相应的管控措施
            });
            ForAll(Filter(Gal_TEU_NameID,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:NewProjID,//当前项目ID
                PhotoType:"临时用电人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            }));
            ForAll(
                Gallery3_6.AllItems,
                Switch(ItemID,
                1,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)})
            ))
            /*;
            //临时用电作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeTemporaryElectricity.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        //contentBytes: First(DataCardValue_ConstructionSchemeTemporaryElectricity.Attachments).Value,
                        //name: NewProjID&"_CSTemporaryElectricityWork."&Last(Split(First(DataCardValue_ConstructionSchemeTemporaryElectricity.Attachments).Name,".")).Value
                        contentBytes: ThisRecord.Value,
                        name: NewProjID&"_CSTemporaryElectricityWork_"&ThisRecord.Name
                    }
                )
            )*/
            //Reset(DataCardValue_ConstructionSchemeTemporaryElectricity)
            ));
            
            //创建一条新的申请界面
            If(
                First(Filter(List_Login,Email=PersonalMsg.Email)).HasAccount=false&&//是公用账号
                (
                    PersonalMsg.Email in First(Filter(List_Login,"CBRE" in Hod)).HodBackup||  //是CBRE备用审批人
                    PersonalMsg.Email in First(Filter(List_Login,"CBRE" in Hoa)).HoaBackup||  //是CBRE备用审批人
                    PersonalMsg.Email = First(Filter(List_Login,"CBRE" in Hod)).Email||  //是CBRE审批人
                    PersonalMsg.Email = First(Filter(List_Login,"CBRE" in Hoa)).Email    //是CBRE审批人
                ),
                TPL_RAFA_WithoutAccount.Run(NewProjID),
                TPL_RemindApprovalFromApp.Run(NewProjID)
            );
            
            Set(NewProjID,First(Sort(TPL_NormalLicence,ProjID,SortOrder.Descending)).ProjID+1);
            
            Notify("上传成功", NotificationType.Success);
            
            Navigate(home));
            ClearCollect(Gal_Ispatch,{Value:true});
            Set(NewProjID,First(Sort(TPL_NormalLicence,ProjID,SortOrder.Descending)).ProjID+1);//防止重复
            
        RadiusBottomLeft: =2
        RadiusBottomRight: =2
        RadiusTopLeft: =2
        RadiusTopRight: =2
        Size: =12
        Text: ="提交申请"
        Visible: =Vis_Sub
        Width: =102
        X: =533
        Y: =1069
        ZIndex: =3

    "Menu_Licence As gallery.'BrowseLayout_Horizontal_TwoTextOneImageVariant_ver5.0'":
        DelayItemLoading: =true
        Height: =46
        Items: =Filter(Licences,State=true)
        LoadingSpinner: =LoadingSpinner.Data
        OnSelect: =Set(Vis_Current,ThisItem.LicenceN)
        ShowNavigation: =true
        ShowScrollbar: =false
        TemplateFill: =If(ThisItem.IsSelected,RGBA(0, 0, 0, 0),Color.AliceBlue)
        TemplatePadding: =0
        TemplateSize: =104.6
        Width: =630
        X: =5
        Y: =1
        ZIndex: =4

        Label4 As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Bold
            Height: =45
            OnSelect: =Select(Parent)
            Size: =12
            Text: =ThisItem.LicenceN
            Width: =104.6
            ZIndex: =4

    Container_ConfinedSpaceNew As groupContainer.verticalAutoLayoutContainer:
        Height: =1018
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        Visible: =If(Vis_Current="Confined Space",true,false)
        Width: =630
        X: =4
        Y: =46
        ZIndex: =6

        Container_ConfinedSpaceNew_Title As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =110
            LayoutMinHeight: =70
            LayoutMinWidth: =250
            Width: =630
            X: =5
            Y: =107
            ZIndex: =1

            Image3_2 As image:
                Height: =74
                Image: ='1694500910899'
                Width: =78
                ZIndex: =1

            Label3_16 As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =70
                Size: =21
                Text: |-
                    ="Confined Space Work Permit
                    有限空间作业许可证"
                Width: =560
                X: =36
                Y: =7
                ZIndex: =2

            Label3_17 As label:
                Align: =Align.Center
                Color: =RGBA(184, 0, 0, 1)
                FontWeight: =FontWeight.Semibold
                Height: =33
                Size: =10.5
                Text: ="有限空间定义： 封闭或者部分封闭，出入口较为狭窄，作业人员不能长时间在内工作，自然通风不良，易造成有毒有害、易燃易爆物质积聚或者含氧量不足的空间 。"
                Width: =620
                Y: =77
                ZIndex: =3

        Container_ConfinedSpaceNew_1 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =290
            LayoutMinHeight: =60
            LayoutMinWidth: =250
            Width: =Parent.Width
            X: =40
            ZIndex: =4

            Label1_346 As label:
                Height: =25
                Size: =12
                Text: ="现场监护人"
                Width: =94
                Y: =29
                ZIndex: =2

            TextInput_OnSiteGuardian3 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpDirector_2.Text
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =523
                X: =94
                Y: =29
                ZIndex: =3

            Label1_349 As label:
                Height: =25
                Size: =12
                Text: ="作业内容"
                Width: =80
                Y: =106
                ZIndex: =5

            TextInput_OpCountent3 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpCountent.Text
                DisplayMode: =DisplayMode.View
                Height: =50
                MaxLength: =65
                Mode: =TextMode.MultiLine
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =523
                X: =94
                Y: =104
                ZIndex: =6

            Label1_354 As label:
                Height: =25
                Size: =12
                Text: ="危害辨识"
                Width: =80
                Y: =179
                ZIndex: =7

            TextInput_CSWHazard1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Height: =25
                HintText: ="请输入存在的危害因素"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =457
                X: =160
                Y: =204
                ZIndex: =8

            Label1_355 As label:
                Height: =25
                Size: =12
                Text: ="1）*存在的危害因素"
                Width: =160
                Y: =204
                ZIndex: =9

            Label1_356 As label:
                Height: =25
                Size: =12
                Text: ="2）*可能导致的后果"
                Width: =160
                Y: =229
                ZIndex: =10

            Label1_357 As label:
                Height: =25
                Size: =12
                Text: ="3）*相应的管控措施"
                Width: =160
                Y: =254
                ZIndex: =11

            TextInput_CSWHazard2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Height: =25
                HintText: ="请输入可能导致的后果"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =457
                X: =161
                Y: =229
                ZIndex: =12

            TextInput_CSWHazard3 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Height: =25
                HintText: ="请输入相应的管控措施"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =457
                X: =160
                Y: =254
                ZIndex: =13

            Label1_337 As label:
                Height: =25
                Size: =12
                Text: ="作业地点"
                Width: =80
                Y: =79
                ZIndex: =14

            TextInput_OpAr3 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpAr.Text
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =27
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =523
                X: =94
                Y: =79
                ZIndex: =15

            Label1_336 As label:
                Height: =25
                Size: =12
                Text: ="作业单位"
                Width: =80
                Y: =4
                ZIndex: =16

            TextInput_OpUnit3 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpUnit.Text
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =523
                X: =94
                Y: =4
                ZIndex: =17

            Label1_358 As label:
                Height: =25
                Size: =12
                Text: ="*作业人员"
                Width: =83
                Y: =54
                ZIndex: =18

            TextInput_CSW_Worker As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                HintText: ="输入作业人员姓名"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =523
                X: =94
                Y: =54
                ZIndex: =19

            Label1_171 As label:
                Height: =25
                Size: =12
                Text: ="开始时间"
                Width: =80
                Y: =154
                ZIndex: =20

            Label1_172 As label:
                Height: =25
                Size: =12
                Text: ="结束时间"
                Width: =80
                X: =315
                Y: =154
                ZIndex: =21

            TextInput_OpAr1_6 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Text(DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0),"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =222
                X: =93
                Y: =154
                ZIndex: =22

            TextInput_OpAr1_7 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Text(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0),"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =223
                X: =395
                Y: =154
                ZIndex: =23

            Label1_214 As label:
                Height: =26
                Size: =12
                Text: ="*施工方案"
                Visible: =false
                Width: =83
                Y: =154
                ZIndex: =24

            DataCardValue_ConstructionSchemeConfined As attachments:
                AddAttachmentText: ="附加文件(word/pdf/图片)"
                BorderColor: =RGBA(9, 33, 98, 1)
                Height: =110
                IsInDataCard: =true
                Items: =Blank()
                MaxAttachments: =3
                MaxAttachmentSize: =30
                PaddingBottom: =5
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PaddingRight: =5
                PaddingTop: =5
                Reset: =true
                Size: =12
                Tooltip: =
                Visible: =false
                Width: =524
                X: =93
                Y: =154
                ZIndex: =25

        Container_HighNew_13 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Gallery3_4.Height+Label1_500.Height+TextInput_ProjLederConfirm_2.Height+30
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =5

            Label1_294 As label:
                Height: =25
                Size: =12
                Text: ="项目负责人确认："
                Width: =140
                Y: =Gallery3_4.Y+Gallery3_4.Height
                ZIndex: =1

            TextInput_ProjLederConfirm_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_ProjLeder.Text
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =461
                X: =140
                Y: =Gallery3_4.Y+Gallery3_4.Height
                ZIndex: =2

            "Gallery3_4 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                DelayItemLoading: =true
                Height: =Sum(Self.AllItems,Int(Label_height_1.Text))
                Items: =Gal_ConfinedSpaceSafetyControl
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                ShowScrollbar: =false
                TemplatePadding: =1
                TemplateSize: =Title3_5.Height
                Width: =Parent.Width
                Y: =Label1_500.Height+Label1_433.Height+3
                ZIndex: =3

                Label_height_1 As label:
                    Height: =20
                    OnSelect: =Select(Parent)
                    Size: =21
                    Text: =Title3_5.Height+Gallery3_4.TemplatePadding+4
                    Visible: =false
                    Width: =100
                    X: =498
                    ZIndex: =1

                Radio_PatrolTnspection_19 As radio:
                    BorderColor: =
                    FocusedBorderColor: =
                    FocusedBorderThickness: =0
                    Height: =25
                    HoverColor: =
                    Items: =["是","不适用"]
                    Layout: =Layout.Horizontal
                    PaddingBottom: =0
                    PaddingTop: =0
                    PressedColor: =
                    RadioSize: =15
                    Size: =12
                    Width: =155
                    ZIndex: =2

                Title3_5 As label:
                    AutoHeight: =true
                    Height: =39
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =15
                    PaddingTop: =0
                    Size: =12
                    Text: =ThisItem.Content
                    VerticalAlign: =VerticalAlign.Top
                    Width: =465
                    X: =155
                    ZIndex: =4

            Label1_500 As label:
                FontWeight: =FontWeight.Bold
                Height: =25
                Size: =11
                Text: ="现场安全控制措施：项目负责人应同现场负责人对以上控制措施进行检查确认"
                Width: =559
                ZIndex: =4

            Label1_433 As label:
                Height: =25
                Size: =12
                Text: ="*通风起止时间："
                Width: =140
                Y: =25
                ZIndex: =5

            TextInput_Ventilation As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Height: =25
                HintText: ="请输入通风起止时间"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =489
                X: =122
                Y: =25
                ZIndex: =17

    Container_HotWorkNew As groupContainer.verticalAutoLayoutContainer:
        Height: =1018
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        Visible: =If(Vis_Current="Hot",true,false)
        Width: =630
        X: =5
        Y: =46
        ZIndex: =7

        Container_HotWorkNew_Title As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =100
            LayoutMinHeight: =80
            LayoutMinWidth: =250
            Width: =630
            X: =5
            Y: =107
            ZIndex: =1

            Label3_5 As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =70
                Size: =21
                Text: ="热加工（动火）作业许可证"
                Width: =560
                X: =36
                Y: =7
                ZIndex: =58

            Label3_15 As label:
                Align: =Align.Center
                Color: =RGBA(184, 0, 0, 1)
                FontWeight: =FontWeight.Semibold
                Height: =26
                Size: =10.5
                Text: ="高空作业定义：在坠落高度基准面2米以上（含2米）有可能坠落的高处进行的作业。"
                Width: =630
                Y: =74
                ZIndex: =59

            Image3 As image:
                Height: =74
                Image: ='1694500910899'
                Width: =78
                ZIndex: =60

        Container_HotWorkNew_1 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label2_10.Height+Gallery5_5.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =3

            "Gallery5_5 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =If(Self.AllItemsCount=0,1,Self.AllItemsCount)*30
                Items: =Gal_FW_NameID
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =30
                Width: =630
                Y: =31
                ZIndex: =1

                Rectangle3_5 As rectangle:
                    Height: =30
                    OnSelect: =Select(Parent)
                    Visible: =ThisItem.IsSelected
                    Width: =4
                    ZIndex: =6

                TextInput_HW_Worker As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.Name
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    HintText: ="动火作业人员姓名"
                    OnChange: |-
                        =Patch(Gal_FW_NameID,ThisItem,{Name:Self.Text});
                        //ClearCollect(Gal_FW_NameIDPatch,Concat(ForAll(Gal_FW_NameID,Concatenate(Name,":",ID)),Value,";"))
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =151
                    X: =4
                    ZIndex: =7

                TextInput__HW_ID As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.ID
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    HintText: ="输入证件号"
                    OnChange: |-
                        =Patch(Gal_FW_NameID,ThisItem,{ID:Self.Text});
                        ClearCollect(Gal_FW_NameIDPatch,Concat(ForAll(Gal_FW_NameID,Concatenate(Name,":",ID)),Value,";"))
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =294
                    X: =336
                    ZIndex: =8

                Icon4_5 As icon.Cancel:
                    Height: =18
                    Icon: =Icon.Cancel
                    OnSelect: =Remove(Gal_FW_NameID,ThisItem)
                    Width: =20
                    X: =589
                    Y: =6
                    ZIndex: =9

                Image_Photo_6 As image:
                    Height: =30
                    Image: =ThisItem.Photo
                    OnSelect: |-
                        =Set(ShowPhoto,ThisItem.Photo);
                        Set(WhereBack,"ApplyLicence");
                        
                        Navigate(PhotoGraph);
                    Width: =181
                    X: =155
                    ZIndex: =10

                TakePhoto_HW_3 As icon.Camera:
                    Height: =30
                    Icon: =Icon.Camera
                    OnSelect: |-
                        =Set(Camera_MsgID,Gallery5_7.Selected);
                        Set(Camera_Type,"CollectFWMsg");
                        Reset(AddMediaButton1);//清空photo
                        Navigate(Camera)
                    Visible: =If(ThisItem.Photo=SampleImage,true,false)
                    Width: =44
                    X: =292
                    ZIndex: =11

            Label2_10 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="*动火作业人员"
                Width: =155
                ZIndex: =2

            Label2_11 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件号"
                Width: =302
                X: =328
                ZIndex: =3

            Icon1_7 As icon.Add:
                Color: =RGBA(255, 255, 255, 1)
                FocusedBorderThickness: =5
                Height: =30
                Icon: =Icon.Add
                OnSelect: |-
                    =Collect(Gal_FW_NameID,{Name:"",ID:"",Photo:SampleImage})
                Width: =30
                X: =586
                ZIndex: =4

            Label2_54 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件照片"
                Width: =173
                X: =155
                ZIndex: =5

        Container_HotWorkNew_2 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =415
            LayoutMinHeight: =60
            LayoutMinWidth: =250
            Width: =Parent.Width
            X: =40
            ZIndex: =4

            Label1_332 As label:
                Height: =25
                Size: =12
                Text: ="现场监护人"
                Width: =94
                Y: =51
                ZIndex: =2

            TextInput_OnSiteGuardian4 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpDirector_2.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =521
                X: =93
                Y: =51
                ZIndex: =3

            Label1_335 As label:
                Height: =25
                Size: =12
                Text: ="作业内容"
                Width: =80
                Y: =102
                ZIndex: =5

            Label1_333 As label:
                Height: =25
                Size: =12
                Text: ="*作业动火工具"
                Width: =120
                Y: =151
                ZIndex: =6

            TextInput_FWTools As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Height: =25
                HintText: ="输入作业动火工具"
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =497
                X: =120
                Y: =151
                ZIndex: =7

            Label1_340 As label:
                Height: =25
                Size: =12
                Text: ="危害辨识"
                Width: =80
                Y: =176
                ZIndex: =8

            TextInput_FWHazard1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Height: =25
                HintText: ="请输入存在的危害因素"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =456
                X: =161
                Y: =201
                ZIndex: =9

            Label1_341 As label:
                Height: =25
                Size: =12
                Text: ="1）*存在的危害因素"
                Width: =160
                Y: =201
                ZIndex: =10

            Label1_342 As label:
                Height: =25
                Size: =12
                Text: ="2）*可能导致的后果"
                Width: =160
                Y: =226
                ZIndex: =11

            Label1_343 As label:
                Height: =25
                Size: =12
                Text: ="3）*相应的管控措施"
                Width: =160
                Y: =251
                ZIndex: =12

            TextInput_FWHazard2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Height: =25
                HintText: ="请输入可能导致的后果"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =455
                X: =161
                Y: =226
                ZIndex: =13

            TextInput_FWHazard3 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Height: =25
                HintText: ="请输入相应的管控措施"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =455
                X: =161
                Y: =251
                ZIndex: =14

            Label1_326 As label:
                Height: =25
                Size: =12
                Text: ="作业单位"
                Width: =80
                Y: =27
                ZIndex: =17

            TextInput_OpUnit4 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpUnit.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =521
                X: =93
                Y: =27
                ZIndex: =18

            Label1_331 As label:
                Height: =25
                Size: =12
                Text: ="作业地点"
                Width: =80
                Y: =2
                ZIndex: =19

            TextInput_OpAr4 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpAr.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =521
                X: =93
                Y: =2
                ZIndex: =20

            Label1_344 As label:
                FontWeight: =FontWeight.Bold
                Height: =27
                Size: =12
                Text: ="*动火作业级别"
                Width: =120
                Y: =276
                ZIndex: =21

            Radio_FWLevel As radio:
                BorderColor: =
                Default: =""
                FocusedBorderColor: =
                FocusedBorderThickness: =0
                Height: =95
                HoverColor: =
                Items: =["一级","二级","三级"]
                Layout: =Layout.Horizontal
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                PressedColor: =
                RadioSize: =24
                Size: =12
                Width: =120
                Y: =303
                ZIndex: =22

            Label1_345 As label:
                Height: =82
                Italic: =true
                PaddingTop: =0
                Size: =10
                Text: |-
                    ="注：一级动火：在生产运行状态下的易燃易爆管道、储罐、容器等特殊危险场所的动火作业(含带压不置换动火作业)
                    二级动火：在易燃易场所进行除一级动火以外的动火作业
                    三级动火：除一级和二级外，凡生产系统全部停机，经清洗、置换、分析合格并采取安全隔离措施后的动火作业"
                Width: =522
                X: =95
                Y: =303
                ZIndex: =23

            TextInput_OpCountent4 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpCountent.Text
                DisplayMode: =DisplayMode.View
                Height: =50
                MaxLength: =65
                Mode: =TextMode.MultiLine
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =537
                X: =93
                Y: =101
                ZIndex: =24

            Label1_175 As label:
                Height: =25
                Size: =12
                Text: ="开始时间"
                Width: =80
                Y: =76
                ZIndex: =25

            Label1_176 As label:
                Height: =25
                Size: =12
                Text: ="结束时间"
                Width: =80
                X: =315
                Y: =76
                ZIndex: =26

            Label1_394 As label:
                Height: =25
                Size: =12
                Text: ="选择工厂"
                Visible: =If(Radio_FWLevel.Selected.Value="一级",true,false)
                Width: =80
                Y: =385
                ZIndex: =33

            Dropdown_OpDept_4 As dropdown:
                BorderStyle: =BorderStyle.None
                ChevronBackground: =RGBA(0, 0, 0, 0)
                ChevronFill: =RGBA(39, 67, 125, 1)
                Default: =""
                Height: =25
                Items: =Factory
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                Size: =12
                Visible: =If(Radio_FWLevel.Selected.Value="一级",true,false)
                Width: =251
                X: =80
                Y: =385
                ZIndex: =34

            TextInput_OpAr1_8 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Text(DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0),"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =222
                X: =93
                Y: =76
                ZIndex: =35

            TextInput_OpAr1_9 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Text(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0),"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =221
                X: =395
                Y: =76
                ZIndex: =36

            Label1_208 As label:
                Height: =26
                Size: =12
                Text: ="*施工方案"
                Visible: =false
                Width: =83
                Y: =154
                ZIndex: =37

            DataCardValue_ConstructionSchemeHot As attachments:
                AddAttachmentText: ="附加文件(word/pdf/图片)"
                BorderColor: =RGBA(9, 33, 98, 1)
                Height: =110
                IsInDataCard: =true
                Items: =Blank()
                MaxAttachments: =3
                MaxAttachmentSize: =30
                PaddingBottom: =5
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PaddingRight: =5
                PaddingTop: =5
                Reset: =true
                Size: =12
                Tooltip: =
                Visible: =false
                Width: =523
                X: =93
                Y: =154
                ZIndex: =38

        Container_HighNew_14 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Gallery3_5.Height+Label1_501.Height+TextInput_ProjLederConfirm_3.Height+Label1_295.Height+TextInput_ProjLederConfirm_3.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =5

            Label1_295 As label:
                Height: =25
                Size: =12
                Text: ="项目负责人确认："
                Width: =140
                Y: =Gallery3_5.Y+Gallery3_5.Height
                ZIndex: =1

            TextInput_ProjLederConfirm_3 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_ProjLeder.Text
                Height: =25
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =11
                Width: =461
                X: =140
                Y: =Gallery3_5.Y+Gallery3_5.Height
                ZIndex: =2

            "Gallery3_5 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                DelayItemLoading: =true
                Height: =Sum(Self.AllItems,Int(Label_height_2.Text))
                Items: =Gal_HotWorkSafetyControl
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                Selectable: =false
                ShowScrollbar: =false
                TemplatePadding: =1
                TemplateSize: =Title3_6.Height
                Width: =Parent.Width
                Y: =Label1_501.Height+TextInput_FWHazard1_4.Height+1+25
                ZIndex: =3

                Label_height_2 As label:
                    Height: =20
                    OnSelect: =Select(Parent)
                    Size: =21
                    Text: =Title3_6.Height+Gallery3_5.TemplatePadding+4
                    Visible: =false
                    Width: =100
                    X: =498
                    ZIndex: =1

                Radio_PatrolTnspection_20 As radio:
                    BorderColor: =
                    FocusedBorderColor: =
                    FocusedBorderThickness: =0
                    Height: =25
                    HoverColor: =
                    Items: =["是","不适用"]
                    Layout: =Layout.Horizontal
                    PaddingBottom: =0
                    PaddingTop: =0
                    PressedColor: =
                    RadioSize: =15
                    Size: =12
                    Width: =155
                    ZIndex: =2

                Title3_6 As label:
                    AutoHeight: =true
                    Height: =20
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =15
                    PaddingTop: =0
                    Size: =12
                    Text: =ThisItem.Content
                    VerticalAlign: =VerticalAlign.Top
                    Width: =464
                    X: =155
                    ZIndex: =4

            Label1_501 As label:
                FontWeight: =FontWeight.Bold
                Height: =25
                Size: =11
                Text: ="现场安全控制措施：项目负责人应同现场负责人对以上控制措施进行检查确认"
                Width: =559
                ZIndex: =4

            Label1_409 As label:
                Height: =25
                Size: =12
                Text: ="*消防水带数量"
                Width: =120
                Y: =25
                ZIndex: =5

            Label1_411 As label:
                Height: =25
                Size: =12
                Text: ="*灭火器数量"
                Width: =100
                X: =222
                Y: =25
                ZIndex: =6

            Label1_619 As label:
                Height: =25
                Size: =12
                Text: ="*防火毯数量"
                Width: =101
                X: =415
                Y: =25
                ZIndex: =7

            TextInput_ProjLederConfirm_8 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_ProjLeder.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =461
                X: =140
                Y: =Gallery3_5.Y+Gallery3_5.Height
                ZIndex: =8

            TextInput_FWHazard1_4 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Fill: =RGBA(0, 0, 0, 0)
                Format: =TextFormat.Number
                Height: =25
                HintText: ="消防水带数量"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =116
                X: =120
                Y: =25
                ZIndex: =9

            TextInput_FWHazard1_5 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Fill: =RGBA(0, 0, 0, 0)
                Format: =TextFormat.Number
                Height: =25
                HintText: ="灭火器数量"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =93
                X: =322
                Y: =25
                ZIndex: =10

            TextInput_FWHazard1_6 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Fill: =RGBA(0, 0, 0, 0)
                Format: =TextFormat.Number
                Height: =25
                HintText: ="防火毯数量"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =103
                X: =516
                Y: =25
                ZIndex: =11

            Label1_631 As label:
                Height: =25
                Size: =12
                Text: ="其他器材名 "
                Width: =93
                Y: =50
                ZIndex: =12

            TextInput_FWOtherToolNumber As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Fill: =RGBA(0, 0, 0, 0)
                Format: =TextFormat.Number
                Height: =25
                HintText: ="其他器材数量"
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =189
                X: =430
                Y: =50
                ZIndex: =13

            TextInput_FWOtherTool As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                HintText: ="其他器材名"
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =229
                X: =93
                Y: =50
                ZIndex: =14

            Label1_632 As label:
                Height: =25
                Size: =12
                Text: ="其他器材数量"
                Width: =108
                X: =322
                Y: =50
                ZIndex: =15

            TextInput_ProjLederConfirm_14 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_ProjLeder.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =461
                X: =138
                Y: =Gallery3_5.Y+Gallery3_5.Height
                ZIndex: =17

    Container_LiftingNew As groupContainer.verticalAutoLayoutContainer:
        Height: =1018
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        Visible: =If(Vis_Current="Lifting",true,false)
        Width: =630
        X: =5
        Y: =46
        ZIndex: =8

        Container_LiftingNew_Title As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =100
            LayoutMinHeight: =70
            LayoutMinWidth: =250
            Width: =630
            X: =5
            Y: =107
            ZIndex: =1

            Image3_3 As image:
                Height: =74
                Image: ='1694500910899'
                Width: =78
                ZIndex: =1

            Label3_2 As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =70
                Size: =21
                Text: |-
                    ="Lifting Work Permit
                    吊装作业许可证"
                Width: =560
                X: =36
                Y: =7
                ZIndex: =2

            Label3_13 As label:
                Align: =Align.Center
                Color: =RGBA(184, 0, 0, 1)
                FontWeight: =FontWeight.Semibold
                Height: =26
                Size: =10.5
                Text: ="定义：利用吊车或者起升机构将重物吊起，并使重物发生位置变化的作业过程"
                Width: =630
                Y: =72
                ZIndex: =3

        Container_LiftingNew_1 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =135
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =630
            X: =5
            Y: =107
            ZIndex: =2

            Label1_307 As label:
                Height: =25
                Size: =12
                Text: ="作业内容"
                Width: =80
                Y: =53
                ZIndex: =1

            Icon1_1 As icon.Add:
                Color: =RGBA(255, 255, 255, 1)
                FocusedBorderThickness: =5
                Height: =30
                Icon: =Icon.Add
                OnSelect: |-
                    =Collect(Gal_HeightsPersMsg,{Name:"",ID:""})
                Width: =30
                X: =600
                Y: =135
                ZIndex: =2

            Label1_304 As label:
                Height: =25
                Size: =12
                Text: ="吊装地点"
                Width: =80
                Y: =25
                ZIndex: =3

            TextInput_OpAr2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpAr.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =536
                X: =83
                Y: =25
                ZIndex: =4

            Label1_315 As label:
                Height: =25
                Size: =12
                Text: ="*被吊物"
                Width: =80
                Y: =100
                ZIndex: =5

            TextInput_SuspendedObject As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                HintText: ="输入被吊物名称"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =206
                X: =85
                Y: =100
                ZIndex: =6

            TextInput_OpCountent2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpCountent.Text
                DisplayMode: =DisplayMode.View
                Height: =50
                MaxLength: =65
                Mode: =TextMode.MultiLine
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =536
                X: =83
                Y: =50
                ZIndex: =7

            Label1_316 As label:
                Height: =25
                Size: =12
                Text: ="*被吊物重量(T)"
                Width: =118
                X: =291
                Y: =100
                ZIndex: =8

            TextInput_SuspendedObjectWeight As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Fill: =RGBA(0, 0, 0, 0)
                Format: =TextFormat.Number
                Height: =25
                HintText: ="输入被吊物重量"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =206
                X: =409
                Y: =100
                ZIndex: =9

            Label1_201 As label:
                Height: =26
                Size: =12
                Text: ="*施工方案"
                Visible: =false
                Width: =83
                Y: =130
                ZIndex: =10

            DataCardValue_ConstructionSchemeLifting As attachments:
                AddAttachmentText: ="附加文件(word/pdf/图片)"
                BorderColor: =RGBA(9, 33, 98, 1)
                Height: =110
                IsInDataCard: =true
                Items: =Blank()
                MaxAttachments: =3
                MaxAttachmentSize: =30
                PaddingBottom: =5
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PaddingRight: =5
                PaddingTop: =5
                Reset: =true
                Size: =12
                Tooltip: =
                Visible: =false
                Width: =530
                X: =85
                Y: =130
                ZIndex: =11

            Label1_204 As label:
                Height: =25
                Size: =12
                Text: ="作业单位"
                Width: =80
                ZIndex: =12

            TextInput_OpUnit2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpUnit.Text
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =536
                X: =83
                ZIndex: =13

        Container_LiftingNew_2 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label_123.Height+Gallery5_1.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =3

            "Gallery5_1 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =If(Self.AllItemsCount=0,1,Self.AllItemsCount)*30
                Items: =Gal_LW_EquipmentsID
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =30
                Width: =630
                Y: =31
                ZIndex: =1

                Rectangle3_1 As rectangle:
                    Height: =31
                    OnSelect: =Select(Parent)
                    Visible: =ThisItem.IsSelected
                    Width: =4
                    ZIndex: =6

                TextInput_LW_Equipments As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.Equipments
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    HintText: ="输入吊装设备名"
                    OnChange: |-
                        =Patch(Gal_LW_EquipmentsID,ThisItem,{Equipments:Self.Text});
                        ClearCollect(Gal_LW_EquipmentsIDPatch,Concat(ForAll(Gal_LW_EquipmentsID,Concatenate(Equipments,":",ID)),Value,";"))
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =217
                    X: =4
                    ZIndex: =7

                TextInput_LW_EquipmentsID As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.ID
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    HintText: ="输入吊装设备编号"
                    OnChange: |-
                        =Patch(Gal_LW_EquipmentsID,ThisItem,{ID:Self.Text});
                        ClearCollect(Gal_LW_EquipmentsIDPatch,Concat(ForAll(Gal_LW_EquipmentsID,Concatenate(Equipments,":",ID)),Value,";"))
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =409
                    X: =221
                    ZIndex: =8

                Icon4_1 As icon.Cancel:
                    Height: =18
                    Icon: =Icon.Cancel
                    OnSelect: =Remove(Gal_LW_EquipmentsID,ThisItem)
                    Width: =20
                    X: =591
                    Y: =6
                    ZIndex: =9

            Label_123 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =29
                Size: =12
                Text: ="*吊装设备"
                Width: =223
                Y: =1
                ZIndex: =2

            Label2_3 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =29
                Size: =12
                Text: ="*编号"
                Width: =407
                X: =223
                Y: =1
                ZIndex: =3

            Icon1_2 As icon.Add:
                Color: =RGBA(255, 255, 255, 1)
                FocusedBorderThickness: =5
                Height: =30
                Icon: =Icon.Add
                OnSelect: |-
                    =Collect(Gal_LW_EquipmentsID,{Equipments:"",ID:""})
                Width: =30
                X: =586
                ZIndex: =4

        Container_LiftingNew_3 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0.1
            Height: =60
            LayoutMinHeight: =60
            LayoutMinWidth: =250
            Width: =Parent.Width
            X: =40
            ZIndex: =4

            Label1_317 As label:
                Height: =25
                Size: =12
                Text: ="*吊装设备起重能力(T)"
                Width: =167
                X: =1
                Y: =2
                ZIndex: =28

            TextInput_LiftingCapacity As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Fill: =RGBA(0, 0, 0, 0)
                Format: =TextFormat.Number
                Height: =25
                HintText: ="设备起重能力"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =449
                X: =168
                Y: =2
                ZIndex: =29

            Label1_167 As label:
                Height: =25
                Size: =12
                Text: ="开始时间"
                Width: =Len(Self.Text)*20
                X: =1
                Y: =30
                ZIndex: =30

            Label1_168 As label:
                Height: =25
                Size: =12
                Text: ="结束时间"
                Width: =80
                X: =291
                Y: =30
                ZIndex: =31

            TextInput_OpAr1_4 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Text(DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0),"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =210
                X: =81
                Y: =30
                ZIndex: =32

            TextInput_OpAr1_5 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Text(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0),"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =245
                X: =371
                Y: =30
                ZIndex: =33

        Container_LiftingNew_4 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label2_4.Height+Gallery5_2.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =5

            "Gallery5_2 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =If(Self.AllItemsCount=0,1,Self.AllItemsCount)*30
                Items: =Gal_LW_NameID
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =30
                Width: =630
                Y: =31
                ZIndex: =1

                Rectangle3_2 As rectangle:
                    Height: =30
                    OnSelect: =Select(Parent)
                    Visible: =ThisItem.IsSelected
                    Width: =4
                    ZIndex: =6

                TextInput_LW_Worker As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.Name
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    HintText: ="输入吊装人员姓名"
                    OnChange: |+
                        =Patch(Gal_LW_NameID,ThisItem,{Name:Self.Text});
                        ClearCollect(Gal_LW_NameIDPatch,Concat(ForAll(Gal_LW_NameID,Concatenate(Name,":",ID)),Value,";"))
                        
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =151
                    X: =4
                    ZIndex: =7

                TextInput_LW_ID As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.ID
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    HintText: ="输入证件号"
                    OnChange: |-
                        =Patch(Gal_LW_NameID,ThisItem,{ID:Self.Text});
                        ClearCollect(Gal_LW_NameIDPatch,Concat(ForAll(Gal_LW_NameID,Concatenate(Name,":",ID)),Value,";"))
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =294
                    X: =336
                    ZIndex: =8

                Icon4_2 As icon.Cancel:
                    Height: =18
                    Icon: =Icon.Cancel
                    OnSelect: =Remove(Gal_LW_NameID,ThisItem)
                    Width: =20
                    X: =591
                    Y: =6
                    ZIndex: =9

                Image_Photo_4 As image:
                    Height: =30
                    Image: =ThisItem.Photo
                    OnSelect: |-
                        =Set(ShowPhoto,ThisItem.Photo);
                        Set(WhereBack,"ApplyLicence");
                        
                        Navigate(PhotoGraph);
                    Width: =181
                    X: =155
                    ZIndex: =10

                TakePhoto_HW_1 As icon.Camera:
                    Height: =30
                    Icon: =Icon.Camera
                    OnSelect: |-
                        =Set(Camera_MsgID,Gallery5_2.Selected);
                        Set(Camera_Type,"CollectLWMsg");
                        Reset(AddMediaButton1);//清空photo
                        Navigate(Camera)
                    Visible: =If(ThisItem.Photo=SampleImage,true,false)
                    Width: =44
                    X: =292
                    ZIndex: =11

            Label2_4 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="*吊装人员姓名"
                Width: =155
                ZIndex: =2

            Label2_5 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件号"
                Width: =302
                X: =328
                ZIndex: =3

            Icon1_3 As icon.Add:
                Color: =RGBA(255, 255, 255, 1)
                FocusedBorderThickness: =5
                Height: =30
                Icon: =Icon.Add
                OnSelect: |-
                    =Collect(Gal_LW_NameID,{Name:"",ID:"",Photo:SampleImage})
                Width: =30
                X: =586
                ZIndex: =4

            Label2_52 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件照片"
                Width: =173
                X: =155
                ZIndex: =5

        Container_LiftingNew_6 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label2_6.Height+Gallery5_3.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =7

            "Gallery5_3 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =If(Self.AllItemsCount=0,1,Self.AllItemsCount)*30
                Items: =Gal_LW_CommanderID
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =30
                Width: =630
                Y: =31
                ZIndex: =1

                Rectangle3_3 As rectangle:
                    Height: =30
                    OnSelect: =Select(Parent)
                    Visible: =ThisItem.IsSelected
                    Width: =4
                    ZIndex: =6

                TextInput_LW_Commander As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.Name
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    HintText: ="输入指挥人员姓名"
                    OnChange: |
                        =Patch(Gal_LW_CommanderID,ThisItem,{Name:Self.Text});
                        ClearCollect(Gal_LW_CommanderIDPatch,Concat(ForAll(Gal_LW_CommanderID,Concatenate(Name,":",ID)),Value,";"))
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =151
                    X: =4
                    ZIndex: =7

                TextInput_LW_CommanderID As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.ID
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    HintText: ="输入证件号"
                    OnChange: |-
                        =Patch(Gal_LW_CommanderID,ThisItem,{ID:Self.Text});
                        ClearCollect(Gal_LW_CommanderIDPatch,Concat(ForAll(Gal_LW_CommanderID,Concatenate(Name,":",ID)),Value,";"))
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =294
                    X: =336
                    ZIndex: =8

                Icon4_3 As icon.Cancel:
                    Height: =18
                    Icon: =Icon.Cancel
                    OnSelect: =Remove(Gal_LW_CommanderID,ThisItem)
                    Width: =20
                    X: =591
                    Y: =6
                    ZIndex: =9

                Image_Photo_5 As image:
                    Height: =30
                    Image: =ThisItem.Photo
                    OnSelect: |-
                        =Set(ShowPhoto,ThisItem.Photo);
                        Set(WhereBack,"ApplyLicence");
                        
                        Navigate(PhotoGraph);
                    Width: =181
                    X: =155
                    ZIndex: =10

                TakePhoto_HW_2 As icon.Camera:
                    Height: =30
                    Icon: =Icon.Camera
                    OnSelect: |-
                        =Set(Camera_MsgID,Gallery5_3.Selected);
                        Set(Camera_Type,"CollectLW2Msg");
                        Reset(AddMediaButton1);//清空photo
                        Navigate(Camera)
                    Visible: =If(ThisItem.Photo=SampleImage,true,false)
                    Width: =44
                    X: =292
                    ZIndex: =11

            Label2_6 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="*指挥人员"
                Width: =155
                ZIndex: =2

            Label2_7 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件号"
                Width: =302
                X: =328
                ZIndex: =3

            Icon1_4 As icon.Add:
                Color: =RGBA(255, 255, 255, 1)
                FocusedBorderThickness: =5
                Height: =30
                Icon: =Icon.Add
                OnSelect: |-
                    =Collect(Gal_LW_CommanderID,{Name:"",ID:"",Photo:SampleImage})
                Width: =30
                X: =586
                ZIndex: =4

            Label2_53 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件照片"
                Width: =173
                X: =155
                ZIndex: =5

        Container_LiftingNew_7 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =140
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            PaddingBottom: =2
            PaddingTop: =2
            Width: =Parent.Width
            ZIndex: =8

            Label1_309 As label:
                Height: =25
                Size: =12
                Text: ="危害辨识"
                Width: =81
                Y: =30
                ZIndex: =1

            Label1_303 As label:
                Height: =25
                Size: =12
                Text: ="现场监护人"
                Width: =94
                Y: =5
                ZIndex: =5

            TextInput_OnSiteGuardian2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpDirector_2.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =211
                X: =94
                Y: =5
                ZIndex: =6

            TextInput_LWHazard1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Height: =25
                HintText: ="请输入存在的危害因素"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =467
                X: =161
                Y: =55
                ZIndex: =7

            Label1_310 As label:
                Height: =25
                Size: =12
                Text: ="1）*存在的危害因素"
                Width: =160
                Y: =55
                ZIndex: =11

            Label1_311 As label:
                Height: =25
                Size: =12
                Text: ="2）*可能导致的后果"
                Width: =160
                Y: =80
                ZIndex: =12

            Label1_312 As label:
                Height: =25
                Size: =12
                Text: ="3）*相应的管控措施"
                Width: =160
                Y: =105
                ZIndex: =13

            TextInput_LWHazard2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Height: =25
                HintText: ="请输入可能导致的后果"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =467
                X: =161
                Y: =80
                ZIndex: =14

            TextInput_LWHazard3 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Height: =25
                HintText: ="请输入相应的管控措施"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =467
                X: =161
                Y: =105
                ZIndex: =15

        Container_HighNew_16 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Gallery3_7.Height+Label1_503.Height+TextInput_ProjLederConfirm_5.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =9

            Label1_297 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="项目负责人确认:"
                Width: =140
                Y: =Gallery3_7.Y+Gallery3_7.Height
                ZIndex: =1

            TextInput_ProjLederConfirm_5 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_ProjLeder.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =461
                X: =140
                Y: =Gallery3_7.Y+Gallery3_7.Height
                ZIndex: =2

            "Gallery3_7 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                DelayItemLoading: =true
                Height: =Sum(Self.AllItems,Int(Label_height_4.Text))
                Items: =Gal_LiftingWorkControl
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                Selectable: =false
                ShowScrollbar: =false
                TemplatePadding: =1
                TemplateSize: =Title3_8.Height
                Width: =Parent.Width
                Y: =Label1_503.Height
                ZIndex: =3

                Label_height_4 As label:
                    Height: =20
                    OnSelect: =Select(Parent)
                    Size: =21
                    Text: =Title3_8.Height+Gallery3_7.TemplatePadding+5
                    Visible: =false
                    Width: =100
                    X: =498
                    ZIndex: =1

                Radio_PatrolTnspection_22 As radio:
                    BorderColor: =
                    FocusedBorderColor: =
                    FocusedBorderThickness: =0
                    Height: =25
                    HoverColor: =
                    Items: =["是","不适用"]
                    Layout: =Layout.Horizontal
                    PaddingBottom: =0
                    PaddingTop: =0
                    PressedColor: =
                    RadioSize: =15
                    Size: =12
                    Width: =155
                    ZIndex: =2

                Title3_8 As label:
                    AutoHeight: =true
                    Height: =39
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =15
                    PaddingTop: =0
                    Size: =12
                    Text: =ThisItem.Content
                    VerticalAlign: =VerticalAlign.Top
                    Width: =464
                    X: =155
                    ZIndex: =4

            Label1_503 As label:
                FontWeight: =FontWeight.Bold
                Height: =25
                Size: =11
                Text: ="现场安全控制措施：项目负责人应同现场负责人对以上控制措施进行检查确认"
                Width: =559
                ZIndex: =4

    Container_HighNew As groupContainer.verticalAutoLayoutContainer:
        Height: =1018
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        Visible: =If(Vis_Current="High",true,false)
        Width: =630
        X: =5
        Y: =46
        ZIndex: =9

        Container_HighNew_Title As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =100
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            Width: =630
            X: =5
            Y: =107
            ZIndex: =1

            Image3_10 As image:
                Height: =74
                Image: ='1694500910899'
                Width: =78
                ZIndex: =1

            Label3_1 As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =70
                Size: =21
                Text: |-
                    ="High Work Permit
                    高处作业许可证"
                Width: =560
                X: =36
                Y: =7
                ZIndex: =2

            Label3_12 As label:
                Align: =Align.Center
                Color: =RGBA(184, 0, 0, 1)
                FontWeight: =FontWeight.Semibold
                Height: =26
                Size: =10.5
                Text: ="高空作业定义：在坠落高度基准面2米以上（含2米）有可能坠落的高处进行的作业。"
                Width: =630
                Y: =74
                ZIndex: =3

        Container_HighNew_1 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label2_15.Height+Gallery5_7.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =2

            "Gallery5_7 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =If(Self.AllItemsCount=0,1,Self.AllItemsCount)*30
                Items: =Gal_HW_NameID
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =30
                Width: =Parent.Width
                Y: =31
                ZIndex: =1

                Rectangle3_7 As rectangle:
                    Height: =30
                    OnSelect: =Select(Parent)
                    Visible: =ThisItem.IsSelected
                    Width: =4
                    ZIndex: =6

                TextInput_HW_Name As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.Name
                    Fill: =RGBA(0, 0, 0, 0)
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    HintText: ="输入作业人员姓名"
                    OnChange: |-
                        =Patch(Gal_HW_NameID,ThisItem,{Name:Self.Text});
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =153
                    ZIndex: =7

                TextInput_HW_ID As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.ID
                    Fill: =RGBA(0, 0, 0, 0)
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    HintText: ="输入证件号"
                    OnChange: |-
                        =Patch(Gal_HW_NameID,ThisItem,{ID:Self.Text});
                        //ClearCollect(Gal_HW_NameIDPatch,Concat(ForAll(Gal_HW_NameID,Concatenate(Name,":",ID)),Value,";"))//gallery转为字符串
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =299
                    X: =331
                    ZIndex: =8

                Icon_HW_Cancel As icon.Cancel:
                    Height: =18
                    Icon: =Icon.Cancel
                    OnSelect: =Remove(Gal_HW_NameID,ThisItem)
                    Width: =20
                    X: =586
                    Y: =6
                    ZIndex: =9

                Image_Photo_3 As image:
                    Height: =30
                    Image: =ThisItem.Photo
                    OnSelect: |-
                        =Set(ShowPhoto,ThisItem.Photo);
                        Set(WhereBack,"ApplyLicence");
                        Navigate(PhotoGraph);
                    Width: =181
                    X: =153
                    ZIndex: =10

                TakePhoto_HW As icon.Camera:
                    Height: =30
                    Icon: =Icon.Camera
                    OnSelect: |-
                        =Set(Camera_MsgID,Gallery5_7.Selected);
                        Set(Camera_Type,"CollectHWMsg");
                        Reset(AddMediaButton1);//清空photo
                        Navigate(Camera)
                    Visible: =If(ThisItem.Photo=SampleImage,true,false)
                    Width: =44
                    X: =290
                    ZIndex: =11

            Label2_15 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="*登高作业人员"
                Width: =155
                ZIndex: =2

            Label2_16 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件号"
                Width: =302
                X: =328
                ZIndex: =3

            Icon_HW_Add As icon.Add:
                Color: =RGBA(255, 255, 255, 1)
                FocusedBorderThickness: =5
                Height: =30
                Icon: =Icon.Add
                OnSelect: |-
                    =Collect(Gal_HW_NameID,{Name:"",ID:"",Photo:SampleImage})
                Width: =30
                X: =582
                ZIndex: =4

            Label2_51 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件照片"
                Width: =173
                X: =155
                ZIndex: =5

        Container_HighNew_2 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =360
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            X: =5
            Y: =107
            ZIndex: =3

            Label1_205 As label:
                Height: =25
                Size: =12
                Text: ="施工内容描述"
                Width: =107
                Y: =102
                ZIndex: =3

            Label1_200 As label:
                Height: =25
                Size: =12
                Text: ="危害辨识"
                Width: =107
                Y: =205
                ZIndex: =4

            Label1_195 As label:
                Height: =25
                Size: =12
                Text: ="作业单位"
                Width: =107
                ZIndex: =5

            Label1_202 As label:
                Height: =25
                Size: =12
                Text: ="*作业等级"
                Width: =107
                Y: =152
                ZIndex: =7

            Label1_203 As label:
                Height: =25
                Size: =12
                Text: ="*设备与工具"
                Width: =120
                Y: =306
                ZIndex: =8

            Label1_198 As label:
                Height: =25
                Size: =12
                Text: ="现场监护人"
                Width: =107
                Y: =25
                ZIndex: =9

            TextInput_OnSiteGuardian1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpDirector_2.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =511
                X: =107
                Y: =25
                ZIndex: =11

            TextInput_OpUnit1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpUnit.Text
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =511
                X: =107
                ZIndex: =12

            TextInput_HWHazard1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Height: =25
                HintText: ="请输入存在的危害因素"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =458
                X: =161
                Y: =230
                ZIndex: =13

            TextInput_HWOtherTools As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Height: =25
                HintText: ="请输入所需使用的其他设备"
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =538
                X: =80
                Y: =331
                ZIndex: =14

            Label1_206 As label:
                Height: =25
                Size: =12
                Text: ="作业地点"
                Width: =107
                Y: =50
                ZIndex: =15

            TextInput_OpAr1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpAr.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =512
                X: =107
                Y: =50
                ZIndex: =16

            TextInput_OpCountent1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpCountent.Text
                DisplayMode: =DisplayMode.View
                Height: =50
                MaxLength: =65
                Mode: =TextMode.MultiLine
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =511
                X: =107
                Y: =100
                ZIndex: =17

            Radio_HWLevel As radio:
                BorderColor: =
                Default: =""
                FocusedBorderColor: =
                FocusedBorderThickness: =0
                Height: =60
                HoverColor: =
                Items: =["一级(2-5米)","二级(5-15米)","三级(15-30米)","特级(30米以上)"]
                Layout: =Layout.Horizontal
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                PressedColor: =
                RadioSize: =22
                Size: =12
                Width: =523
                X: =96
                Y: =150
                ZIndex: =18

            Label1_209 As label:
                Height: =26
                Size: =12
                Text: ="1）*存在的危害因素"
                Width: =160
                Y: =230
                ZIndex: =19

            Label1_211 As label:
                Height: =25
                Size: =12
                Text: ="2）*可能导致的后果"
                Width: =160
                Y: =256
                ZIndex: =20

            Label1_212 As label:
                Height: =25
                Size: =12
                Text: ="3）*相应的管控措施"
                Width: =160
                Y: =281
                ZIndex: =21

            TextInput_HWHazard2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Height: =25
                HintText: ="请输入可能导致的后果"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =458
                X: =161
                Y: =256
                ZIndex: =22

            TextInput_HWHazard3 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Height: =25
                HintText: ="请输入相应的管控措施"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =458
                X: =161
                Y: =281
                ZIndex: =23

            Checkbox_Tools1 As checkbox:
                CheckboxSize: =25
                Default: =
                Height: =30
                OnSelect: |-
                    =ClearCollect(
                        HW_Tools, 
                        {ToolsN: "自动升降平台/曲臂车", State: Checkbox_Tools1.Value },
                        {ToolsN: "脚手架", State: Checkbox_Tools2.Value },
                        {ToolsN: "梯子", State: Checkbox_Tools3.Value }
                    );
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                Size: =12
                Text: ="自动升降平台/曲臂车"
                Width: =208
                X: =107
                Y: =302
                ZIndex: =24

            Checkbox_Tools2 As checkbox:
                CheckboxSize: =25
                Default: =
                Height: =30
                OnSelect: |-
                    =ClearCollect(
                        HW_Tools, 
                        {ToolsN: "自动升降平台/曲臂车", State: Checkbox_Tools1.Value },
                        {ToolsN: "脚手架", State: Checkbox_Tools2.Value },
                        {ToolsN: "梯子", State: Checkbox_Tools3.Value }
                    );
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                Size: =12
                Text: ="脚手架"
                Width: =97
                X: =315
                Y: =302
                ZIndex: =25

            Checkbox_Tools3 As checkbox:
                CheckboxSize: =25
                Default: =
                Height: =30
                OnSelect: |-
                    =ClearCollect(
                        HW_Tools, 
                        {ToolsN: "自动升降平台/曲臂车", State: Checkbox_Tools1.Value },
                        {ToolsN: "脚手架", State: Checkbox_Tools2.Value },
                        {ToolsN: "梯子", State: Checkbox_Tools3.Value }
                    );
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                Size: =12
                Text: ="梯子"
                Width: =83
                X: =417
                Y: =302
                ZIndex: =26

            Label1_210 As label:
                Height: =25
                Size: =12
                Text: ="其他设备"
                Width: =83
                Y: =331
                ZIndex: =27

            Label1_158 As label:
                Height: =25
                Size: =12
                Text: ="开始时间"
                Width: =107
                Y: =75
                ZIndex: =28

            Label1_162 As label:
                Height: =25
                Size: =12
                Text: ="结束时间"
                Width: =100
                X: =310
                Y: =75
                ZIndex: =29

            TextInput_OpAr1_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Text(DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0),"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =203
                X: =107
                Y: =75
                ZIndex: =36

            TextInput_OpAr1_3 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Text(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0),"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =224
                X: =391
                Y: =75
                ZIndex: =37

            Label1_199 As label:
                Height: =26
                Size: =12
                Text: ="*施工方案"
                Visible: =false
                Width: =107
                Y: =152
                ZIndex: =38

            DataCardValue_ConstructionSchemeHigh As attachments:
                AddAttachmentText: ="附加文件(word/pdf/图片)"
                BorderColor: =RGBA(9, 33, 98, 1)
                Height: =110
                IsInDataCard: =true
                Items: =Blank()
                MaxAttachments: =3
                MaxAttachmentSize: =30
                PaddingBottom: =5
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PaddingRight: =5
                PaddingTop: =5
                Reset: =true
                Size: =12
                Tooltip: =
                Visible: =false
                Width: =500
                X: =115
                Y: =152
                ZIndex: =39

        Container_HighNew_17 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Gallery3_8.Height+Label1_504.Height+TextInput_ProjLederConfirm_6.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =4

            Label1_298 As label:
                Height: =25
                Size: =12
                Text: ="项目负责人确认："
                Width: =140
                Y: =Gallery3_8.Y+Gallery3_8.Height
                ZIndex: =1

            TextInput_ProjLederConfirm_6 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_ProjLeder.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =461
                X: =140
                Y: =Gallery3_8.Y+Gallery3_8.Height
                ZIndex: =2

            "Gallery3_8 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                DelayItemLoading: =true
                Height: =Sum(Self.AllItems,Int(Label_height_5.Text))
                Items: =Gal_HighWorkSafetyControl
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                Selectable: =false
                ShowScrollbar: =false
                TemplatePadding: =1
                TemplateSize: =Title3_9.Height
                Width: =Parent.Width
                Y: =Label1_504.Height
                ZIndex: =3

                Label_height_5 As label:
                    Height: =20
                    OnSelect: =Select(Parent)
                    Size: =21
                    Text: =Title3_9.Height+Gallery3_8.TemplatePadding+4
                    Visible: =false
                    Width: =100
                    X: =498
                    ZIndex: =1

                Radio_PatrolTnspection_23 As radio:
                    BorderColor: =
                    FocusedBorderColor: =
                    FocusedBorderThickness: =0
                    Height: =25
                    HoverColor: =
                    Items: =["是","不适用"]
                    Layout: =Layout.Horizontal
                    OnSelect: =
                    PaddingBottom: =0
                    PaddingTop: =0
                    PressedColor: =
                    RadioSize: =15
                    Size: =12
                    Width: =155
                    ZIndex: =2

                Title3_9 As label:
                    AutoHeight: =true
                    Height: =39
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =15
                    PaddingTop: =0
                    Size: =12
                    Text: =ThisItem.Content
                    VerticalAlign: =VerticalAlign.Top
                    Width: =465
                    X: =155
                    ZIndex: =4

            Label1_504 As label:
                FontWeight: =FontWeight.Bold
                Height: =25
                Size: =11
                Text: ="现场安全控制措施：项目负责人应同现场负责人对以上控制措施进行检查确认"
                Width: =559
                ZIndex: =4

    Container_NormalNew As groupContainer.verticalAutoLayoutContainer:
        Height: =1018
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        Visible: =If(Vis_Current="Normal",true,false)
        Width: =630
        X: =5
        Y: =46
        ZIndex: =10

        Container_NormalNew_MSG2 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label2_12.Height+Gallery5_6.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Visible: =false
            Width: =Parent.Width
            ZIndex: =1

            "Gallery5_6 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =If(Self.AllItemsCount=0,1,Self.AllItemsCount)*30
                Items: =Gal_CollectMsg
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =30
                Width: =630
                Y: =31
                ZIndex: =2

                Image_Photo As image:
                    Height: =30
                    Image: =ThisItem.Photo
                    OnSelect: |-
                        =Set(ShowPhoto,ThisItem.Photo);
                        Set(WhereBack,"ApplyLicence");
                        Navigate(PhotoGraph);
                    Width: =340
                    X: =290
                    ZIndex: =1

                TakePhoto As icon.Camera:
                    Height: =30
                    Icon: =Icon.Camera
                    OnSelect: |-
                        =Set(Camera_MsgID,Gallery5_6.Selected);
                        Set(Camera_Type,"CollectMsg");
                        Navigate(Camera)
                    Visible: =If(ThisItem.Photo=SampleImage,true,false)
                    X: =521
                    ZIndex: =2

                Cancel As icon.Cancel:
                    Height: =18
                    Icon: =Icon.Cancel
                    OnSelect: =Remove(Gal_CollectMsg,ThisItem)
                    Tooltip: ="删除该条信息"
                    Width: =20
                    X: =604
                    Y: =6
                    ZIndex: =3

                TextInput_IDtype As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.ID_Type
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    HintText: ="填写证件信息"
                    OnChange: |
                        =Patch(Gal_CollectMsg,ThisItem,{ID_Type:Self.Text});
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =290
                    ZIndex: =4

                Rectangle3_6 As rectangle:
                    Height: =30
                    OnSelect: =Select(Parent)
                    Visible: =ThisItem.IsSelected
                    Width: =4
                    ZIndex: =5

            Label2_12 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件信息"
                Width: =292
                ZIndex: =3

            Label2_14 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="拍照收集"
                Width: =338
                X: =292
                ZIndex: =4

            Icon1_8 As icon.Add:
                Color: =RGBA(255, 255, 255, 1)
                FocusedBorderThickness: =5
                Height: =30
                Icon: =Icon.Add
                OnSelect: |-
                    =Collect(Gal_CollectMsg,{ID_Type:"",Photo:SampleImage})
                Tooltip: ="新增一条空信息"
                Width: =30
                X: =600
                ZIndex: =5

        Container_NormalNew_Title As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =80
            LayoutMinHeight: =80
            LayoutMinWidth: =250
            Width: =Parent.Width
            X: =5
            Y: =107
            ZIndex: =2

            Image3_11 As image:
                Height: =74
                Image: ='1694500910899'
                Width: =78
                ZIndex: =1

            Label3 As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =76
                Size: =21
                Text: |-
                    ="Construction Permit
                    施工许可证"
                Width: =560
                X: =35
                ZIndex: =2

        Container_NormalNew_1 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =680
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            X: =5
            Y: =107
            ZIndex: =3

            DataCardValue17 As attachments:
                AddAttachmentText: ="附加文件(pdf/图片)"
                BorderColor: =RGBA(9, 33, 98, 1)
                DisplayMode: =Parent.DisplayMode
                Height: =97
                IsInDataCard: =true
                Items: =
                MaxAttachments: =2
                MaxAttachmentSize: =30
                PaddingBottom: =5
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PaddingRight: =5
                PaddingTop: =5
                Reset: =true
                Size: =12
                Tooltip: =
                Width: =486
                X: =116
                Y: =493
                ZIndex: =1

            ComboBox_OnSiteGuardian As combobox:
                BorderStyle: =BorderStyle.None
                ChevronBackground: =RGBA(0, 0, 0, 0)
                ChevronFill: =RGBA(50, 86, 160, 1)
                DisplayFields: =["DisplayName"]
                Height: =25
                InputTextPlaceholder: ="使用邮箱搜索"
                IsSearchable: =false
                Items: =AllPerson
                OnChange: |-
                    =If(
                        IsBlank(Self.Selected),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                OnSelect: |-
                    =ClearCollect(
                        AllPerson,
                        Office365Users.SearchUser({searchterm:ComboBox_OnSiteGuardian.SearchText}),
                        RenameColumns(ShowColumns(Filter(TPL_Login,HasAccount=false),"UserName","Email"),"UserName","DisplayName","Email","Mail")
                        );
                PaddingBottom: =1
                PaddingTop: =1
                SearchFields: =["Mail"]
                SearchItems: =[]
                SelectMultiple: =false
                Size: =12
                Visible: =false
                Width: =190
                X: =116
                Y: =133
                ZIndex: =2

            Label1_144 As label:
                Height: =25
                Size: =12
                Text: ="*项目负责人"
                Width: =110
                Y: =83
                ZIndex: =3

            Label1_139 As label:
                Height: =25
                Size: =12
                Text: ="*作业单位"
                Width: =90
                Y: =56
                ZIndex: =4

            Label1_142 As label:
                Color: =/*If(isTimeWrong=true,Color.DarkRed,RGBA(0, 0, 0, 1))*/
                Height: =25
                Size: =12
                Text: ="*开始时间"
                Width: =90
                Y: =159
                ZIndex: =5

            Label1_151 As label:
                Height: =25
                Size: =12
                Text: ="*施工内容描述"
                Width: =120
                Y: =317
                ZIndex: =6

            Checkbox_Hoisting As checkbox:
                CheckboxSize: =28
                Default: |-
                    =Switch(JudgeEditMode,
                    "New",false,
                    "Change",If("Lifting" in First(Current_Normal).OtherLicenses,true,false)
                    )
                Height: =25
                OnSelect: |-
                    =ClearCollect(
                        Licences, 
                        {LicenceN: "Normal", State: true },
                        {LicenceN: "High", State: Checkbox_Heights.Value },
                        {LicenceN: "Lifting", State: Checkbox_Hoisting.Value },
                        {LicenceN: "Confined Space", State: Checkbox_Limited.Value },
                        {LicenceN: "Hot", State: Checkbox_HotWork.Value },
                        {LicenceN: "Temporary Electricity", State: Checkbox_TemporaryElectricity.Value }
                    );
                    If(
                        ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                        (
                            (DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)>1440||
                        DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)<0
                        )
                        ||
                        DateValue(DatePicker_StartDate.SelectedDate)<>Today()
                        ),
                        Set(isTimeWrong,true),
                        Set(isTimeWrong,false)
                    )
                PaddingBottom: =2
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =2
                Size: =12
                Text: ="吊装作业"
                Width: =120
                X: =282
                Y: =264
                ZIndex: =7

            Label1_150 As label:
                Height: =25
                Size: =12
                Text: ="*特种许可"
                Width: =90
                Y: =264
                ZIndex: =8

            Label1_145 As label:
                Height: =25
                Size: =12
                Text: ="*联系方式"
                Width: =90
                X: =310
                Y: =83
                ZIndex: =9

            Label1_140 As label:
                Height: =25
                Size: =12
                Text: ="*作业单位负责人"
                Width: =140
                Y: =108
                ZIndex: =10

            Label1_141 As label:
                Height: =25
                Size: =12
                Text: ="*联系方式"
                Width: =90
                X: =310
                Y: =108
                ZIndex: =11

            Label1_147 As label:
                Height: =25
                Size: =12
                Text: ="*现场监护人"
                Width: =110
                Y: =133
                ZIndex: =12

            Label1_148 As label:
                Height: =25
                Size: =12
                Text: ="*作业区域"
                Width: =90
                Y: =213
                ZIndex: =13

            Label1_146 As label:
                Height: =25
                Size: =12
                Text: ="*联系方式"
                Width: =90
                X: =310
                Y: =133
                ZIndex: =14

            Label1_149 As label:
                Height: =25
                Size: =12
                Text: ="*主要设备/工具"
                Width: =140
                Y: =239
                ZIndex: =15

            Checkbox_HotWork As checkbox:
                CheckboxSize: =28
                Default: |-
                    =Switch(JudgeEditMode,
                    "New",false,
                    "Change",If("Hot" in First(Current_Normal).OtherLicenses,true,false)
                    )
                Height: =25
                OnSelect: |-
                    =ClearCollect(
                        Licences, 
                        {LicenceN: "Normal", State: true },
                        {LicenceN: "High", State: Checkbox_Heights.Value },
                        {LicenceN: "Lifting", State: Checkbox_Hoisting.Value },
                        {LicenceN: "Confined Space", State: Checkbox_Limited.Value },
                        {LicenceN: "Hot", State: Checkbox_HotWork.Value },
                        {LicenceN: "Temporary Electricity", State: Checkbox_TemporaryElectricity.Value }
                    );
                    If(
                        ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                        (
                            (DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)>1440||
                        DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)<0
                        )
                        ||
                        DateValue(DatePicker_StartDate.SelectedDate)<>Today()
                        ),
                        Set(isTimeWrong,true),
                        Set(isTimeWrong,false)
                    )
                PaddingBottom: =2
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =2
                Size: =12
                Text: ="热加工操作"
                Width: =138
                X: =116
                Y: =289
                ZIndex: =16

            Checkbox_Limited As checkbox:
                CheckboxSize: =28
                Default: |-
                    =Switch(JudgeEditMode,
                    "New",false,
                    "Change",If("Confined Space" in First(Current_Normal).OtherLicenses,true,false)
                    )
                Height: =25
                OnSelect: |-
                    =ClearCollect(
                        Licences, 
                        {LicenceN: "Normal", State: true },
                        {LicenceN: "High", State: Checkbox_Heights.Value },
                        {LicenceN: "Lifting", State: Checkbox_Hoisting.Value },
                        {LicenceN: "Confined Space", State: Checkbox_Limited.Value },
                        {LicenceN: "Hot", State: Checkbox_HotWork.Value },
                        {LicenceN: "Temporary Electricity", State: Checkbox_TemporaryElectricity.Value }
                    );
                    If(
                        ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                        (
                            (DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)>1440||
                        DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)<0
                        )
                        ||
                        DateValue(DatePicker_StartDate.SelectedDate)<>Today()
                        ),
                        Set(isTimeWrong,true),
                        Set(isTimeWrong,false)
                    )
                PaddingBottom: =2
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =2
                Size: =12
                Text: ="有限空间作业"
                Width: =160
                X: =453
                Y: =264
                ZIndex: =17

            Checkbox_TemporaryElectricity As checkbox:
                CheckboxSize: =28
                Default: |-
                    =Switch(JudgeEditMode,
                    "New",false,
                    "Change",If("Temporary Electricity" in First(Current_Normal).OtherLicenses,true,false)
                    )
                Height: =25
                OnSelect: |-
                    =ClearCollect(
                        Licences, 
                        {LicenceN: "Normal", State: true },
                        {LicenceN: "High", State: Checkbox_Heights.Value },
                        {LicenceN: "Lifting", State: Checkbox_Hoisting.Value },
                        {LicenceN: "Confined Space", State: Checkbox_Limited.Value },
                        {LicenceN: "Hot", State: Checkbox_HotWork.Value },
                        {LicenceN: "Temporary Electricity", State: Checkbox_TemporaryElectricity.Value }
                    );
                    If(
                        ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                        (
                            (DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)>1440||
                        DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)<0
                        )
                        ||
                        DateValue(DatePicker_StartDate.SelectedDate)<>Today()
                        ),
                        Set(isTimeWrong,true),
                        Set(isTimeWrong,false)
                    )
                PaddingBottom: =2
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =2
                Size: =12
                Text: ="临时用电作业"
                Width: =156
                X: =282
                Y: =289
                ZIndex: =18

            Checkbox_Heights As checkbox:
                CheckboxSize: =28
                Default: |-
                    =Switch(JudgeEditMode,
                    "New",false,
                    "Change",If("High" in First(Current_Normal).OtherLicenses,true,false)
                    )
                Height: =25
                OnSelect: |
                    =ClearCollect(
                        Licences, 
                        {LicenceN: "Normal", State: true },
                        {LicenceN: "High", State: Checkbox_Heights.Value },
                        {LicenceN: "Lifting", State: Checkbox_Hoisting.Value },
                        {LicenceN: "Confined Space", State: Checkbox_Limited.Value },
                        {LicenceN: "Hot", State: Checkbox_HotWork.Value },
                        {LicenceN: "Temporary Electricity", State: Checkbox_TemporaryElectricity.Value }
                    );
                    If(
                        ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                        (
                            (DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)>1440||
                        DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)<0
                        )
                        ||
                        DateValue(DatePicker_StartDate.SelectedDate)<>Today()
                        ),
                        Set(isTimeWrong,true),
                        Set(isTimeWrong,false)
                    )
                PaddingBottom: =2
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =2
                Size: =12
                Text: ="高处作业"
                Width: =120
                X: =116
                Y: =264
                ZIndex: =19

            Label1_143 As label:
                Color: =/*If(isTimeWrong=true,Color.DarkRed,RGBA(0, 0, 0, 1))*/
                Height: =25
                Size: =12
                Text: ="*结束时间"
                Width: =90
                Y: =186
                ZIndex: =20

            TextInput_OpUnit As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Switch(JudgeEditMode,
                    "New","",
                    "Change",First(Current_Normal).OpUnit
                    )
                Height: =25
                HintText: ="输入作业单位"
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =500
                X: =116
                Y: =56
                ZIndex: =21

            "'TextInput_OpDirectorM/P' As text":
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Switch(JudgeEditMode,
                    "New","",
                    "Change",Int(First(Current_Normal).'OpDirectorM/P')
                    )
                Format: =TextFormat.Number
                Height: =25
                HintText: ="作业单位负责人手机号"
                OnChange: |-
                    =If(
                        Not(IsMatch(Self.Text, "\d{11}")) && !IsBlank(Self.Text),
                        Notify("请输入十一位数字", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =226
                X: =390
                Y: =108
                ZIndex: =22

            TextInput_OpDirector As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Switch(JudgeEditMode,
                    "New","",
                    "Change",First(Current_Normal).OpDirector
                    )
                Height: =25
                HintText: ="作业单位负责人姓名"
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =166
                X: =140
                Y: =108
                ZIndex: =23

            "'TextInput_ProjLederM/P' As text":
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Switch(JudgeEditMode,
                    "New","",
                    "Change",Int(First(Current_Normal).'ProjLeaderM/P')
                    )
                Format: =TextFormat.Number
                Height: =25
                HintText: ="项目负责人手机号"
                OnChange: |-
                    =If(
                        Not(IsMatch(Self.Text, "\d{11}")) && !IsBlank(Self.Text),
                        Notify("请输入十一位数字", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =226
                X: =390
                Y: =83
                ZIndex: =24

            "'TextInputTextInput_OnSiteGuardianM/P' As text":
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Switch(JudgeEditMode,
                    "New","",
                    "Change",Int(First(Current_Normal).'OnSiteGuardianM/P')
                    )
                Format: =TextFormat.Number
                Height: =25
                HintText: ="现场监护人手机号"
                OnChange: |-
                    =If(
                        Not(IsMatch(Self.Text, "\d{11}")) && !IsBlank(Self.Text),
                        Notify("请输入十一位数字", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =226
                X: =390
                Y: =133
                ZIndex: =25

            TextInput_MainTools As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Switch(JudgeEditMode,
                    "New","",
                    "Change",First(Current_Normal).MainTools
                    )
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                HintText: ="请填写主要作业设备或工具"
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =497
                X: =116
                Y: =239
                ZIndex: =26

            DatePicker_StartDate As datepicker:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =/*If(isTimeWrong=true,Color.DarkRed,RGBA(0, 0, 0, 1))*/
                DefaultDate: |-
                    =Switch(JudgeEditMode,
                    "New",Today(),
                    "Change",First(Current_Normal).StartTime
                    )
                Format: ="yyyy/mm/dd"
                Height: =24
                OnChange: |-
                    =If(
                        ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                        (
                            (DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)>1440||
                        DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)<0
                        )
                        ||
                        DateValue(DatePicker_StartDate.SelectedDate)<>Today()
                        ),
                        Set(isTimeWrong,true),
                        Set(isTimeWrong,false)
                    )
                PaddingLeft: =5
                PaddingTop: =5
                Size: =12
                Width: =190
                X: =116
                Y: =160
                ZIndex: =27

            DatePicker_EndDate As datepicker:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =/*If(isTimeWrong=true,Color.DarkRed,RGBA(0, 0, 0, 1))*/
                DefaultDate: |-
                    =Switch(JudgeEditMode,
                    "New",Today(),
                    "Change",First(Current_Normal).EndTime
                    )
                Format: ="yyyy/mm/dd"
                Height: =24
                OnChange: |-
                    =If(
                        ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                        (
                            (DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)>1440||
                        DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)<0
                        )
                        ||
                        DateValue(DatePicker_StartDate.SelectedDate)<>Today()
                        ),
                        Set(isTimeWrong,true),
                        Set(isTimeWrong,false)
                    )
                PaddingLeft: =5
                PaddingTop: =5
                Size: =12
                Width: =190
                X: =116
                Y: =187
                ZIndex: =28

            TextInput_OpCountent As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Switch(JudgeEditMode,
                    "New","",
                    "Change",First(Current_Normal).OpCountent
                    )
                Height: =50
                HintText: ="对施工内容进行描述"
                MaxLength: =60
                Mode: =TextMode.MultiLine
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =514
                X: =116
                Y: =315
                ZIndex: =29

            Label1_165 As label:
                Height: =25
                Size: =12
                Text: ="*是否需要巡检"
                VerticalAlign: =VerticalAlign.Top
                Width: =120
                Y: =593
                ZIndex: =30

            Radio_IsPatrol As radio:
                BorderColor: =
                Default: |-
                    =
                    
                    Switch(JudgeEditMode,
                    "New",If(
                        "true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"),
                        "是",
                        "否"
                        ),
                    "Change",Switch(First(Current_Normal).IsPatrol,true,"是",false,"否")
                    )
                DisplayMode: |-
                    =If(
                        "true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"),
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                        )
                FocusedBorderColor: =
                FocusedBorderThickness: =0
                Height: =36
                HoverColor: =
                Items: =["是","否"]
                Layout: =Layout.Horizontal
                OnSelect: =true
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                PressedColor: =
                RadioSize: =24
                Size: =12
                Width: =486
                X: =116
                Y: =591
                ZIndex: =31

            TextInput_OpAr As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Switch(JudgeEditMode,
                    "New","",
                    "Change",First(Current_Normal).OpAr
                    )
                Height: =26
                HintText: ="输入详细作业区域"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =253
                X: =370
                Y: =213
                ZIndex: =32

            Label1_157 As label:
                Height: =25
                Size: =12
                Text: ="*申请部门"
                Width: =90
                Y: =31
                ZIndex: =33

            Dropdown_AppliDept As dropdown:
                BorderStyle: =BorderStyle.None
                ChevronBackground: =RGBA(0, 0, 0, 0)
                ChevronFill: =RGBA(39, 67, 125, 1)
                Default: |-
                    =
                    Switch(JudgeEditMode,
                    "New","无",
                    "Change",First(Current_Normal).ApplicationDept
                    )
                Height: =25
                Items: =Col_TotalDept
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                Size: =12
                Width: =190
                X: =116
                Y: =31
                ZIndex: =34

            Label1_159 As label:
                Height: =25
                Size: =12
                Text: ="时"
                Width: =35
                X: =421
                Y: =160
                ZIndex: =35

            Dropdown_StartTime As dropdown:
                BorderStyle: =BorderStyle.None
                Color: =/*If(isTimeWrong=true,Color.DarkRed,RGBA(0, 0, 0, 1))*/
                Default: |-
                    =Switch(JudgeEditMode,
                    "New","0",
                    "Change",Hour(First(Current_Normal).StartTime)
                    )
                Height: =25
                Items: |-
                    =["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15",
                    "16","17","18","19","20","21","22","23"]
                OnChange: |-
                    =If(
                        ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                        (
                            (DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)>1440||
                        DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)<0
                        )
                        ||
                        DateValue(DatePicker_StartDate.SelectedDate)<>Today()
                        ),
                        Set(isTimeWrong,true),
                        Set(isTimeWrong,false)
                    )
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                Size: =12
                Width: =111
                X: =310
                Y: =160
                ZIndex: =36

            Label1_161 As label:
                Height: =25
                Size: =12
                Text: ="时"
                Width: =35
                X: =421
                Y: =188
                ZIndex: =37

            Dropdown_EndTime As dropdown:
                BorderStyle: =BorderStyle.None
                Color: =/*If(isTimeWrong=true,Color.DarkRed,RGBA(0, 0, 0, 1))*/
                Default: |-
                    =Switch(JudgeEditMode,
                    "New","0",
                    "Change",Hour(First(Current_Normal).EndTime)
                    )
                Height: =25
                Items: |-
                    =["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15",
                    "16","17","18","19","20","21","22","23"]
                OnChange: |-
                    =If(
                        ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                        (
                            (DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)>1440||
                        DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)<0
                        )
                        ||
                        DateValue(DatePicker_StartDate.SelectedDate)<>Today()
                        ),
                        Set(isTimeWrong,true),
                        Set(isTimeWrong,false)
                    )
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                Size: =12
                Width: =111
                X: =310
                Y: =187
                ZIndex: =38

            TextInput_ProjLeder As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =PersonalMsg.UserName
                DisplayMode: =DisplayMode.View
                Height: =25
                HintText: =""
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =190
                X: =116
                Y: =83
                ZIndex: =39

            Label1_160 As label:
                Height: =25
                Size: =12
                Text: ="*项目名称"
                Width: =90
                X: =307
                Y: =6
                ZIndex: =40

            TextInput_OpUnit_6 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Switch(JudgeEditMode,
                    "New","",
                    "Change",First(Current_Normal).ProjName
                    )
                Height: =25
                HintText: ="输入项目名称"
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =226
                X: =390
                Y: =6
                ZIndex: =41

            Label1_193 As label:
                Height: =25
                Size: =12
                Text: ="*项目编号"
                Width: =90
                Y: =6
                ZIndex: =42

            TextInput_ProjLeder_3 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Switch(JudgeEditMode,
                    "New",NewProjID,
                    "Change",First(Current_Normal).ProjID
                    )
                DisplayMode: =DisplayMode.View
                Height: =25
                HintText: =""
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =198
                X: =116
                Y: =6
                ZIndex: =43

            TextInput_OpDirector_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Switch(JudgeEditMode,
                    "New","",
                    "Change",First(Current_Normal).OnSiteGuardian
                    )
                Height: =26
                HintText: ="现场监护人姓名"
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =190
                X: =116
                Y: =133
                ZIndex: =44

            ComboBox1 As combobox:
                DefaultSelectedItems: |-
                    =Switch(JudgeEditMode,
                    "New",[],
                    "Change",ShowColumns(Split(First(Current_Normal).OpDept,";"),"Value")
                    )
                DisplayFields: =["Value"]
                Height: =25
                Items: =Col_TotalDept
                OnChange: =ClearCollect(Col_SortedDept,Sort(ComboBox1.SelectedItems,Value,SortOrder.Ascending))
                PaddingBottom: =1
                PaddingTop: =1
                SearchFields: =["Value"]
                SearchItems: =Search(Col_TotalDept,ComboBox1.SearchText,"Value")
                Size: =12
                Width: =245
                X: =116
                Y: =213
                ZIndex: =45

            Label1_163 As label:
                Height: =25
                Size: =12
                Text: ="分"
                Width: =35
                X: =567
                Y: =159
                ZIndex: =46

            Dropdown_StartTime_1 As dropdown:
                BorderStyle: =BorderStyle.None
                Color: =/*If(isTimeWrong=true,Color.DarkRed,RGBA(0, 0, 0, 1))*/
                Default: |-
                    =Switch(JudgeEditMode,
                    "New","0",
                    "Change",Minute(First(Current_Normal).StartTime)
                    )
                Height: =25
                Items: =["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"]
                OnChange: |-
                    =If(
                        ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                        (
                            (DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)>1440||
                        DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)<0
                        )
                        ||
                        DateValue(DatePicker_StartDate.SelectedDate)<>Today()
                        ),
                        Set(isTimeWrong,true),
                        Set(isTimeWrong,false)
                    )
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                Size: =12
                Width: =111
                X: =456
                Y: =159
                ZIndex: =47

            Label1_178 As label:
                Height: =25
                Size: =12
                Text: ="分"
                Width: =35
                X: =567
                Y: =187
                ZIndex: =48

            Dropdown_EndTime_1 As dropdown:
                BorderStyle: =BorderStyle.None
                Color: =/*If(isTimeWrong=true,Color.DarkRed,RGBA(0, 0, 0, 1))*/
                Default: |-
                    =Switch(JudgeEditMode,
                    "New","0",
                    "Change",Minute(First(Current_Normal).EndTime)
                    )
                Height: =25
                Items: =["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"]
                OnChange: |-
                    =If(
                        ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                        (
                            (DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)>1440||
                        DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)<0
                        )
                        ||
                        DateValue(DatePicker_StartDate.SelectedDate)<>Today()
                        ),
                        Set(isTimeWrong,true),
                        Set(isTimeWrong,false)
                    )
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                Size: =12
                Width: =111
                X: =456
                Y: =186
                ZIndex: =49

            Label1_177 As label:
                Height: =25
                Size: =12
                Text: ="其他协作人员"
                Width: =116
                Y: =365
                ZIndex: =50

            TextInput_OtherCoWoker As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Switch(JudgeEditMode,
                    "New","",
                    "Change",First(Current_Normal).OtherCoWoker
                    )
                Height: =25
                HintText: ="请输入其他协作人员姓名"
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =504
                X: =116
                Y: =365
                ZIndex: =51

            Label1_196 As label:
                Height: =26
                Size: =12
                Text: ="*上传培训照片"
                Width: =116
                Y: =390
                ZIndex: =52

            Label1_197 As label:
                Height: =26
                Size: =12
                Text: ="*上传交底材料"
                Width: =116
                Y: =493
                ZIndex: =53

            DataCardValue17_1 As attachments:
                AddAttachmentText: ="附加文件(图片)"
                BorderColor: =RGBA(9, 33, 98, 1)
                Height: =103
                IsInDataCard: =true
                Items: =
                MaxAttachments: =1
                MaxAttachmentSize: =30
                PaddingBottom: =5
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PaddingRight: =5
                PaddingTop: =5
                Reset: =true
                Size: =12
                Tooltip: =
                Width: =486
                X: =116
                Y: =390
                ZIndex: =56

            Label1_251 As label:
                Height: =25
                Size: =12
                Text: ="*是否备案"
                VerticalAlign: =VerticalAlign.Top
                Width: =120
                Y: =629
                ZIndex: =57

            Radio_IsBackup As radio:
                BorderColor: =
                FocusedBorderColor: =
                FocusedBorderThickness: =0
                Height: =36
                HoverColor: =
                Items: =["是","否"]
                Layout: =Layout.Horizontal
                OnSelect: =true
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                PressedColor: =
                RadioSize: =24
                Size: =12
                Width: =486
                X: =116
                Y: =627
                ZIndex: =58

    Container_TemporaryElectricityNew As groupContainer.verticalAutoLayoutContainer:
        Height: =1018
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        Visible: =If(Vis_Current="Temporary Electricity",true,false)
        Width: =630
        X: =5
        Y: =46
        ZIndex: =12

        Container_TemporaryElectricityNew_Title As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =110
            LayoutMinHeight: =70
            LayoutMinWidth: =250
            Width: =630
            X: =5
            Y: =107
            ZIndex: =1

            Image3_1 As image:
                Height: =74
                Image: ='1694500910899'
                Width: =78
                ZIndex: =1

            Label3_4 As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =70
                Size: =21
                Text: |-
                    ="Temporary Electricity Use Work Permit
                    临时用电作业许可证"
                Width: =560
                X: =36
                Y: =7
                ZIndex: =2

            Label3_14 As label:
                Align: =Align.Center
                Color: =RGBA(184, 0, 0, 1)
                FontWeight: =FontWeight.Semibold
                Height: =33
                Size: =10.5
                Text: ="定义：除按标准成套配置的，有插头、连线、插座等专用接线装置以外的，所有其他用于临时性用电的电缆、电线、电气开关、设备等，简称临时用电 【使用时间超过1个月的，不能申请临时用电】"
                Width: =630
                Y: =77
                ZIndex: =3

        Container_TemporaryElectricityNew_1 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =55
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =630
            X: =5
            Y: =107
            ZIndex: =2

            Label1_319 As label:
                Height: =25
                Size: =12
                Text: ="作业地点"
                Width: =80
                Y: =27
                ZIndex: =70

            TextInput_OpAr5 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpAr.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =537
                X: =80
                Y: =27
                ZIndex: =71

            Label1_314 As label:
                Height: =25
                Size: =12
                Text: ="作业单位"
                Width: =80
                Y: =2
                ZIndex: =72

            TextInput_OpUnit5 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpUnit.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =537
                X: =80
                Y: =2
                ZIndex: =73

        Container_TemporaryElectricityNew_2 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label2_8.Height+Gallery5_4.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =3

            "Gallery5_4 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =If(Self.AllItemsCount=0,1,Self.AllItemsCount)*30
                Items: =Gal_TEU_NameID
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =30
                Width: =630
                Y: =31
                ZIndex: =1

                Rectangle3_4 As rectangle:
                    Height: =30
                    OnSelect: =Select(Parent)
                    Visible: =ThisItem.IsSelected
                    Width: =4
                    ZIndex: =6

                TextInput_TEU_Worker As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.Name
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    HintText: ="输入作业人员姓名"
                    OnChange: |-
                        =Patch(Gal_TEU_NameID,ThisItem,{Name:Self.Text});
                        ClearCollect(Gal_TEU_NameIDPatch,Concat(ForAll(Gal_TEU_NameID,Concatenate(Name,":",ID)),Value,";"))
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =151
                    X: =4
                    ZIndex: =7

                TextInput_TEU_ID As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.ID
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    HintText: ="输入证件号"
                    OnChange: |-
                        =Patch(Gal_TEU_NameID,ThisItem,{ID:Self.Text});
                        ClearCollect(Gal_TEU_NameIDPatch,Concat(ForAll(Gal_TEU_NameID,Concatenate(Name,":",ID)),Value,";"))
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =294
                    X: =336
                    ZIndex: =8

                Icon4_4 As icon.Cancel:
                    Height: =18
                    Icon: =Icon.Cancel
                    OnSelect: =Remove(Gal_TEU_NameID,ThisItem)
                    Width: =20
                    X: =589
                    Y: =6
                    ZIndex: =9

                Image_Photo_7 As image:
                    Height: =30
                    Image: =ThisItem.Photo
                    OnSelect: |-
                        =Set(ShowPhoto,ThisItem.Photo);
                        Set(WhereBack,"ApplyLicence");
                        
                        Navigate(PhotoGraph);
                    Width: =181
                    X: =155
                    ZIndex: =10

                TakePhoto_HW_4 As icon.Camera:
                    Height: =30
                    Icon: =Icon.Camera
                    OnSelect: |-
                        =Set(Camera_MsgID,Gallery5_4.Selected);
                        Set(Camera_Type,"CollectTEUMsg");
                        Reset(AddMediaButton1);//清空photo
                        Navigate(Camera)
                    Visible: =If(ThisItem.Photo=SampleImage,true,false)
                    Width: =44
                    X: =292
                    ZIndex: =11

            Label2_8 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="*临时用电作业人员"
                Width: =155
                ZIndex: =2

            Label2_9 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件号"
                Width: =302
                X: =328
                ZIndex: =3

            Icon1_6 As icon.Add:
                Color: =RGBA(255, 255, 255, 1)
                FocusedBorderThickness: =5
                Height: =30
                Icon: =Icon.Add
                OnSelect: |-
                    =Collect(Gal_TEU_NameID,{Name:"",ID:"",Photo:SampleImage})
                Width: =30
                X: =586
                ZIndex: =4

            Label2_55 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件照片"
                Width: =173
                X: =155
                ZIndex: =5

        Container_TemporaryElectricityNew_3 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =280
            LayoutMinHeight: =60
            LayoutMinWidth: =250
            Width: =Parent.Width
            X: =40
            ZIndex: =4

            Label1_322 As label:
                Height: =25
                Size: =12
                Text: ="现场监护人"
                Width: =99
                X: =1
                Y: =2
                ZIndex: =28

            TextInput_OnSiteGuardian5 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpDirector_2.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =530
                X: =85
                Y: =2
                ZIndex: =29

            Label1_313 As label:
                Height: =25
                Size: =12
                Text: ="作业内容"
                Width: =80
                Y: =27
                ZIndex: =32

            Label1_318 As label:
                Height: =25
                Size: =12
                Text: ="*用电设备总负荷"
                Width: =133
                Y: =81
                ZIndex: =34

            TextInput_TotalLoad As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Format: =TextFormat.Number
                Height: =25
                HintText: ="输入用电设备总负荷"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =172
                X: =133
                Y: =81
                ZIndex: =35

            Label1_323 As label:
                Height: =25
                Size: =12
                Text: ="*工作电压"
                Width: =90
                X: =305
                Y: =81
                ZIndex: =36

            TextInput_WorkingVoltage As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Format: =TextFormat.Number
                Height: =25
                HintText: ="输入工作电压"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =219
                X: =395
                Y: =81
                ZIndex: =37

            Label1_330 As label:
                Height: =25
                Size: =12
                Text: ="*电源接入点"
                Width: =100
                Y: =106
                ZIndex: =38

            TextInput_PowerAccessPoint As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Height: =25
                HintText: ="输入电源接入点"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =514
                X: =100
                Y: =106
                ZIndex: =43

            Label1_324 As label:
                Height: =25
                Size: =12
                Text: ="危害辨识"
                Width: =80
                Y: =156
                ZIndex: =44

            TextInput_TEUHazard1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Height: =25
                HintText: ="请输入存在的危害因素"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =454
                X: =161
                Y: =181
                ZIndex: =45

            Label1_327 As label:
                Height: =25
                Size: =12
                Text: ="1）*存在的危害因素"
                Width: =160
                Y: =181
                ZIndex: =46

            Label1_328 As label:
                Height: =25
                Size: =12
                Text: ="2）*可能导致的后果"
                Width: =160
                Y: =206
                ZIndex: =47

            Label1_329 As label:
                Height: =25
                Size: =12
                Text: ="3）*相应的管控措施"
                Width: =160
                Y: =231
                ZIndex: =48

            TextInput_TEUHazard2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Height: =25
                HintText: ="请输入可能导致的后果"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =454
                X: =161
                Y: =206
                ZIndex: =49

            TextInput_TEUHazard3 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =""
                Height: =25
                HintText: ="请输入相应的管控措施"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =454
                X: =161
                Y: =231
                ZIndex: =50

            TextInput_OpCountent5 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpCountent.Text
                DisplayMode: =DisplayMode.View
                Height: =50
                MaxLength: =65
                Mode: =TextMode.MultiLine
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =529
                X: =85
                Y: =28
                ZIndex: =51

            Label1_182 As label:
                Height: =25
                Size: =12
                Text: ="开始时间"
                Width: =80
                Y: =131
                ZIndex: =52

            Label1_183 As label:
                Height: =25
                Size: =12
                Text: ="结束时间"
                Width: =80
                X: =315
                Y: =131
                ZIndex: =53

            TextInput_OpAr1_10 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Text(DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0),"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =205
                X: =83
                Y: =131
                ZIndex: =54

            TextInput_OpAr1_11 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Text(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0),"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =219
                X: =395
                Y: =131
                ZIndex: =55

            Label1_213 As label:
                Height: =26
                Size: =12
                Text: ="*施工方案"
                Visible: =false
                Width: =83
                Y: =81
                ZIndex: =56

            DataCardValue_ConstructionSchemeTemporaryElectricity As attachments:
                AddAttachmentText: ="附加文件(word/pdf/图片)"
                BorderColor: =RGBA(9, 33, 98, 1)
                Height: =110
                IsInDataCard: =true
                Items: =Blank()
                MaxAttachments: =3
                MaxAttachmentSize: =30
                PaddingBottom: =5
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PaddingRight: =5
                PaddingTop: =5
                Reset: =true
                Size: =12
                Tooltip: =
                Visible: =false
                Width: =530
                X: =85
                Y: =81
                ZIndex: =57

        Container_HighNew_15 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Gallery3_6.Height+Label1_502.Height+TextInput_ProjLederConfirm_4.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =5

            Label1_296 As label:
                Height: =25
                Size: =12
                Text: ="项目负责人确认："
                Width: =140
                Y: =Gallery3_6.Y+Gallery3_6.Height
                ZIndex: =1

            TextInput_ProjLederConfirm_4 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_ProjLeder.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =461
                X: =140
                Y: =Gallery3_6.Y+Gallery3_6.Height
                ZIndex: =2

            "Gallery3_6 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                DelayItemLoading: =true
                Height: =Sum(Self.AllItems,Int(Label_height_3.Text))
                Items: =Gal_TemporaryElectricityUseWorkSafetyControl
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                Selectable: =false
                ShowScrollbar: =false
                TemplatePadding: =1
                TemplateSize: =Title3_7.Height
                Width: =Parent.Width
                Y: =Label1_502.Height
                ZIndex: =3

                Label_height_3 As label:
                    Height: =20
                    OnSelect: =Select(Parent)
                    Size: =21
                    Text: =Title3_7.Height+Gallery3_6.TemplatePadding+4
                    Visible: =false
                    Width: =100
                    X: =498
                    ZIndex: =1

                Radio_PatrolTnspection_21 As radio:
                    BorderColor: =
                    FocusedBorderColor: =
                    FocusedBorderThickness: =0
                    Height: =25
                    HoverColor: =
                    Items: =["是","不适用"]
                    Layout: =Layout.Horizontal
                    PaddingBottom: =0
                    PaddingTop: =0
                    PressedColor: =
                    RadioSize: =15
                    Size: =12
                    Width: =155
                    ZIndex: =2

                Title3_7 As label:
                    AutoHeight: =true
                    Height: =20
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =15
                    PaddingTop: =0
                    Size: =12
                    Text: =ThisItem.Content
                    VerticalAlign: =VerticalAlign.Top
                    Width: =464
                    X: =155
                    ZIndex: =4

            Label1_502 As label:
                FontWeight: =FontWeight.Bold
                Height: =25
                Size: =11
                Text: ="现场安全控制措施：项目负责人应同现场负责人对以上控制措施进行检查确认"
                Width: =559
                ZIndex: =4

    Btn_ReturnHome1 As button:
        BorderThickness: =1
        FocusedBorderThickness: =1
        FontWeight: =FontWeight.Normal
        Height: =30
        OnSelect: =Navigate(home)
        RadiusBottomLeft: =2
        RadiusBottomRight: =2
        RadiusTopLeft: =2
        RadiusTopRight: =2
        Size: =12
        Text: ="返回主页"
        Width: =102
        X: =4
        Y: =1106
        ZIndex: =13

    Btn_Sub1_2 As button:
        BorderThickness: =1
        DisplayMode: =
        FocusedBorderThickness: =1
        FontWeight: =FontWeight.Normal
        Height: =28
        OnSelect: |+
            =ClearCollect(Gal_Ispatch,{Value:true});
            If(
                ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                (
                    (DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)>1440||
                DateDiff((DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0)),(DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0)),TimeUnit.Minutes)<0
                )
                ||
                DateValue(DatePicker_StartDate.SelectedDate)<>Today()
                ),
                Set(isTimeWrong,true),
                Set(isTimeWrong,false)
            );
            
            //normal表为空, 提醒
            //If("Normal" in Concat(Filter(Licences,State=true),LicenceN),
            If(IsBlank(TextInput_OpUnit_6.Text)||IsBlank(TextInput_OpUnit.Text)||IsBlank('TextInput_ProjLederM/P'.Text)||IsBlank(TextInput_OpDirector.Text)||IsBlank('TextInput_OpDirectorM/P'.Text)||IsBlank('TextInputTextInput_OnSiteGuardianM/P'.Text)||IsBlank(TextInput_OpAr.Text)||IsBlank(TextInput_MainTools.Text)||IsBlank(TextInput_OpCountent.Text)||IsBlank(TextInput_OpDirector_2.Text)||IsBlank(Concat(ComboBox1.SelectedItems,";"))||IsBlank(Radio_IsBackup.Selected.Value),
            Notify("请检查Normal表", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}));
            If(isTimeWrong=true,Notify("特种作业只能当天申请，且工作时间不超过24小时", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}));
            If(
                !IsBlank(LookUp(DataCardValue17_1.Attachments,!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")).Name)||
                IsEmpty(DataCardValue17_1.Attachments),//限制上传的文件格式以及文件不为空
                Notify("培训照片请上传图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            );
            If(
                !IsBlank(LookUp(DataCardValue17.Attachments,!EndsWith(ThisRecord.Name,"pdf")&&!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")).Name)||
                IsEmpty(DataCardValue17.Attachments),//限制上传的文件格式以及文件不为空
                Notify("交底材料请上传Pdf或图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            );
            
            
            
            
            //High表为空, 提醒
            If("High" in Concat(Filter(Licences,State=true),LicenceN),
            If(IsBlank(TextInput_HWHazard1.Text)||IsBlank(TextInput_HWHazard2.Text)||IsBlank(TextInput_HWHazard3.Text)||IsBlank(Radio_HWLevel.Selected.Value),
            Notify("请检查High表", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //High表安全控制提醒
            If("High" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery3_8.AllItems,If(IsBlank(ThisRecord.Radio_PatrolTnspection_23.Selected),
            Notify("请确认High表安全控制措施", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))));
            //登高人员信息表不能为空
            If("High" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery5_7.AllItems,If(!IsBlank(ThisRecord.TextInput_HW_Name.Text)&&(ThisRecord.Image_Photo_3.Image<>SampleImage||!IsBlank(ThisRecord.TextInput_HW_ID.Text)),"",Notify("请完善登高作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            If(Gallery5_7.AllItemsCount=0,Notify("请完善登高作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))
            );
            //施工方案不能为空
            /*If("High" in Concat(Filter(Licences,State=true),LicenceN),
            If(
                !IsBlank(LookUp(DataCardValue_ConstructionSchemeHigh.Attachments,!EndsWith(ThisRecord.Name,"pdf")&&!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")&&!EndsWith(ThisRecord.Name,"doc")&&!EndsWith(ThisRecord.Name,"docx")).Name)||
                IsBlank(LookUp(DataCardValue_ConstructionSchemeHigh.Attachments,"" in ThisRecord.Name).Name),//限制上传的文件格式以及文件不为空
                Notify("登高作业施工方案请上传Word/Pdf/图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            ));*/
            
            
            //Lifting表为空, 提醒
            If("Lifting" in Concat(Filter(Licences,State=true),LicenceN),
            If(IsBlank(TextInput_SuspendedObject.Text)||IsBlank(TextInput_SuspendedObjectWeight.Text)||IsBlank(TextInput_LiftingCapacity.Text)||IsBlank(TextInput_LWHazard1.Text)||IsBlank(TextInput_LWHazard2.Text)||IsBlank(TextInput_LWHazard3.Text),
            Notify("请检查Lifting表", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //Lifting表安全控制提醒
            If("Lifting" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery3_7.AllItems,If(IsBlank(ThisRecord.Radio_PatrolTnspection_22.Selected),Notify("请确认Lifting表安全控制措施", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))));
            //吊装设备信息表不能为空
            If("Lifting" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery5_1.AllItems,If(IsBlank(ThisRecord.TextInput_LW_Equipments.Text)||IsBlank(ThisRecord.TextInput_LW_EquipmentsID.Text),Notify("请完善吊装设备信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            If(Gallery5_1.AllItemsCount=0,Notify("请完善吊装设备信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //吊装人员信息表不能为空
            If("Lifting" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery5_2.AllItems,If(!IsBlank(ThisRecord.TextInput_LW_Worker.Text)&&(ThisRecord.Image_Photo_4.Image<>SampleImage||!IsBlank(ThisRecord.TextInput_LW_ID.Text)),"",Notify("请完善吊装作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            If(Gallery5_2.AllItemsCount=0,Notify("请完善吊装作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //吊装指挥人员信息表不能为空
            If("Lifting" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery5_3.AllItems,If(!IsBlank(ThisRecord.TextInput_LW_Commander.Text)&&(ThisRecord.Image_Photo_5.Image<>SampleImage||!IsBlank(ThisRecord.TextInput_LW_CommanderID.Text)),"",Notify("请完善吊装指挥人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            If(Gallery5_3.AllItemsCount=0,Notify("请完善吊装指挥人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //施工方案不能为空
            /*If("Lifting" in Concat(Filter(Licences,State=true),LicenceN),
            If(
                !IsBlank(LookUp(DataCardValue_ConstructionSchemeLifting.Attachments,!EndsWith(ThisRecord.Name,"pdf")&&!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")&&!EndsWith(ThisRecord.Name,"doc")&&!EndsWith(ThisRecord.Name,"docx")).Name)||
                IsBlank(LookUp(DataCardValue_ConstructionSchemeLifting.Attachments,"" in ThisRecord.Name).Name),//限制上传的文件格式以及文件不为空
                Notify("吊装作业施工方案请上传Word/Pdf/图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            ));*/
            
            
            //Confined Space表为空, 提醒
            If("Confined Space" in Concat(Filter(Licences,State=true),LicenceN),
            If(IsBlank(TextInput_CSW_Worker.Text)||IsBlank(TextInput_CSWHazard1.Text)||IsBlank(TextInput_CSWHazard2.Text)||IsBlank(TextInput_CSWHazard3.Text)||IsBlank(TextInput_Ventilation.Text)||IsBlank(TextInput_CSW_Worker.Text),
            Notify("请检查Confined Space表", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //Confined Space表安全控制提醒
            If("Confined Space" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery3_4.AllItems,If(IsBlank(ThisRecord.Radio_PatrolTnspection_19.Selected),Notify("请确认Confined Space表安全控制措施", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))));
            //施工方案不能为空
            /*If("Confined Space" in Concat(Filter(Licences,State=true),LicenceN),
            If(
                !IsBlank(LookUp(DataCardValue_ConstructionSchemeConfined.Attachments,!EndsWith(ThisRecord.Name,"pdf")&&!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")&&!EndsWith(ThisRecord.Name,"doc")&&!EndsWith(ThisRecord.Name,"docx")).Name)||
                IsBlank(LookUp(DataCardValue_ConstructionSchemeConfined.Attachments,"" in ThisRecord.Name).Name),//限制上传的文件格式以及文件不为空
                Notify("有限空间作业施工方案请上传Word/Pdf/图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            ));*/
            
            
            
            
            
            //Hot表为空, 提醒
            If("Hot" in Concat(Filter(Licences,State=true),LicenceN),
            If(IsBlank(TextInput_FWHazard1.Text)||IsBlank(TextInput_FWHazard2.Text)||IsBlank(TextInput_FWHazard3.Text)||IsBlank(TextInput_FWHazard1_4.Text)||IsBlank(TextInput_FWHazard1_5.Text)||IsBlank(TextInput_FWHazard1_6.Text)||IsBlank(Radio_FWLevel.SelectedText)||IsBlank(TextInput_FWTools.Text),
            Notify("请检查Hot表", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //Hot表安全控制提醒
            If("Hot" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery3_5.AllItems,If(IsBlank(ThisRecord.Radio_PatrolTnspection_20.Selected),
            Notify("请确认Hot表安全控制措施", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))));
            //动火作业人员信息不能为空
            If("Hot" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery5_5.AllItems,If(!IsBlank(ThisRecord.TextInput_HW_Worker.Text)&&(ThisRecord.Image_Photo_6.Image<>SampleImage||!IsBlank(ThisRecord.TextInput__HW_ID.Text)),"",Notify("请完善动火作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            If(Gallery5_5.AllItemsCount=0,Notify("请完善动火作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //施工方案不能为空
            /*If("Hot" in Concat(Filter(Licences,State=true),LicenceN),
            If(
                !IsBlank(LookUp(DataCardValue_ConstructionSchemeHot.Attachments,!EndsWith(ThisRecord.Name,"pdf")&&!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")&&!EndsWith(ThisRecord.Name,"doc")&&!EndsWith(ThisRecord.Name,"docx")).Name)||
                IsBlank(LookUp(DataCardValue_ConstructionSchemeHot.Attachments,"" in ThisRecord.Name).Name),//限制上传的文件格式以及文件不为空
                Notify("动火作业施工方案请上传Word/Pdf/图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            ));*/
            
            
            
            
            //Temporary Electricity表为空, 提醒
            If("Temporary Electricity" in Concat(Filter(Licences,State=true),LicenceN),
            If(IsBlank(TextInput_TotalLoad.Text)||IsBlank(TextInput_WorkingVoltage.Text)||IsBlank(TextInput_PowerAccessPoint.Text)||IsBlank(TextInput_TEUHazard1.Text)||IsBlank(TextInput_TEUHazard2.Text)||IsBlank(TextInput_TEUHazard3.Text),
            Notify("请检查Temporary Electricity表", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //Temporary Electricity表安全控制提醒
            If("Temporary Electricity" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery3_6.AllItems,If(IsBlank(ThisRecord.Radio_PatrolTnspection_21.Selected),
            Notify("请确认Temporary Electricity表安全控制措施", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))));
            //临时用电作业人员信息不能为空
            If("Temporary Electricity" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery5_4.AllItems,If(!IsBlank(ThisRecord.TextInput_TEU_Worker.Text)&&(ThisRecord.Image_Photo_7.Image<>SampleImage||!IsBlank(ThisRecord.TextInput_TEU_ID.Text)),"",Notify("临时用电作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            If(Gallery5_4.AllItemsCount=0,Notify("临时用电作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //施工方案不能为空
            /*If("Temporary Electricity" in Concat(Filter(Licences,State=true),LicenceN),
            If(
                !IsBlank(LookUp(DataCardValue_ConstructionSchemeTemporaryElectricity.Attachments,!EndsWith(ThisRecord.Name,"pdf")&&!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")&&!EndsWith(ThisRecord.Name,"doc")&&!EndsWith(ThisRecord.Name,"docx")).Name)||
                IsBlank(LookUp(DataCardValue_ConstructionSchemeTemporaryElectricity.Attachments,"" in ThisRecord.Name).Name),//限制上传的文件格式以及文件不为空
                Notify("临时用电作业施工方案请上传Word/Pdf/图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            ));*/
            
            
            
            
            
            
            
            
            
            
            If(Not("false" in Concat(Gal_Ispatch,Value,";")),
            Set(NewProjID,First(Sort(TPL_NormalLicence,ProjID,SortOrder.Descending)).ProjID+1);//防止重复
            ForAll(Filter(Licences,State=true),
            Switch(LicenceN,
            //上传normal表信息&normoal表人员信息证照上传
            "Normal",
            Patch(TPL_NormalLicence,
            {
                ProjID:NewProjID,//当前项目ID
                ProjName:TextInput_OpUnit_6.Text,//项目名称
                ApplicationDept:Dropdown_AppliDept.Selected.Value,//申请部门
                OpUnit:TextInput_OpUnit.Text,//作业单位
                OpDirector:TextInput_OpDirector.Text,//作业单位负责人
                'OpDirectorM/P':'TextInput_OpDirectorM/P'.Text,
                StartTime:DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0),//结束时间
                ProjLeader:TextInput_ProjLeder.Text,//项目负责人
                'ProjLeaderM/P':'TextInput_ProjLederM/P'.Text,
                OnSiteGuardian:TextInput_OpDirector_2.Text,//现场监护人
                'OnSiteGuardianM/P':'TextInputTextInput_OnSiteGuardianM/P'.Text,
                OpDept:Concat(Col_SortedDept,ThisRecord.Value,";"),//作业区域所在部门
                OpAr:TextInput_OpAr.Text,//详细作业区域
                MainTools:TextInput_MainTools.Text,//主要作业工具
                OtherLicenses:If(CountRows(Filter(Licences,State=true))=1,"无",Concat(Filter(Licences,State=true&&LicenceN<>"Normal"),LicenceN,";")),//用封号;连接特殊许可证作为该字段内容
                OpCountent:TextInput_OpCountent.Text,//施工内容
                IsPatrol:Switch(Radio_IsPatrol.Selected.Value,"是",true,"否",false),//是否巡检
                IsBackUp:Switch(Radio_IsBackup.Selected.Value,"是",true,"否",false),//是否备案
                ProjState:"草稿",//默认审批状态
                NeedFactorDire:If(Radio_FWLevel.Selected.Value="一级"&&First(Filter(Licences,LicenceN="Hot")).State,true,false),//是否需要厂长
                FactoryName:If(Radio_FWLevel.Selected.Value="一级"&&First(Filter(Licences,LicenceN="Hot")).State,Dropdown_OpDept_4.SelectedText.Value,""),//工厂名
                OtherCoWoker:TextInput_OtherCoWoker.Text//其他协作人员
            });
            ForAll(Filter(Gal_CollectMsg,ID_Type<>""),Patch(TPL_InfoGathering,
            {
                ProjID:NewProjID,
                PhotoType:"其他证件",
                Photograph:ThisRecord.Photo,
                Name:ThisRecord.ID_Type
            }));
            ForAll(
            ShowColumns(Col_SortedDept,"Value"),
            Switch(
            ThisRecord.Value,
            "生产",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=NewProjID),{HoaProduce:"作业区域需审批"}),
            "印前",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=NewProjID),{HoaPrepress:"作业区域需审批"}),
            "印刷",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=NewProjID),{HoaPrint:"作业区域需审批"}),
            "复合",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=NewProjID),{HoaComposite:"作业区域需审批"}),
            "分切",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=NewProjID),{HoaCutting:"作业区域需审批"}),
            "维修",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=NewProjID),{HoaMaintenance:"作业区域需审批"}),
            "仓库",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=NewProjID),{HoaWarehouse:"作业区域需审批"}),
            "质量",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=NewProjID),{HoaQuality:"作业区域需审批"}),
            "WCM",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=NewProjID),{HoaWCM:"作业区域需审批"}),
            "CBRE",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=NewProjID),{HoaCBRE:"作业区域需审批"}),
            "EHS",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=NewProjID),{HoaEHS:"作业区域需审批"}))
            );
            //一般施工许可证文件上传
            TPL_UpLoadFile2.Run(
                 {
                     contentBytes: First(DataCardValue17_1.Attachments).Value,
                     //name: First(DataCardValue17_1.Attachments).Name name: NewProjID&"_TrainingPhoto_"&First(Split(First(DataCardValue17_1.Attachments).Name,".")).Value&"."&Last(Split(First(DataCardValue17_1.Attachments).Name,".")).Value
                     name: NewProjID&"_TrainingPhoto_"&First(DataCardValue17_1.Attachments).Name
                 }
             );
            //Reset(DataCardValue17_1);
            ForAll(
                DataCardValue17.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        //name: NewProjID&"_DiscloseInformation."&Last(Split(First(DataCardValue17.Attachments).Name,".")).Value
                        name: NewProjID&"_DiscloseInformation_"&ThisRecord.Name
                    }
                )
            );
            //Reset(DataCardValue17);
            ,
            
            
            
            
            //上传High表信息&High表人员信息证照上传&High安全控制信息上传
            "High",
            Patch(TPL_HighWork,
            {
                ProjID:NewProjID,//当前项目ID
                OpUnit:TextInput_OpUnit.Text,//作业单位
                OnSiteGuardian:TextInput_OpDirector_2.Text,//现场监护人
                OpAr:TextInput_OpAr.Text,//作业地点
                OpCountent:TextInput_OpCountent.Text,//作业内容
                StartTime:DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0),//结束时间
                HWLevel:Radio_HWLevel.Selected.Value,//登高作业等级
                HWHazard1:TextInput_HWHazard1.Text,//存在的危害因素
                HWHazard2:TextInput_HWHazard2.Text,//可能导致的后果
                HWHazard3:TextInput_HWHazard3.Text,//相应的管控措施
                HWTools:Concat(Filter(HW_Tools,State=true),ToolsN,";"),//主要工具
                HWOtherTools:TextInput_HWOtherTools.Text//其他工具
            });
            ForAll(Filter(Gal_HW_NameID,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:NewProjID,//当前项目ID
                PhotoType:"登高作业人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            }));
            ForAll(
                Gallery3_8.AllItems,
                Switch(ItemID,
                1,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=NewProjID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_23.Selected.Value,"是",true,"不适用",false,false)})
            ))
            /*;
            //登高作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeHigh.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        //contentBytes: First(DataCardValue_ConstructionSchemeHigh.Attachments).Value,
                        //name: NewProjID&"_CSHighWork."&Last(Split(First(DataCardValue_ConstructionSchemeHigh.Attachments).Name,".")).Value
                        contentBytes: ThisRecord.Value,
                        name: NewProjID&"_CSHighWork_"&ThisRecord.Name
                    }
                )
            )*/,
            //Reset(DataCardValue_ConstructionSchemeHigh),
            
            //上传Lifting表信息&Lifting表人员信息证照上传&Lifting安全控制信息上传
            "Lifting",Patch(TPL_LiftingWork,
            {
                ProjID:NewProjID,//当前项目ID
                OpAr:TextInput_OpAr.Text,//作业地点
                OpCountent:TextInput_OpCountent.Text,//作业内容
                SuspendedObject:TextInput_SuspendedObject.Text,//被吊物
                SuspendedObjectWeight:Int(TextInput_SuspendedObjectWeight.Text),//被吊物重量
                LiftingCapacity:Int(TextInput_LiftingCapacity.Text),//起重能力
                OpUnit:TextInput_OpUnit.Text,//作业单位
                StartTime:DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0),//结束时间
                OnSiteGuardian:TextInput_OpDirector_2.Text,//现场监护人
                LWHazard1:TextInput_LWHazard1.Text,//存在的危害因素
                LWHazard2:TextInput_LWHazard2.Text,//可能导致的后果
                LWHazard3:TextInput_LWHazard3.Text//相应的管控措施
            });
            ForAll(Filter(Gal_LW_EquipmentsID,Equipments<>""),Patch(TPL_InfoGathering,
            {
                ProjID:NewProjID,//当前项目ID
                PhotoType:"吊装设备信息",
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Equipments
            }));
            ForAll(Filter(Gal_LW_NameID,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:NewProjID,//当前项目ID
                PhotoType:"吊装作业人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            }));
            ForAll(Filter(Gal_LW_CommanderID,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:NewProjID,//当前项目ID
                PhotoType:"吊装指挥人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            }));
            ForAll(
                Gallery3_7.AllItems,
                Switch(ItemID,
                1,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=NewProjID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_22.Selected.Value,"是",true,"不适用",false,false)})
            ))
            /*;
            //吊装作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeLifting.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        name: NewProjID&"_CSLiftingWork_"&ThisRecord.Name
                    }
                )
            )*/
            ,
            //Reset(DataCardValue_ConstructionSchemeLifting)
            
            
            //上传 有限空间作业 表信息&有限空间作业 安全控制信息上传
            "Confined Space",Patch(TPL_ConfinedSpaceWork,
            {
                ProjID:NewProjID,//当前项目ID
                OpUnit:TextInput_OpUnit.Text,//作业单位
                Worker:TextInput_CSW_Worker.Text,//作业人员
                OpAr:TextInput_OpAr.Text,//作业地点
                OnSiteGuardian:TextInput_OpDirector_2.Text,//现场监护人
                StartTime:DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0),//结束时间
                OpCountent:TextInput_OpCountent.Text,//作业内容
                CSWHazard1:TextInput_CSWHazard1.Text,//存在的危害因素
                CSWHazard2:TextInput_CSWHazard2.Text,//可能导致的后果
                CSWHazard3:TextInput_CSWHazard3.Text,//相应的管控措施
                GasDetectionTime:TextInput_Ventilation.Text//通风起止时间
            });
            /*ForAll(Gallery3_9.AllItems,
            If(ThisRecord.TextInput3.Text<>"",Patch(TPL_GasDetection,
            {
                ProjID:NewProjID,
                Sampler:ThisRecord.TextInput3.Text,
                SampleT:ThisRecord.TextInput3_1.Text,
                SampleP:ThisRecord.TextInput3_2.Text,
                OxyContent:ThisRecord.TextInput3_3.Text,
                CombustibleGas:ThisRecord.TextInput3_4.Text,
                CarbonMonoxide:ThisRecord.TextInput3_5.Text,
                HydrogenSulfide:ThisRecord.TextInput3_6.Text
            })));*/
            ForAll(
                Gallery3_4.AllItems,
                Switch(ItemID,
                1,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=NewProjID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_19.Selected.Value,"是",true,"不适用",false,false)})
            ))
            /*;
            //有限空间作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeConfined.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        //contentBytes: First(DataCardValue_ConstructionSchemeConfined.Attachments).Value,
                        //name: NewProjID&"_CSConfinedSpaceWork."&Last(Split(First(DataCardValue_ConstructionSchemeConfined.Attachments).Name,".")).Value
                        contentBytes: ThisRecord.Value,
                        name: NewProjID&"_CSConfinedSpaceWork_"&ThisRecord.Name
                    }
                )
            )*/
            ,
            //Reset(DataCardValue_ConstructionSchemeConfined)
            
            //上传Hot表信息&Hot表人员信息证照上传&Hot安全控制信息上传
            "Hot",Patch(TPL_HotWork,
            {
                ProjID:NewProjID,//当前项目ID
                OpAr:TextInput_OpAr.Text,//作业地点
                OpUnit:TextInput_OpUnit.Text,//作业单位
                OnSiteGuardian:TextInput_OpDirector_2.Text,//现场监护人
                StartTime:DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0),//结束时间
                OpCountent:TextInput_OpCountent.Text,//作业内容
                FWTools:TextInput_FWTools.Text,//动火作业工具
                FWHazard1:TextInput_FWHazard1.Text,//存在的危害因素
                FWHazard2:TextInput_FWHazard2.Text,//可能导致的后果
                FWHazard3:TextInput_FWHazard3.Text,//相应的管控措施
                FWLevel:Radio_FWLevel.SelectedText.Value,//动火作业级别
                FireHose:Int(TextInput_FWHazard1_4.Text),//消防水带数量
                FireExtinguisher:Int(TextInput_FWHazard1_5.Text),//灭火器数量
                FireBlanket:Int(TextInput_FWHazard1_6.Text),//防火毯数量
                FireOther:TextInput_FWOtherTool.Text, //其他防火器材名字
                FireOtherNumber:Int(TextInput_FWOtherToolNumber.Text) //其他防火器材数量
            });
            ForAll(Filter(Gal_FW_NameID,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:NewProjID,//当前项目ID
                PhotoType:"动火作业人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            }));
            ForAll(
                Gallery3_5.AllItems,
                Switch(ItemID,
                1,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=NewProjID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_20.Selected.Value,"是",true,"不适用",false,false)})
            ))
            /*;
            //动火作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeHot.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        //contentBytes: First(DataCardValue_ConstructionSchemeHot.Attachments).Value,
                        //name: NewProjID&"_CSHotWork."&Last(Split(First(DataCardValue_ConstructionSchemeHot.Attachments).Name,".")).Value
                        contentBytes: ThisRecord.Value,
                        name: NewProjID&"_CSHotWork_"&ThisRecord.Name
                    }
                )
            )*/
            ,
            //Reset(DataCardValue_ConstructionSchemeHot),
            
            //上传临时用电表信息&临时用电表人员信息证照上传&临时用电安全控制信息上传
            "Temporary Electricity",Patch(TPL_TemporaryElectricityUseWork,
            {
                ProjID:NewProjID,//当前项目ID
                OpAr:TextInput_OpAr.Text,//作业地点
                OpUnit:TextInput_OpUnit.Text,//作业单位
                OnSiteGuardian:TextInput_OpDirector_2.Text,//现场监护人
                OpCountent:TextInput_OpCountent.Text,//作业内容
                TotalLoad:TextInput_TotalLoad.Text,//用电设备总负荷
                WorkingVoltage:TextInput_WorkingVoltage.Text,//工作电压
                PowerAccessPoint:TextInput_PowerAccessPoint.Text,//电源接入点
                StartTime:DateValue(DatePicker_StartDate.SelectedDate)+Time(Int(Dropdown_StartTime.Selected.Value),Int(Dropdown_StartTime_1.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate.SelectedDate)+Time(Int(Dropdown_EndTime.Selected.Value),Int(Dropdown_EndTime_1.Selected.Value),0),//结束时间
                TEUHazard1:TextInput_TEUHazard1.Text,//存在的危害因素
                TEUHazard2:TextInput_TEUHazard2.Text,//可能导致的后果
                TEUHazard3:TextInput_TEUHazard3.Text//相应的管控措施
            });
            ForAll(Filter(Gal_TEU_NameID,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:NewProjID,//当前项目ID
                PhotoType:"临时用电人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            }));
            ForAll(
                Gallery3_6.AllItems,
                Switch(ItemID,
                1,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=NewProjID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_21.Selected.Value,"是",true,"不适用",false,false)})
            ))
            /*;
            //临时用电作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeTemporaryElectricity.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        //contentBytes: First(DataCardValue_ConstructionSchemeTemporaryElectricity.Attachments).Value,
                        //name: NewProjID&"_CSTemporaryElectricityWork."&Last(Split(First(DataCardValue_ConstructionSchemeTemporaryElectricity.Attachments).Name,".")).Value
                        contentBytes: ThisRecord.Value,
                        name: NewProjID&"_CSTemporaryElectricityWork_"&ThisRecord.Name
                    }
                )
            )*/
            //Reset(DataCardValue_ConstructionSchemeTemporaryElectricity)
            ));
            
            
            
            Set(NewProjID,First(Sort(TPL_NormalLicence,ProjID,SortOrder.Descending)).ProjID+1);
            Notify("已存草稿", NotificationType.Success);
            
            Navigate(home));
            ClearCollect(Gal_Ispatch,{Value:true});
            Set(NewProjID,First(Sort(TPL_NormalLicence,ProjID,SortOrder.Descending)).ProjID+1);//防止重复
            
        RadiusBottomLeft: =2
        RadiusBottomRight: =2
        RadiusTopLeft: =2
        RadiusTopRight: =2
        Size: =12
        Text: ="存为草稿"
        Visible: =Vis_Sub
        Width: =102
        X: =424
        Y: =1069
        ZIndex: =14

