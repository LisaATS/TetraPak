DraftEdit As screen:
    OnVisible: |+
        =ClearCollect(Factory,Distinct(ShowColumns(Filter(TPL_Login,IsFactoryDirector=true),"FactoryName"),FactoryName));
        If(
            ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
            ((
                DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)>1440||
                DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)<0
            )||
            DateValue(DatePicker_StartDate_1.SelectedDate)<>Today()
            )
            ,
            Set(isTimeWrong,true),
            Set(isTimeWrong,false)
        );
        
        
        
        
        
        //第一次进入此页跳转到Normal页;
        If(IsFirstDraft=true,
        Select(Menu_Licence_2,1);
        Set(Vis_Current,"Normal");
        ClearCollect(Gal_Ispatch,{Value:true});
        ClearCollect(
            Licences, 
            {LicenceN: "Normal", State: true },
            {LicenceN: "High", State: Checkbox_Heights_1.Value },
            {LicenceN: "Lifting", State: Checkbox_Hoisting_1.Value },
            {LicenceN: "Confined Space", State: Checkbox_Limited_1.Value },
            {LicenceN: "Hot", State: Checkbox_HotWork_1.Value },
            {LicenceN: "Temporary Electricity", State: Checkbox_TemporaryElectricity_1.Value }
        );
        
        ClearCollect(Col_SortedDept,Sort(ComboBox1_1.SelectedItems,Value,SortOrder.Ascending));//作业区域审批人刷新
        
        ClearCollect(Col_DraftHW,RenameColumns(ShowColumns(Filter(TPL_InfoGathering,ProjID=Text(SearchID),PhotoType="登高作业人员信息"),"Name","Identifier","Photograph"),"Photograph","Photo","Identifier","ID"));
        Set(ReSubCol_DraftHW,false);
        
        ClearCollect(Col_DraftLW_EQ,RenameColumns(ShowColumns(Filter(TPL_InfoGathering,ProjID=Text(SearchID),PhotoType="吊装设备信息"),"Name","Identifier","Photograph"),"Identifier","ID","Name","Equipments"));
        ClearCollect(Col_DraftLW_Worker,RenameColumns(ShowColumns(Filter(TPL_InfoGathering,ProjID=Text(SearchID),PhotoType="吊装作业人员信息"),"Name","Identifier","Photograph"),"Photograph","Photo","Identifier","ID"));
        ClearCollect(Col_DraftLW_Commander,RenameColumns(ShowColumns(Filter(TPL_InfoGathering,ProjID=Text(SearchID),PhotoType="吊装指挥人员信息"),"Name","Identifier","Photograph"),"Photograph","Photo","Identifier","ID"));
        Set(ReSubCol_DraftLW_EQ,false);Set(ReSubCol_DraftLW_Worker,false);Set(ReSubCol_DraftLW_Commander,false);
        
        ClearCollect(Col_DraftFW,RenameColumns(ShowColumns(Filter(TPL_InfoGathering,ProjID=Text(SearchID),PhotoType="动火作业人员信息"),"Name","Identifier","Photograph"),"Photograph","Photo","Identifier","ID"));
        ClearCollect(Col_DraftTEU,RenameColumns(ShowColumns(Filter(TPL_InfoGathering,ProjID=Text(SearchID),PhotoType="临时用电人员信息"),"Name","Identifier","Photograph"),"Photograph","Photo","Identifier","ID"));
        Set(ReSubCol_DraftFW,false);Set(ReSubCol_DraftTEU,false);
        
        
        //各个作业安全控制条例
        ClearCollect(Gal_HighWorkSafetyControl,AddColumns(Sort(Filter(TPL_SafetyControl,Not(IsBlank(Content))&&LicenseType="High Work Permit"),ID,SortOrder.Ascending),"Confirm",false));
        ClearCollect(Gal_ConfinedSpaceSafetyControl,AddColumns(Sort(Filter(TPL_SafetyControl,Not(IsBlank(Content))&&LicenseType="Confined Space Work Permit"),ID,SortOrder.Ascending),"Confirm",false));
        ClearCollect(Gal_LiftingWorkControl,AddColumns(Sort(Filter(TPL_SafetyControl,Not(IsBlank(Content))&&LicenseType="Lifting Work Permit"),ID,SortOrder.Ascending),"Confirm",false));
        ClearCollect(Gal_HotWorkSafetyControl,AddColumns(Sort(Filter(TPL_SafetyControl,Not(IsBlank(Content))&&LicenseType="Hot Work"),ID,SortOrder.Ascending),"Confirm",false));
        ClearCollect(Gal_TemporaryElectricityUseWorkSafetyControl,AddColumns(Sort(Filter(TPL_SafetyControl,Not(IsBlank(Content))&&LicenseType="Temporary Electricity Use Work Permit"),ID,SortOrder.Ascending),"Confirm",false));
        
        //高处作业
        ClearCollect(Gal_HighWorkSafetyControl2,Gal_HighWorkSafetyControl);
        ForAll(Gal_HighWorkSafetyControl,Switch(ItemID,
        1,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=1),{Confirm:First(Current_High).Control1}),2,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=2),{Confirm:First(Current_High).Control2}),3,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=3),{Confirm:First(Current_High).Control3}),4,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=4),{Confirm:First(Current_High).Control4}),5,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=5),{Confirm:First(Current_High).Control5}),6,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=6),{Confirm:First(Current_High).Control6}),7,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=7),{Confirm:First(Current_High).Control7}),8,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=8),{Confirm:First(Current_High).Control8}),9,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=9),{Confirm:First(Current_High).Control9}),10,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=10),{Confirm:First(Current_High).Control10}),11,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=11),{Confirm:First(Current_High).Control11}),12,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=12),{Confirm:First(Current_High).Control12}),
        13,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=13),{Confirm:First(Current_High).Control13}),14,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=14),{Confirm:First(Current_High).Control14}),15,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=15),{Confirm:First(Current_High).Control15})
        ));
        
        //有限空间
        ClearCollect(Gal_ConfinedSpaceSafetyControl2,Gal_ConfinedSpaceSafetyControl);
        ForAll(Gal_ConfinedSpaceSafetyControl,
        Switch(ItemID,
        1,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=1),{Confirm:First(Current_ConfinedSpace).Control1}),
        2,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=2),{Confirm:First(Current_ConfinedSpace).Control2}),
        3,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=3),{Confirm:First(Current_ConfinedSpace).Control3}),
        4,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=4),{Confirm:First(Current_ConfinedSpace).Control4}),
        5,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=5),{Confirm:First(Current_ConfinedSpace).Control5}),
        6,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=6),{Confirm:First(Current_ConfinedSpace).Control6}),
        7,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=7),{Confirm:First(Current_ConfinedSpace).Control7}),
        8,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=8),{Confirm:First(Current_ConfinedSpace).Control8}),
        9,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=9),{Confirm:First(Current_ConfinedSpace).Control9}),
        10,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=10),{Confirm:First(Current_ConfinedSpace).Control10}),
        11,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=11),{Confirm:First(Current_ConfinedSpace).Control11}),
        12,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=12),{Confirm:First(Current_ConfinedSpace).Control12}),
        13,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=13),{Confirm:First(Current_ConfinedSpace).Control13}),
        14,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=14),{Confirm:First(Current_ConfinedSpace).Control14}),
        15,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=15),{Confirm:First(Current_ConfinedSpace).Control15})
        ));
        
        //吊装作业
        ClearCollect(Gal_LiftingWorkControl2,Gal_LiftingWorkControl);
        ForAll(Gal_LiftingWorkControl,Switch(ItemID,
        1,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=1),{Confirm:First(Current_Lifting).Control1}),2,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=2),{Confirm:First(Current_Lifting).Control2}),3,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=3),{Confirm:First(Current_Lifting).Control3}),4,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=4),{Confirm:First(Current_Lifting).Control4}),5,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=5),{Confirm:First(Current_Lifting).Control5}),6,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=6),{Confirm:First(Current_Lifting).Control6}),7,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=7),{Confirm:First(Current_Lifting).Control7}),8,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=8),{Confirm:First(Current_Lifting).Control8}),9,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=9),{Confirm:First(Current_Lifting).Control9}),10,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=10),{Confirm:First(Current_Lifting).Control10}),11,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=11),{Confirm:First(Current_Lifting).Control11}),12,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=12),{Confirm:First(Current_Lifting).Control12}),
        13,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=13),{Confirm:First(Current_Lifting).Control13}),14,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=14),{Confirm:First(Current_Lifting).Control14}),15,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=15),{Confirm:First(Current_Lifting).Control15})
        ));
        
        //动火作业
        ClearCollect(Gal_HotWorkSafetyControl2,Gal_HotWorkSafetyControl);
        ForAll(Gal_HotWorkSafetyControl,Switch(ItemID,
        1,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=1),{Confirm:First(Current_Hot).Control1}),2,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=2),{Confirm:First(Current_Hot).Control2}),3,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=3),{Confirm:First(Current_Hot).Control3}),4,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=4),{Confirm:First(Current_Hot).Control4}),5,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=5),{Confirm:First(Current_Hot).Control5}),6,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=6),{Confirm:First(Current_Hot).Control6}),7,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=7),{Confirm:First(Current_Hot).Control7}),8,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=8),{Confirm:First(Current_Hot).Control8}),9,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=9),{Confirm:First(Current_Hot).Control9}),10,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=10),{Confirm:First(Current_Hot).Control10}),11,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=11),{Confirm:First(Current_Hot).Control11}),12,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=12),{Confirm:First(Current_Hot).Control12}),
        13,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=13),{Confirm:First(Current_Hot).Control13}),14,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=14),{Confirm:First(Current_Hot).Control14}),15,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=15),{Confirm:First(Current_Hot).Control15})
        ));
        
        //临时用电
        ClearCollect(Gal_TemporaryElectricityUseWorkSafetyControl2,Gal_TemporaryElectricityUseWorkSafetyControl);
        ForAll(Gal_TemporaryElectricityUseWorkSafetyControl,Switch(ItemID,
        1,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=1),{Confirm:First(Current_TemporaryElectricity).Control1}),2,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=2),{Confirm:First(Current_TemporaryElectricity).Control2}),3,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=3),{Confirm:First(Current_TemporaryElectricity).Control3}),4,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=4),{Confirm:First(Current_TemporaryElectricity).Control4}),5,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=5),{Confirm:First(Current_TemporaryElectricity).Control5}),6,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=6),{Confirm:First(Current_TemporaryElectricity).Control6}),7,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=7),{Confirm:First(Current_TemporaryElectricity).Control7}),8,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=8),{Confirm:First(Current_TemporaryElectricity).Control8}),9,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=9),{Confirm:First(Current_TemporaryElectricity).Control9}),10,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=10),{Confirm:First(Current_TemporaryElectricity).Control10}),11,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=11),{Confirm:First(Current_TemporaryElectricity).Control11}),12,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=12),{Confirm:First(Current_TemporaryElectricity).Control12}),
        13,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=13),{Confirm:First(Current_TemporaryElectricity).Control13}),14,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=14),{Confirm:First(Current_TemporaryElectricity).Control14}),15,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=15),{Confirm:First(Current_TemporaryElectricity).Control15})
        ));
        
        ClearCollect(
            HW_Tools, 
            {ToolsN: "自动升降平台/曲臂车", State: Checkbox_Tools1_1.Value },
            {ToolsN: "脚手架", State: Checkbox_Tools2_1.Value },
            {ToolsN: "梯子", State: Checkbox_Tools3_1.Value }
        )
        )
        
        
        
        
        
        
        

    Btn_DeleteDraft As button:
        BorderThickness: =1
        DisplayMode: =
        FocusedBorderThickness: =1
        FontWeight: =FontWeight.Normal
        Height: =28
        OnSelect: |-
            =If(
            (First(Current_Normal).ProjState="审批中"||First(Current_Normal).ProjState="草稿")
            &&PersonalMsg.UserName=First(Current_Normal).ProjLeader
            &&IsBlank(First(Current_Normal).ApplLeaderView)=true,
            
            RemoveIf(TPL_NormalLicence,ProjID=Int(TextInput_ProjLeder_4.Text));
            RemoveIf(TPL_ConfinedSpaceWork,ProjID=Int(TextInput_ProjLeder_4.Text));
            RemoveIf(TPL_HighWork,ProjID=Int(TextInput_ProjLeder_4.Text));
            RemoveIf(TPL_HotWork,ProjID=Int(TextInput_ProjLeder_4.Text));
            RemoveIf(TPL_InfoGathering,ProjID=TextInput_ProjLeder_4.Text);
            RemoveIf(TPL_LiftingWork,ProjID=Int(TextInput_ProjLeder_4.Text));
            RemoveIf(TPL_TemporaryElectricityUseWork,ProjID=Int(TextInput_ProjLeder_4.Text));
            
            RemoveIf('Licenses File',SearchID&"_TrainingPhoto_" in 'File name with extension'||
                                     SearchID&"_DiscloseInformation_" in 'File name with extension'||
                                     SearchID&"_CSHighWork_" in 'File name with extension'||
                                     SearchID&"_CSLiftingWork_" in 'File name with extension'||
                                     SearchID&"_CSConfinedSpaceWork_" in 'File name with extension'||
                                     SearchID&"_CSHotWork_" in 'File name with extension'||
                                     SearchID&"_CSTemporaryElectricityWork_" in 'File name with extension'
            );
            
            Reset(TextInput_ProjLeder_4);
            Reset(TextInput_OpUnit_7);
            Reset(Dropdown_AppliDept_2);
            Reset(TextInput_OpUnit_2);
            Reset(TextInput_ProjLeder_5);
            Reset('TextInput_ProjLederM/P_2');
            Reset(TextInput_OpDirector_3);
            Reset('TextInput_OpDirectorM/P_2');
            Reset(TextInput_OpDirector_4);
            Reset('TextInputTextInput_OnSiteGuardianM/P_2');
            Reset(DatePicker_StartDate_1);
            Reset(Dropdown_StartTime_3);
            Reset(Dropdown_StartTime_2);
            Reset(DatePicker_EndDate_1);
            Reset(Dropdown_EndTime_3);
            Reset(Dropdown_EndTime_2);
            Reset(ComboBox1_1);
            Reset(TextInput_OpAr_2);
            Reset(TextInput_MainTools_3);
            Reset(Checkbox_Heights_1);
            Reset(Checkbox_Hoisting_1);
            Reset(Checkbox_Limited_1);
            Reset(Checkbox_HotWork_1);
            Reset(Checkbox_TemporaryElectricity_1);
            Reset(TextInput_OpCountent_2);
            Reset(TextInput_OtherCoWoker_1);
            Reset(Radio_IsPatrol_1);
            Reset(TextInput_OpUnit1_2);
            Reset(TextInput_OnSiteGuardian1_2);
            Reset(TextInput_OpAr1_14);
            Reset(TextInput_OpAr1_15);
            Reset(TextInput_OpAr1_16);
            Reset(TextInput_OpCountent1_2);
            Reset(Radio_HWLevel_1);
            Reset(TextInput_HWHazard1_2);
            Reset(TextInput_HWHazard2_2);
            Reset(TextInput_HWHazard3_2);
            Reset(Checkbox_Tools1_1);
            Reset(Checkbox_Tools2_1);
            Reset(Checkbox_Tools3_1);
            Reset(TextInput_HWOtherTools_2);
            Reset(TextInput_SuspendedObject_2);
            Reset(TextInput_SuspendedObjectWeight_2);
            Reset(TextInput_LiftingCapacity_2);
            Reset(TextInput_LWHazard1_2);
            Reset(TextInput_LWHazard2_2);
            Reset(TextInput_LWHazard3_2);
            Reset(TextInput_CSW_Worker_2);
            Reset(TextInput_CSWHazard1_2);
            Reset(TextInput_CSWHazard2_2);
            Reset(TextInput_CSWHazard3_2);
            Reset(TextInput_Ventilation_1);
            Reset(TextInput_FWTools_2);
            Reset(TextInput_FWHazard1_2);
            Reset(TextInput_FWHazard2_2);
            Reset(TextInput_FWHazard3_3);
            Reset(Radio_FWLevel_2);
            Reset(Dropdown_OpDept_5);
            Reset(TextInput_FWHazard1_10);
            Reset(TextInput_FWHazard1_11);
            Reset(TextInput_FWHazard1_12);
            Reset(TextInput_FWOtherTool_2);
            Reset(TextInput_FWOtherToolNumber_2);
            Reset(TextInput_TotalLoad_2);
            Reset(TextInput_WorkingVoltage_2);
            Reset(TextInput_PowerAccessPoint_2);
            Reset(TextInput_TEUHazard1_2);
            Reset(TextInput_TEUHazard2_2);
            Reset(TextInput_TEUHazard3_2);
            Notify("草稿已删除！", NotificationType.Success);
            Navigate(home)
            )
        RadiusBottomLeft: =2
        RadiusBottomRight: =2
        RadiusTopLeft: =2
        RadiusTopRight: =2
        Size: =12
        Text: ="删除草稿"
        Visible: =Vis_Del
        Width: =102
        X: =4
        Y: =1071
        ZIndex: =1

    Btn_Sub2 As button:
        BorderThickness: =1
        DisplayMode: =
        FocusedBorderThickness: =1
        FontWeight: =FontWeight.Normal
        Height: =28
        OnSelect: |
            =ClearCollect(Gal_Ispatch,{Value:true});
            If(
                ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                ((
                    DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)>1440||
                    DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)<0
                )||
                DateValue(DatePicker_StartDate_1.SelectedDate)<>Today()
                )
                ,
                Set(isTimeWrong,true),
                Set(isTimeWrong,false)
            )
            ;
            
            //normal表为空, 提醒
            //If("Normal" in Concat(Filter(Licences,State=true),LicenceN),
            If(IsBlank(TextInput_OpUnit_7.Text)||IsBlank(TextInput_OpUnit_2.Text)||IsBlank('TextInput_ProjLederM/P_2'.Text)||IsBlank(TextInput_OpDirector_3.Text)||IsBlank('TextInput_OpDirectorM/P_2'.Text)||IsBlank('TextInputTextInput_OnSiteGuardianM/P_2'.Text)||IsBlank(TextInput_OpAr_2.Text)||IsBlank(TextInput_MainTools_3.Text)||IsBlank(TextInput_OpCountent_2.Text)||IsBlank(TextInput_OpDirector_4.Text)||IsBlank(Concat(ComboBox1_1.SelectedItems,";")),
            Notify("请检查Normal表", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}));
            If(isTimeWrong=true,Notify("特种作业只能当天申请，且工作时间不超过24小时", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}));
            If(
                !IsBlank(LookUp(DataCardValue17_2.Attachments,!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")).Name)||
                (Gallery7_7.AllItemsCount=0&&IsEmpty(DataCardValue17_2.Attachments)),
            //    ,//限制上传的文件格式以及文件不为空
                Notify("培训照片请上传图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            );
            If(
                !IsBlank(LookUp(DataCardValue17_3.Attachments,!EndsWith(ThisRecord.Name,"pdf")&&!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")).Name)||
                (Gallery7_8.AllItemsCount=0&&IsEmpty(DataCardValue17_3.Attachments)),//限制上传的文件格式以及文件不为空
                Notify("交底材料请上传Pdf或图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            );
            
            
            
            
            //High表为空, 提醒
            If("High" in Concat(Filter(Licences,State=true),LicenceN),
            If(IsBlank(TextInput_HWHazard1_2.Text)||IsBlank(TextInput_HWHazard2_2.Text)||IsBlank(TextInput_HWHazard3_2.Text)||IsBlank(Radio_HWLevel_1.Selected.Value),
            Notify("请检查High表", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //High表安全控制提醒
            If("High" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery3_10.AllItems,If(IsBlank(ThisRecord.Radio_PatrolTnspection_29.Selected),
            Notify("请确认High表安全控制措施", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))));
            //登高人员信息表不能为空
            If("High" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Col_DraftHW,
            If(!IsBlank(ThisRecord.Name),
            "",
            Notify("请完善登高作业人员信息1", NotificationType.Error);
            Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))
            );
            If(Gal_DraftHW.AllItemsCount=0,Notify("请完善登高作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))
            );
            //施工方案不能为空
            /*If("High" in Concat(Filter(Licences,State=true),LicenceN),
            If(
                !IsBlank(LookUp(DataCardValue_ConstructionSchemeHigh_1.Attachments,!EndsWith(ThisRecord.Name,"pdf")&&!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")&&!EndsWith(ThisRecord.Name,"doc")&&!EndsWith(ThisRecord.Name,"docx")).Name)||
                (Gallery7_9.AllItemsCount=0&&IsBlank(LookUp(DataCardValue_ConstructionSchemeHigh_1.Attachments,"" in ThisRecord.Name).Name)),
                //限制上传的文件格式以及文件不为空
                Notify("登高作业施工方案请上传Word/Pdf/图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            ));*/
            
            
            //Lifting表为空, 提醒
            If("Lifting" in Concat(Filter(Licences,State=true),LicenceN),
            If(IsBlank(TextInput_SuspendedObject_2.Text)||IsBlank(TextInput_SuspendedObjectWeight_2.Text)||IsBlank(TextInput_LiftingCapacity_2.Text)||IsBlank(TextInput_LWHazard1_2.Text)||IsBlank(TextInput_LWHazard2_2.Text)||IsBlank(TextInput_LWHazard3_2.Text),
            Notify("请检查Lifting表", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //Lifting表安全控制提醒
            If("Lifting" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery3_11.AllItems,If(IsBlank(ThisRecord.Radio_PatrolTnspection_30.Selected),Notify("请确认Lifting表安全控制措施", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))));
            //吊装设备信息表不能为空
            If("Lifting" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Col_DraftLW_EQ,If(IsBlank(ThisRecord.Equipments)||IsBlank(ThisRecord.ID),Notify("请完善吊装设备信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            If(CountRows(Col_DraftLW_EQ)=0,Notify("请完善吊装设备信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //吊装人员信息表不能为空
            If("Lifting" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Col_DraftLW_Worker,If(!IsBlank(ThisRecord.Name),"",Notify("请完善吊装作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            If(Gal_DraftLW_Worker.AllItemsCount=0,Notify("请完善吊装作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //吊装指挥人员信息表不能为空
            If("Lifting" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Col_DraftLW_Commander,If(!IsBlank(ThisRecord.Name),"",Notify("请完善吊装指挥人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            If(Gal_DraftLW_Commander.AllItemsCount=0,Notify("请完善吊装指挥人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //吊装施工方案不能为空
            /*If("Lifting" in Concat(Filter(Licences,State=true),LicenceN),
            If(
                !IsBlank(LookUp(DataCardValue_ConstructionSchemeLifting_1.Attachments,!EndsWith(ThisRecord.Name,"pdf")&&!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")&&!EndsWith(ThisRecord.Name,"doc")&&!EndsWith(ThisRecord.Name,"docx")).Name)||
                (Gallery7_10.AllItemsCount=0&&IsBlank(LookUp(DataCardValue_ConstructionSchemeLifting_1.Attachments,"" in ThisRecord.Name).Name)),
                //限制上传的文件格式以及文件不为空
                Notify("吊装作业施工方案请上传Word/Pdf/图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            ));*/
            
            
            //Confined Space表为空, 提醒
            If("Confined Space" in Concat(Filter(Licences,State=true),LicenceN),
            If(IsBlank(TextInput_CSW_Worker_2.Text)||IsBlank(TextInput_CSWHazard1_2.Text)||IsBlank(TextInput_CSWHazard2_2.Text)||IsBlank(TextInput_CSWHazard3_2.Text)||IsBlank(TextInput_Ventilation_1.Text),
            Notify("请检查Confined Space表", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //Confined Space表安全控制提醒
            If("Confined Space" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery3_13.AllItems,If(IsBlank(ThisRecord.Radio_PatrolTnspection_32.Selected),Notify("请确认Confined Space表安全控制措施", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))));
            //施工方案不能为空
            /*If("Confined Space" in Concat(Filter(Licences,State=true),LicenceN),
            If(
                !IsBlank(LookUp(DataCardValue_ConstructionSchemeConfined_1.Attachments,!EndsWith(ThisRecord.Name,"pdf")&&!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")&&!EndsWith(ThisRecord.Name,"doc")&&!EndsWith(ThisRecord.Name,"docx")).Name)||
                (Gallery7_11.AllItemsCount=0&&IsBlank(LookUp(DataCardValue_ConstructionSchemeConfined_1.Attachments,"" in ThisRecord.Name).Name)),
                //限制上传的文件格式以及文件不为空
                Notify("有限空间作业施工方案请上传Word/Pdf/图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            ));*/
            
            
            //Hot表为空, 提醒
            If("Hot" in Concat(Filter(Licences,State=true),LicenceN),
            If(IsBlank(TextInput_FWHazard1_2.Text)||IsBlank(TextInput_FWHazard2_2.Text)||IsBlank(TextInput_FWHazard3_3.Text)||IsBlank(TextInput_FWHazard1_10.Text)||IsBlank(TextInput_FWHazard1_11.Text)||IsBlank(TextInput_FWHazard1_12.Text)||IsBlank(Radio_FWLevel_2.SelectedText)||IsBlank(TextInput_FWTools_2.Text),
            Notify("请检查Hot表", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //Hot表安全控制提醒
            If("Hot" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery3_12.AllItems,If(IsBlank(ThisRecord.Radio_PatrolTnspection_31.Selected),
            Notify("请确认Hot表安全控制措施", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))));
            //动火作业人员信息不能为空
            If("Hot" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Col_DraftFW,If(!IsBlank(ThisRecord.Name),"",Notify("请完善动火作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            If(Gal_DraftFW.AllItemsCount=0,Notify("请完善动火作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //施工方案不能为空
            /*If("Hot" in Concat(Filter(Licences,State=true),LicenceN),
            If(
                !IsBlank(LookUp(DataCardValue_ConstructionSchemeHot_1.Attachments,!EndsWith(ThisRecord.Name,"pdf")&&!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")&&!EndsWith(ThisRecord.Name,"doc")&&!EndsWith(ThisRecord.Name,"docx")).Name)||
                (Gallery7_13.AllItemsCount=0&&IsBlank(LookUp(DataCardValue_ConstructionSchemeHot_1.Attachments,"" in ThisRecord.Name).Name)),
                //限制上传的文件格式以及文件不为空
                Notify("动火作业施工方案请上传Word/Pdf/图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            ));*/
            
            
            //Temporary Electricity表为空, 提醒
            If("Temporary Electricity" in Concat(Filter(Licences,State=true),LicenceN),
            If(IsBlank(TextInput_TotalLoad_2.Text)||IsBlank(TextInput_WorkingVoltage_2.Text)||IsBlank(TextInput_PowerAccessPoint_2.Text)||IsBlank(TextInput_TEUHazard1_2.Text)||IsBlank(TextInput_TEUHazard2_2.Text)||IsBlank(TextInput_TEUHazard3_2.Text),
            Notify("请检查Temporary Electricity表", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //Temporary Electricity表安全控制提醒
            If("Temporary Electricity" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery3_9.AllItems,If(IsBlank(ThisRecord.Radio_PatrolTnspection_28.Selected),
            Notify("请确认Temporary Electricity表安全控制措施", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))));
            //临时用电作业人员信息不能为空
            If("Temporary Electricity" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Col_DraftTEU,If(!IsBlank(ThisRecord.Name),"",Notify("临时用电作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            If(Gal_DraftTEU.AllItemsCount=0,Notify("临时用电作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //施工方案不能为空
            /*If("Temporary Electricity" in Concat(Filter(Licences,State=true),LicenceN),
            If(
                !IsBlank(LookUp(DataCardValue_ConstructionSchemeTemporaryElectricity_1.Attachments,!EndsWith(ThisRecord.Name,"pdf")&&!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")&&!EndsWith(ThisRecord.Name,"doc")&&!EndsWith(ThisRecord.Name,"docx")).Name)||
                (Gallery7_12.AllItemsCount=0&&IsBlank(LookUp(DataCardValue_ConstructionSchemeTemporaryElectricity_1.Attachments,"" in ThisRecord.Name).Name)),
                Notify("临时用电作业施工方案请上传Word/Pdf/图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            ));*/
            
            
            If(Not("false" in Concat(Gal_Ispatch,Value,";")),
            ForAll(Filter(Licences,State=true),
            Switch(LicenceN,
            //上传normal表信息&normoal表人员信息证照上传
            "Normal",
            
            
            //清空原有作业区域
            Patch(TPL_NormalLicence,
            LookUp(TPL_NormalLicence,ProjID=SearchID),
            {HoaProduce:"",HoaPrepress:"",HoaPrint:"",HoaComposite:"",
            HoaCutting:"",HoaMaintenance:"",HoaWarehouse:"",
            HoaQuality:"",HoaWCM:"",HoaCBRE:"",HoaEHS:""}
            );
            
            Patch(TPL_NormalLicence,
            LookUp(TPL_NormalLicence,ProjID=SearchID),
            {
                ProjID:SearchID,//当前项目ID
                ProjName:TextInput_OpUnit_7.Text,//项目名称
                ApplicationDept:Dropdown_AppliDept_2.Selected.Value,//申请部门
                OpUnit:TextInput_OpUnit_2.Text,//作业单位
                OpDirector:TextInput_OpDirector_3.Text,//作业单位负责人
                'OpDirectorM/P':'TextInput_OpDirectorM/P_2'.Text,
                StartTime:DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),//结束时间
                ProjLeader:TextInput_ProjLeder_5.Text,//项目负责人
                'ProjLeaderM/P':'TextInput_ProjLederM/P_2'.Text,
                OnSiteGuardian:TextInput_OpDirector_4.Text,//现场监护人
                'OnSiteGuardianM/P':'TextInputTextInput_OnSiteGuardianM/P_2'.Text,
                OpDept:Concat(Col_SortedDept,ThisRecord.Value,";"),//作业区域所在部门
                OpAr:TextInput_OpAr_2.Text,//详细作业区域
                MainTools:TextInput_MainTools_3.Text,//主要作业工具
                OtherLicenses:If(CountRows(Filter(Licences,State=true))=1,"无",Concat(Filter(Licences,State=true&&LicenceN<>"Normal"),LicenceN,";")),//用封号;连接特殊许可证作为该字段内容
                OpCountent:TextInput_OpCountent_2.Text,//施工内容
                IsPatrol:Switch(Radio_IsPatrol_1.Selected.Value,"是",true,"否",false),//是否巡检
                IsBackUp:Switch(Radio_IsBackUp_1.Selected.Value,"是",true,"否",false),//是否备案
                ProjState:"审批中",//默认审批状态
                NeedFactorDire:If(Radio_FWLevel_2.Selected.Value="一级"&&First(Filter(Licences,LicenceN="Hot")).State,true,false),//是否需要厂长
                FactoryName:If(Radio_FWLevel_2.Selected.Value="一级"&&First(Filter(Licences,LicenceN="Hot")).State,Dropdown_OpDept_5.SelectedText.Value,""),//工厂名
                OtherCoWoker:TextInput_OtherCoWoker_1.Text//其他协作人员
            });
            ForAll(Filter(Gal_CollectMsg,ID_Type<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,
                PhotoType:"其他证件",
                Photograph:ThisRecord.Photo,
                Name:ThisRecord.ID_Type
            }));
            
            ForAll(
            ShowColumns(Col_SortedDept,"Value"),
            Switch(
            ThisRecord.Value,
            "生产",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaProduce:"作业区域需审批"}),
            "印前",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaPrepress:"作业区域需审批"}),
            "印刷",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaPrint:"作业区域需审批"}),
            "复合",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaComposite:"作业区域需审批"}),
            "分切",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaCutting:"作业区域需审批"}),
            "维修",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaMaintenance:"作业区域需审批"}),
            "仓库",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaWarehouse:"作业区域需审批"}),
            "质量",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaQuality:"作业区域需审批"}),
            "WCM",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaWCM:"作业区域需审批"}),
            "CBRE",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaCBRE:"作业区域需审批"}),
            "EHS",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaEHS:"作业区域需审批"}))
            );
            
            //判断是否上传培训照片，若上传，则删除原有文件并上传新文件
            If(CountRows(DataCardValue17_2.Attachments)>0,
            RemoveIf('Licenses File',SearchID&"_TrainingPhoto_" in 'File name with extension');
            //培训照片上传
            TPL_UpLoadFile2.Run(
                 {
                     contentBytes: First(DataCardValue17_2.Attachments).Value,
                     name: SearchID&"_TrainingPhoto_"&First(DataCardValue17_2.Attachments).Name
                 }
             )
            );
            
            //判断是否上传交底文件，若上传，则删除原有交底文件并上传新文件
            If(CountRows(DataCardValue17_3.Attachments)>0,
            RemoveIf('Licenses File',SearchID&"_DiscloseInformation_" in 'File name with extension');
            //交底文件上传
            ForAll(
                DataCardValue17_3.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        name: SearchID&"_DiscloseInformation_"&ThisRecord.Name
                    }
                )
            )),
            
            //上传High表信息&High表人员信息证照上传&High安全控制信息上传
            "High",
            If(IsBlank(LookUp(TPL_HighWork,ProjID=SearchID)),
            Patch(TPL_HighWork,
            {
                ProjID:SearchID,//当前项目ID
                OpUnit:TextInput_OpUnit_2.Text,//作业单位
                OnSiteGuardian:TextInput_OpDirector_4.Text,//现场监护人
                OpAr:TextInput_OpAr_2.Text,//作业地点
                OpCountent:TextInput_OpCountent_2.Text,//作业内容
                StartTime:DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),//结束时间
                HWLevel:Radio_HWLevel_1.Selected.Value,//登高作业等级
                HWHazard1:TextInput_HWHazard1_2.Text,//存在的危害因素
                HWHazard2:TextInput_HWHazard2_2.Text,//可能导致的后果
                HWHazard3:TextInput_HWHazard3_2.Text,//相应的管控措施
                HWTools:Concat(Filter(HW_Tools,State=true),ToolsN,";"),//主要工具
                HWOtherTools:TextInput_HWOtherTools_2.Text//其他工具
            });
            
            If(ReSubCol_DraftHW=true,
            RemoveIf(TPL_InfoGathering,ProjID=TextInput_ProjLeder_4.Text&&PhotoType="登高作业人员信息");
            ForAll(Filter(Col_DraftHW,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,//当前项目ID
                PhotoType:"登高作业人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            })));
            
            
            ForAll(
                Gallery3_10.AllItems,
                Switch(ItemID,
                1,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)})
            ))
            /*;
            
            //判断是否上传登高作业施工方案，若上传，则删除原有文件并上传新文件
            If(CountRows(DataCardValue_ConstructionSchemeHigh_1.Attachments)>0,RemoveIf('Licenses File',SearchID&"_CSHighWork_" in 'File name with extension');
            //登高作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeHigh_1.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        name: SearchID&"_CSHighWork_"&ThisRecord.Name
                    }
                )
            ))
            */,
            Patch(TPL_HighWork,
            LookUp(TPL_HighWork,ProjID=SearchID),
            {
                ProjID:SearchID,//当前项目ID
                OpUnit:TextInput_OpUnit_2.Text,//作业单位
                OnSiteGuardian:TextInput_OpDirector_4.Text,//现场监护人
                OpAr:TextInput_OpAr_2.Text,//作业地点
                OpCountent:TextInput_OpCountent_2.Text,//作业内容
                StartTime:DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),//结束时间
                HWLevel:Radio_HWLevel_1.Selected.Value,//登高作业等级
                HWHazard1:TextInput_HWHazard1_2.Text,//存在的危害因素
                HWHazard2:TextInput_HWHazard2_2.Text,//可能导致的后果
                HWHazard3:TextInput_HWHazard3_2.Text,//相应的管控措施
                HWTools:Concat(Filter(HW_Tools,State=true),ToolsN,";"),//主要工具
                HWOtherTools:TextInput_HWOtherTools_2.Text//其他工具
            }));
            
            If(ReSubCol_DraftHW=true,
            RemoveIf(TPL_InfoGathering,ProjID=TextInput_ProjLeder_4.Text&&PhotoType="登高作业人员信息");
            ForAll(Filter(Col_DraftHW,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,//当前项目ID
                PhotoType:"登高作业人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            })));
            
            
            ForAll(
                Gallery3_10.AllItems,
                Switch(ItemID,
                1,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)})
            ));
            
            //判断是否上传登高作业施工方案，若上传，则删除原有文件并上传新文件
            /*If(CountRows(DataCardValue_ConstructionSchemeHigh_1.Attachments)>0,RemoveIf('Licenses File',SearchID&"_CSHighWork_" in 'File name with extension');
            //登高作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeHigh_1.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        name: SearchID&"_CSHighWork_"&ThisRecord.Name
                    }
                )
            ))*/
            ,
            
            //上传Lifting表信息&Lifting表人员信息证照上传&Lifting安全控制信息上传
            "Lifting",
            If(IsBlank(LookUp(TPL_LiftingWork,ProjID=SearchID)),
            Patch(TPL_LiftingWork,
            {
                ProjID:SearchID,//当前项目ID
                OpAr:TextInput_OpAr_2.Text,//作业地点
                OpCountent:TextInput_OpCountent_2.Text,//作业内容
                SuspendedObject:TextInput_SuspendedObject_2.Text,//被吊物
                SuspendedObjectWeight:Int(TextInput_SuspendedObjectWeight_2.Text),//被吊物重量
                LiftingCapacity:Int(TextInput_LiftingCapacity_2.Text),//起重能力
                OpUnit:TextInput_OpUnit_2.Text,//作业单位
                StartTime:DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),//结束时间
                OnSiteGuardian:TextInput_OpDirector_4.Text,//现场监护人
                LWHazard1:TextInput_LWHazard1_2.Text,//存在的危害因素
                LWHazard2:TextInput_LWHazard2_2.Text,//可能导致的后果
                LWHazard3:TextInput_LWHazard3_2.Text//相应的管控措施
            });
            If(ReSubCol_DraftLW_EQ,
            RemoveIf(TPL_InfoGathering,ProjID=TextInput_ProjLeder_4.Text&&PhotoType="吊装设备信息");
            ForAll(Filter(Col_DraftLW_EQ,Equipments<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,//当前项目ID
                PhotoType:"吊装设备信息",
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Equipments
            })));
            If(ReSubCol_DraftLW_Commander,
            RemoveIf(TPL_InfoGathering,ProjID=TextInput_ProjLeder_4.Text&&PhotoType="吊装指挥人员信息");
            ForAll(Filter(Col_DraftLW_Commander,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,//当前项目ID
                PhotoType:"吊装指挥人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            })));
            If(ReSubCol_DraftLW_Worker,RemoveIf(TPL_InfoGathering,ProjID=TextInput_ProjLeder_4.Text&&PhotoType="吊装作业人员信息");
            ForAll(Filter(Col_DraftLW_Worker,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,//当前项目ID
                PhotoType:"吊装作业人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            })));
            
            
            ForAll(
                Gallery3_11.AllItems,
                Switch(ItemID,
                1,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)})
            ))
            /*;
            
            //判断是否上传吊装作业施工方案，若上传，则删除原有文件并上传新文件
            If(CountRows(DataCardValue_ConstructionSchemeLifting_1.Attachments)>0,RemoveIf('Licenses File',SearchID&"_CSLiftingWork_" in 'File name with extension');
            //吊装作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeLifting_1.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        name: SearchID&"_CSLiftingWork_"&ThisRecord.Name
                    }
                )
            )
            )
            */,
            Patch(TPL_LiftingWork,
            LookUp(TPL_LiftingWork,ProjID=SearchID),
            {
                ProjID:SearchID,//当前项目ID
                OpAr:TextInput_OpAr_2.Text,//作业地点
                OpCountent:TextInput_OpCountent_2.Text,//作业内容
                SuspendedObject:TextInput_SuspendedObject_2.Text,//被吊物
                SuspendedObjectWeight:Int(TextInput_SuspendedObjectWeight_2.Text),//被吊物重量
                LiftingCapacity:Int(TextInput_LiftingCapacity_2.Text),//起重能力
                OpUnit:TextInput_OpUnit_2.Text,//作业单位
                StartTime:DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),//结束时间
                OnSiteGuardian:TextInput_OpDirector_4.Text,//现场监护人
                LWHazard1:TextInput_LWHazard1_2.Text,//存在的危害因素
                LWHazard2:TextInput_LWHazard2_2.Text,//可能导致的后果
                LWHazard3:TextInput_LWHazard3_2.Text//相应的管控措施
            }));
            If(ReSubCol_DraftLW_EQ,
            RemoveIf(TPL_InfoGathering,ProjID=TextInput_ProjLeder_4.Text&&PhotoType="吊装设备信息");
            ForAll(Filter(Col_DraftLW_EQ,Equipments<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,//当前项目ID
                PhotoType:"吊装设备信息",
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Equipments
            })));
            If(ReSubCol_DraftLW_Commander,
            RemoveIf(TPL_InfoGathering,ProjID=TextInput_ProjLeder_4.Text&&PhotoType="吊装指挥人员信息");
            ForAll(Filter(Col_DraftLW_Commander,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,//当前项目ID
                PhotoType:"吊装指挥人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            })));
            If(ReSubCol_DraftLW_Worker,RemoveIf(TPL_InfoGathering,ProjID=TextInput_ProjLeder_4.Text&&PhotoType="吊装作业人员信息");
            ForAll(Filter(Col_DraftLW_Worker,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,//当前项目ID
                PhotoType:"吊装作业人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            })));
            
            
            ForAll(
                Gallery3_11.AllItems,
                Switch(ItemID,
                1,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)})
            ))
            
            /*;
            
            //判断是否上传吊装作业施工方案，若上传，则删除原有文件并上传新文件
            If(CountRows(DataCardValue_ConstructionSchemeLifting_1.Attachments)>0,RemoveIf('Licenses File',SearchID&"_CSLiftingWork_" in 'File name with extension');
            //吊装作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeLifting_1.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        name: SearchID&"_CSLiftingWork_"&ThisRecord.Name
                    }
                )
            )
            )*/
            ,
            
            
            //上传 有限空间作业 表信息&有限空间作业 安全控制信息上传
            "Confined Space",
            If(IsBlank(LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID)),
            Patch(TPL_ConfinedSpaceWork,
            {
                ProjID:SearchID,//当前项目ID
                OpUnit:TextInput_OpUnit_2.Text,//作业单位
                Worker:TextInput_CSW_Worker_2.Text,//作业人员
                OpAr:TextInput_OpAr_2.Text,//作业地点
                OnSiteGuardian:TextInput_OpDirector_4.Text,//现场监护人
                StartTime:DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),//结束时间
                OpCountent:TextInput_OpCountent_2.Text,//作业内容
                CSWHazard1:TextInput_CSWHazard1_2.Text,//存在的危害因素
                CSWHazard2:TextInput_CSWHazard2_2.Text,//可能导致的后果
                CSWHazard3:TextInput_CSWHazard3_2.Text,//相应的管控措施
                GasDetectionTime:TextInput_Ventilation_1.Text//通风起止时间
            });
            
            ForAll(
                Gallery3_13.AllItems,
                Switch(ItemID,
                1,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)})
            ))
            /*;
            
            //判断是否上传有限空间作业施工方案，若上传，则删除原有文件并上传新文件
            If(CountRows(DataCardValue_ConstructionSchemeConfined_1.Attachments)>0,RemoveIf('Licenses File',SearchID&"_CSConfinedSpaceWork_" in 'File name with extension');
            //有限空间作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeConfined_1.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        name: SearchID&"_CSConfinedSpaceWork_"&ThisRecord.Name
                    }
                )
            ))*/
            ,
            Patch(TPL_ConfinedSpaceWork,
            LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),
            {
                ProjID:SearchID,//当前项目ID
                OpUnit:TextInput_OpUnit_2.Text,//作业单位
                Worker:TextInput_CSW_Worker_2.Text,//作业人员
                OpAr:TextInput_OpAr_2.Text,//作业地点
                OnSiteGuardian:TextInput_OpDirector_4.Text,//现场监护人
                StartTime:DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),//结束时间
                OpCountent:TextInput_OpCountent_2.Text,//作业内容
                CSWHazard1:TextInput_CSWHazard1_2.Text,//存在的危害因素
                CSWHazard2:TextInput_CSWHazard2_2.Text,//可能导致的后果
                CSWHazard3:TextInput_CSWHazard3_2.Text,//相应的管控措施
                GasDetectionTime:TextInput_Ventilation_1.Text//通风起止时间
            }));
            
            ForAll(
                Gallery3_13.AllItems,
                Switch(ItemID,
                1,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)})
            ))
            /*;
            
            //判断是否上传有限空间作业施工方案，若上传，则删除原有文件并上传新文件
            If(CountRows(DataCardValue_ConstructionSchemeConfined_1.Attachments)>0,RemoveIf('Licenses File',SearchID&"_CSConfinedSpaceWork_" in 'File name with extension');
            //有限空间作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeConfined_1.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        name: SearchID&"_CSConfinedSpaceWork_"&ThisRecord.Name
                    }
                )
            ))*/
            ,
            
            //上传Hot表信息&Hot表人员信息证照上传&Hot安全控制信息上传
            "Hot",
            If(IsBlank(LookUp(TPL_HotWork,ProjID=SearchID)),
            Patch(TPL_HotWork,
            {
                ProjID:SearchID,//当前项目ID
                OpAr:TextInput_OpAr_2.Text,//作业地点
                OpUnit:TextInput_OpUnit_2.Text,//作业单位
                OnSiteGuardian:TextInput_OpDirector_4.Text,//现场监护人
                StartTime:DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),//结束时间
                OpCountent:TextInput_OpCountent_2.Text,//作业内容
                FWTools:TextInput_FWTools_2.Text,//动火作业工具
                FWHazard1:TextInput_FWHazard1_2.Text,//存在的危害因素
                FWHazard2:TextInput_FWHazard2_2.Text,//可能导致的后果
                FWHazard3:TextInput_FWHazard3_3.Text,//相应的管控措施
                FWLevel:Radio_FWLevel_2.SelectedText.Value,//动火作业级别
                FireHose:Int(TextInput_FWHazard1_10.Text),//消防水带数量
                FireExtinguisher:Int(TextInput_FWHazard1_11.Text),//灭火器数量
                FireBlanket:Int(TextInput_FWHazard1_12.Text),//防火毯数量
                FireOther:TextInput_FWOtherTool_2.Text, //其他防火器材名字
                FireOtherNumber:Int(TextInput_FWOtherToolNumber_2.Text) //其他防火器材数量
            });
            
            If(ReSubCol_DraftFW,RemoveIf(TPL_InfoGathering,ProjID=TextInput_ProjLeder_4.Text&&PhotoType="动火作业人员信息");
            ForAll(Filter(Col_DraftFW,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,//当前项目ID
                PhotoType:"动火作业人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            })));
            
            ForAll(
                Gallery3_12.AllItems,
                Switch(ItemID,
                1,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)})
            ))/*
            ;
            
            //判断是否上传有限空间作业施工方案，若上传，则删除原有文件并上传新文件
            If(CountRows(DataCardValue_ConstructionSchemeHot_1.Attachments)>0,RemoveIf('Licenses File',SearchID&"_CSHotWork_" in 'File name with extension');
            //动火作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeHot_1.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        name: SearchID&"_CSHotWork_"&ThisRecord.Name
                    }
                )
            ))*/
            
            
            ,
            Patch(TPL_HotWork,
            LookUp(TPL_HotWork,ProjID=SearchID),
            {
                ProjID:SearchID,//当前项目ID
                OpAr:TextInput_OpAr_2.Text,//作业地点
                OpUnit:TextInput_OpUnit_2.Text,//作业单位
                OnSiteGuardian:TextInput_OpDirector_4.Text,//现场监护人
                StartTime:DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),//结束时间
                OpCountent:TextInput_OpCountent_2.Text,//作业内容
                FWTools:TextInput_FWTools_2.Text,//动火作业工具
                FWHazard1:TextInput_FWHazard1_2.Text,//存在的危害因素
                FWHazard2:TextInput_FWHazard2_2.Text,//可能导致的后果
                FWHazard3:TextInput_FWHazard3_3.Text,//相应的管控措施
                FWLevel:Radio_FWLevel_2.SelectedText.Value,//动火作业级别
                FireHose:Int(TextInput_FWHazard1_10.Text),//消防水带数量
                FireExtinguisher:Int(TextInput_FWHazard1_11.Text),//灭火器数量
                FireBlanket:Int(TextInput_FWHazard1_12.Text),//防火毯数量
                FireOther:TextInput_FWOtherTool_2.Text, //其他防火器材名字
                FireOtherNumber:Int(TextInput_FWOtherToolNumber_2.Text) //其他防火器材数量
            }));
            
            If(ReSubCol_DraftFW,RemoveIf(TPL_InfoGathering,ProjID=TextInput_ProjLeder_4.Text&&PhotoType="动火作业人员信息");
            ForAll(Filter(Col_DraftFW,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,//当前项目ID
                PhotoType:"动火作业人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            })));
            
            ForAll(
                Gallery3_12.AllItems,
                Switch(ItemID,
                1,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)})
            ))/*
            ;
            
            //判断是否上传有限空间作业施工方案，若上传，则删除原有文件并上传新文件
            If(CountRows(DataCardValue_ConstructionSchemeHot_1.Attachments)>0,RemoveIf('Licenses File',SearchID&"_CSHotWork_" in 'File name with extension');
            //动火作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeHot_1.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        name: SearchID&"_CSHotWork_"&ThisRecord.Name
                    }
                )
            ))*/
            ,
            
            //上传临时用电表信息&临时用电表人员信息证照上传&临时用电安全控制信息上传
            "Temporary Electricity",
            If(IsBlank(LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID)),
            Patch(TPL_TemporaryElectricityUseWork,
            {
                ProjID:SearchID,//当前项目ID
                OpAr:TextInput_OpAr_2.Text,//作业地点
                OpUnit:TextInput_OpUnit_2.Text,//作业单位
                OnSiteGuardian:TextInput_OpDirector_4.Text,//现场监护人
                OpCountent:TextInput_OpCountent_2.Text,//作业内容
                TotalLoad:TextInput_TotalLoad_2.Text,//用电设备总负荷
                WorkingVoltage:TextInput_WorkingVoltage_2.Text,//工作电压
                PowerAccessPoint:TextInput_PowerAccessPoint_2.Text,//电源接入点
                StartTime:DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),//结束时间
                TEUHazard1:TextInput_TEUHazard1_2.Text,//存在的危害因素
                TEUHazard2:TextInput_TEUHazard2_2.Text,//可能导致的后果
                TEUHazard3:TextInput_TEUHazard3_2.Text//相应的管控措施
            });
            
            If(ReSubCol_DraftTEU,RemoveIf(TPL_InfoGathering,ProjID=TextInput_ProjLeder_4.Text&&PhotoType="临时用电人员信息");
            ForAll(Filter(Col_DraftTEU,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,//当前项目ID
                PhotoType:"临时用电人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            })));
            
            ForAll(
                Gallery3_9.AllItems,
                Switch(ItemID,
                1,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)})
            ))
            /*
            ;
            
            //判断是否上传临时用电作业施工方案，若上传，则删除原有文件并上传新文件
            If(CountRows(DataCardValue_ConstructionSchemeTemporaryElectricity_1.Attachments)>0,
            RemoveIf('Licenses File',SearchID&"_CSTemporaryElectricityWork_" in 'File name with extension');
            //临时用电作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeTemporaryElectricity_1.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        name: SearchID&"_CSTemporaryElectricityWork_"&ThisRecord.Name
                    }
                )
            ))*/
            ,
            Patch(TPL_TemporaryElectricityUseWork,
            LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),
            {
                ProjID:SearchID,//当前项目ID
                OpAr:TextInput_OpAr_2.Text,//作业地点
                OpUnit:TextInput_OpUnit_2.Text,//作业单位
                OnSiteGuardian:TextInput_OpDirector_4.Text,//现场监护人
                OpCountent:TextInput_OpCountent_2.Text,//作业内容
                TotalLoad:TextInput_TotalLoad_2.Text,//用电设备总负荷
                WorkingVoltage:TextInput_WorkingVoltage_2.Text,//工作电压
                PowerAccessPoint:TextInput_PowerAccessPoint_2.Text,//电源接入点
                StartTime:DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),//结束时间
                TEUHazard1:TextInput_TEUHazard1_2.Text,//存在的危害因素
                TEUHazard2:TextInput_TEUHazard2_2.Text,//可能导致的后果
                TEUHazard3:TextInput_TEUHazard3_2.Text//相应的管控措施
            }));
            
            If(ReSubCol_DraftTEU,RemoveIf(TPL_InfoGathering,ProjID=TextInput_ProjLeder_4.Text&&PhotoType="临时用电人员信息");
            ForAll(Filter(Col_DraftTEU,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,//当前项目ID
                PhotoType:"临时用电人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            })));
            
            ForAll(
                Gallery3_9.AllItems,
                Switch(ItemID,
                1,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)})
            ))
            /*
            ;
            
            //判断是否上传临时用电作业施工方案，若上传，则删除原有文件并上传新文件
            If(CountRows(DataCardValue_ConstructionSchemeTemporaryElectricity_1.Attachments)>0,
            RemoveIf('Licenses File',SearchID&"_CSTemporaryElectricityWork_" in 'File name with extension');
            //临时用电作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeTemporaryElectricity_1.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        name: SearchID&"_CSTemporaryElectricityWork_"&ThisRecord.Name
                    }
                )
            ))
            */
            ));
            
            
            
            
            //创建一条新的申请界面
            Notify("提交成功", NotificationType.Success);
            If(First(Filter(List_Login,Email=PersonalMsg.Email)).HasAccount=false&&(PersonalMsg.Email in First(Filter(List_Login,"CBRE" in Hod)).HodBackup||PersonalMsg.Email in First(Filter(List_Login,"CBRE" in Hoa)).HoaBackup|| PersonalMsg.Email = First(Filter(List_Login,"CBRE" in Hod)).Email||PersonalMsg.Email = First(Filter(List_Login,"CBRE" in Hoa)).Email),TPL_RAFA_WithoutAccount.Run(SearchID),TPL_RemindApprovalFromApp.Run(SearchID));
            
            ClearCollect(Gal_Ispatch,{Value:true});
            Refresh(TPL_NormalLicence);
            Refresh(TPL_HighWork);
            Refresh(TPL_HotWork);
            Refresh(TPL_LiftingWork);
            Refresh(TPL_ConfinedSpaceWork);
            Refresh(TPL_TemporaryElectricityUseWork);
            Refresh(TPL_ConfinedSpaceWork);
            Refresh(TPL_InfoGathering);
            Refresh(TPL_Login);
            Refresh('Licenses File');
            
            
            ClearCollect(List_Login,TPL_Login);
            Set(SearchID,Gal_SearchDraft.Selected.ProjID);//设置搜索ID
            ClearCollect(Current_Normal,Filter(TPL_NormalLicence,ProjID=SearchID));
            ClearCollect(Current_High,Filter(TPL_HighWork,ProjID=SearchID));
            ClearCollect(Current_Lifting,Filter(TPL_LiftingWork,ProjID=SearchID));
            ClearCollect(Current_ConfinedSpace,Filter(TPL_ConfinedSpaceWork,ProjID=SearchID));
            ClearCollect(Current_Hot,Filter(TPL_HotWork,ProjID=SearchID));
            ClearCollect(Current_TemporaryElectricity,Filter(TPL_TemporaryElectricityUseWork,ProjID=SearchID));
            Navigate(home))
        RadiusBottomLeft: =2
        RadiusBottomRight: =2
        RadiusTopLeft: =2
        RadiusTopRight: =2
        Size: =12
        Text: ="提交申请"
        Visible: =Vis_Sub
        Width: =102
        X: =538
        Y: =1069
        ZIndex: =2

    "Menu_Licence_2 As gallery.'BrowseLayout_Horizontal_TwoTextOneImageVariant_ver5.0'":
        DelayItemLoading: =true
        Height: =46
        Items: =Filter(Licences,State=true)
        LoadingSpinner: =LoadingSpinner.Data
        OnSelect: =Set(Vis_Current,ThisItem.LicenceN)
        ShowNavigation: =true
        ShowScrollbar: =false
        TemplateFill: =If(ThisItem.IsSelected,RGBA(0, 0, 0, 0),Color.AliceBlue)
        TemplatePadding: =0
        TemplateSize: =104.6
        Width: =630
        X: =5
        Y: =1
        ZIndex: =3

        Label4_1 As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Bold
            Height: =45
            OnSelect: =Select(Parent)
            Size: =12
            Text: =ThisItem.LicenceN
            Width: =104.6
            ZIndex: =4

    Container_ConfinedSpaceNew_4 As groupContainer.verticalAutoLayoutContainer:
        Height: =1018
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        Visible: =If(Vis_Current="Confined Space",true,false)
        Width: =630
        X: =5
        Y: =46
        ZIndex: =4

        Container_ConfinedSpaceNew_Title_2 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =110
            LayoutMinHeight: =70
            LayoutMinWidth: =250
            Width: =630
            X: =5
            Y: =107
            ZIndex: =1

            Image3_17 As image:
                Height: =74
                Image: ='1694500910899'
                Width: =78
                ZIndex: =1

            Label3_32 As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =70
                Size: =21
                Text: |-
                    ="Confined Space Work Permit
                    有限空间作业许可证"
                Width: =560
                X: =36
                Y: =7
                ZIndex: =2

            Label3_33 As label:
                Align: =Align.Center
                Color: =RGBA(184, 0, 0, 1)
                FontWeight: =FontWeight.Semibold
                Height: =33
                Size: =10.5
                Text: ="有限空间定义： 封闭或者部分封闭，出入口较为狭窄，作业人员不能长时间在内工作，自然通风不良，易造成有毒有害、易燃易爆物质积聚或者含氧量不足的空间 。"
                Width: =620
                Y: =77
                ZIndex: =3

        Container_ConfinedSpaceNew_5 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =285
            LayoutMinHeight: =60
            LayoutMinWidth: =250
            Width: =Parent.Width
            X: =40
            ZIndex: =2

            Label1_474 As label:
                Height: =25
                Size: =12
                Text: ="现场监护人"
                Width: =94
                Y: =29
                ZIndex: =2

            TextInput_OnSiteGuardian3_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpDirector_4.Text
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =523
                X: =94
                Y: =29
                ZIndex: =3

            Label1_477 As label:
                Height: =25
                Size: =12
                Text: ="作业内容"
                Width: =80
                Y: =106
                ZIndex: =5

            TextInput_OpCountent3_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpCountent_2.Text
                DisplayMode: =DisplayMode.View
                Height: =50
                MaxLength: =65
                Mode: =TextMode.MultiLine
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =523
                X: =94
                Y: =104
                ZIndex: =6

            Label1_478 As label:
                Height: =25
                Size: =12
                Text: ="危害辨识"
                Width: =80
                Y: =179
                ZIndex: =7

            TextInput_CSWHazard1_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_ConfinedSpace).CSWHazard1
                Height: =25
                HintText: ="请输入存在的危害因素"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =457
                X: =160
                Y: =204
                ZIndex: =8

            Label1_479 As label:
                Height: =25
                Size: =12
                Text: ="1）*存在的危害因素"
                Width: =160
                Y: =204
                ZIndex: =9

            Label1_480 As label:
                Height: =25
                Size: =12
                Text: ="2）*可能导致的后果"
                Width: =160
                Y: =229
                ZIndex: =10

            Label1_481 As label:
                Height: =25
                Size: =12
                Text: ="3）*相应的管控措施"
                Width: =160
                Y: =254
                ZIndex: =11

            TextInput_CSWHazard2_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_ConfinedSpace).CSWHazard2
                Height: =25
                HintText: ="请输入可能导致的后果"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =457
                X: =161
                Y: =229
                ZIndex: =12

            TextInput_CSWHazard3_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_ConfinedSpace).CSWHazard3
                Height: =25
                HintText: ="请输入相应的管控措施"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =457
                X: =160
                Y: =254
                ZIndex: =13

            Label1_476 As label:
                Height: =25
                Size: =12
                Text: ="作业地点"
                Width: =80
                Y: =79
                ZIndex: =14

            TextInput_OpAr3_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpAr_2.Text
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =27
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =523
                X: =94
                Y: =79
                ZIndex: =15

            Label1_473 As label:
                Height: =25
                Size: =12
                Text: ="作业单位"
                Width: =80
                Y: =4
                ZIndex: =16

            TextInput_OpUnit3_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpUnit_2.Text
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =523
                X: =94
                Y: =4
                ZIndex: =17

            Label1_475 As label:
                Height: =25
                Size: =12
                Text: ="*作业人员"
                Width: =83
                Y: =54
                ZIndex: =18

            TextInput_CSW_Worker_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_ConfinedSpace).Worker
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                HintText: ="输入作业人员姓名"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error);Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =523
                X: =94
                Y: =54
                ZIndex: =19

            Label1_248 As label:
                Height: =25
                Size: =12
                Text: ="开始时间"
                Width: =80
                Y: =154
                ZIndex: =20

            Label1_249 As label:
                Height: =25
                Size: =12
                Text: ="结束时间"
                Width: =80
                X: =315
                Y: =154
                ZIndex: =21

            TextInput_OpAr1_21 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Text(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =222
                X: =93
                Y: =154
                ZIndex: =22

            TextInput_OpAr1_22 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Text(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =223
                X: =395
                Y: =154
                ZIndex: =23

        Container_NormalSchemaSpace_1 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label1_traning_11.Height+Gallery7_11.Height+Gallery7_11.AllItemsCount*2
            LayoutMinHeight: =150
            LayoutMinWidth: =250
            Visible: =Gallery7_11.AllItemsCount<>0
            Width: =630
            ZIndex: =3

            "Gallery7_11 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                DelayItemLoading: =true
                Height: =Self.AllItemsCount*25
                Items: |-
                    =Filter(Sort('Licenses File',ID,SortOrder.Descending),StartsWith('File name with extension',SearchID&"_CSConfinedSpaceWork"))
                    
                    
                    // =SearchID&"_"
                    
                    //
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =25
                Width: =618
                Y: =Label1_traning_11.Height
                ZIndex: =3

                Title6_11 As label:
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =25
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.Title
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 112
                    X: =96
                    Y: =
                    ZIndex: =2

                Body1_11 As label:
                    FontWeight: =FontWeight.Lighter
                    Height: =25
                    OnSelect: =Launch(ThisItem.'Link to item')
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.'File name with extension'
                    Underline: =true
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 32
                    X: =16
                    ZIndex: =4

            Label1_traning_11 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="当前有限空间作业施工方案 (点击跳转查看) :"
                Width: =577
                ZIndex: =4

        Container2_2 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =DataCardValue_ConstructionSchemeConfined_1.Height+Label1_247.Height+3
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Visible: =false
            Width: =630
            ZIndex: =4

            Label1_247 As label:
                Height: =25
                Size: =12
                Text: ="*重新上传施工方案（若重新提交则会覆盖原有文件）"
                Width: =611
                ZIndex: =1

            DataCardValue_ConstructionSchemeConfined_1 As attachments:
                AddAttachmentText: ="附加文件(word/pdf/图片)"
                BorderColor: =RGBA(9, 33, 98, 1)
                Height: =If(CountRows(DataCardValue_ConstructionSchemeConfined_1.Attachments)<=1,105,105+(CountRows(DataCardValue_ConstructionSchemeConfined_1.Attachments)-1)*40)
                IsInDataCard: =true
                Items: =Blank()
                MaxAttachments: =3
                MaxAttachmentSize: =30
                PaddingBottom: =5
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PaddingRight: =5
                PaddingTop: =5
                Reset: =true
                Size: =12
                Tooltip: =
                Width: =615
                Y: =25
                ZIndex: =2

        Container_HighNew_22 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Gallery3_13.Height+Label1_509.Height+TextInput_ProjLederConfirm_13.Height+30
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =5

            Label1_483 As label:
                Height: =25
                Size: =12
                Text: ="项目负责人确认："
                Width: =140
                Y: =Gallery3_13.Y+Gallery3_13.Height
                ZIndex: =1

            TextInput_ProjLederConfirm_13 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_ProjLeder.Text
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =461
                X: =140
                Y: =Gallery3_13.Y+Gallery3_13.Height
                ZIndex: =2

            "Gallery3_13 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                DelayItemLoading: =true
                Height: =Sum(Self.AllItems,Int(Label_height_14.Text))
                Items: =Filter(Gal_ConfinedSpaceSafetyControl2,Not(IsBlank(Content)))
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                ShowScrollbar: =false
                TemplatePadding: =1
                TemplateSize: =Int(Label_height_14.Text)
                Width: =Parent.Width
                Y: =Label1_509.Height+Label1_482.Height+3
                ZIndex: =3

                Label_height_14 As label:
                    Height: =20
                    OnSelect: =Select(Parent)
                    Size: =21
                    Text: =Title3_16.Height+Gallery3_13.TemplatePadding+4
                    Visible: =false
                    Width: =100
                    X: =498
                    ZIndex: =1

                Radio_PatrolTnspection_32 As radio:
                    BorderColor: =
                    Default: =Switch(ThisItem.Confirm,true,"是",false,"不适用")
                    FocusedBorderColor: =
                    FocusedBorderThickness: =0
                    Height: =25
                    HoverColor: =
                    Items: =["是","不适用"]
                    Layout: =Layout.Horizontal
                    PaddingBottom: =0
                    PaddingTop: =0
                    PressedColor: =
                    RadioSize: =15
                    Size: =12
                    Width: =155
                    ZIndex: =2

                Title3_16 As label:
                    AutoHeight: =true
                    Height: =39
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =15
                    PaddingTop: =0
                    Size: =12
                    Text: =ThisItem.Content
                    VerticalAlign: =VerticalAlign.Top
                    Width: =465
                    X: =155
                    ZIndex: =4

            Label1_509 As label:
                FontWeight: =FontWeight.Bold
                Height: =25
                Size: =11
                Text: ="现场安全控制措施：项目负责人应同现场负责人对以上控制措施进行检查确认"
                Width: =559
                ZIndex: =4

            Label1_482 As label:
                Height: =25
                Size: =12
                Text: ="*通风起止时间："
                Width: =140
                Y: =25
                ZIndex: =5

            TextInput_Ventilation_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_ConfinedSpace).GasDetectionTime
                Height: =25
                HintText: ="请输入通风起止时间"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =489
                X: =122
                Y: =25
                ZIndex: =17

    Container_HotWorkNew_6 As groupContainer.verticalAutoLayoutContainer:
        Height: =1018
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        Visible: =If(Vis_Current="Hot",true,false)
        Width: =630
        X: =5
        Y: =46
        ZIndex: =5

        Container_HotWorkNew_Title_2 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =100
            LayoutMinHeight: =80
            LayoutMinWidth: =250
            Width: =630
            X: =5
            Y: =107
            ZIndex: =1

            Label3_10 As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =70
                Size: =21
                Text: ="热加工（动火）作业许可证"
                Width: =560
                X: =36
                Y: =7
                ZIndex: =58

            Label3_31 As label:
                Align: =Align.Center
                Color: =RGBA(184, 0, 0, 1)
                FontWeight: =FontWeight.Semibold
                Height: =26
                Size: =10.5
                Text: ="高空作业定义：在坠落高度基准面2米以上（含2米）有可能坠落的高处进行的作业。"
                Width: =630
                Y: =74
                ZIndex: =59

            Image3_16 As image:
                Height: =74
                Image: ='1694500910899'
                Width: =78
                ZIndex: =60

        Container_HotWorkNew_7 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label2_45.Height+Gal_DraftFW.Height+ButtonCanvas2_4.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =2

            "Gal_DraftFW As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =If(Self.AllItemsCount=0,1,Self.AllItemsCount)*30
                Items: =Col_DraftFW
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =30
                Width: =630
                Y: =31
                ZIndex: =1

                Rectangle3_14 As rectangle:
                    Height: =30
                    OnSelect: =Select(Parent)
                    Visible: =ThisItem.IsSelected
                    Width: =4
                    ZIndex: =6

                TextInput_HW_Worker_2 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.Name
                    DisabledFill: =RGBA(255, 255, 255, 1)
                    DisplayMode: =If(ReSubCol_DraftFW,DisplayMode.Edit,DisplayMode.Disabled)
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    HintText: ="动火作业人员姓名"
                    OnChange: |-
                        =Patch(Col_DraftFW,ThisItem,{Name:Self.Text});
                        //ClearCollect(Gal_FW_NameIDPatch,Concat(ForAll(Gal_FW_NameID,Concatenate(Name,":",ID)),Value,";"))
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =151
                    X: =4
                    ZIndex: =7

                TextInput__HW_ID_2 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.ID
                    DisabledFill: =RGBA(255, 255, 255, 1)
                    DisplayMode: =If(ReSubCol_DraftFW,DisplayMode.Edit,DisplayMode.Disabled)
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    HintText: ="输入证件号"
                    OnChange: |-
                        =Patch(Col_DraftFW,ThisItem,{ID:Self.Text});
                        ClearCollect(Gal_FW_NameIDPatch,Concat(ForAll(Gal_FW_NameID,Concatenate(Name,":",ID)),Value,";"))
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =294
                    X: =336
                    ZIndex: =8

                Icon4_11 As icon.Cancel:
                    DisplayMode: =If(ReSubCol_DraftFW,DisplayMode.Edit,DisplayMode.Disabled)
                    Height: =18
                    Icon: =Icon.Cancel
                    OnSelect: =Remove(Col_DraftFW,ThisItem)
                    Width: =20
                    X: =589
                    Y: =6
                    ZIndex: =9

                Image_Photo_19 As image:
                    Height: =30
                    Image: =ThisItem.Photo
                    OnSelect: |-
                        =Set(ShowPhoto,ThisItem.Photo.Full);
                        Set(WhereBack,"Draft");
                        Set(IsFirstDraft,false);
                        Navigate(PhotoGraph);
                    Width: =181
                    X: =155
                    ZIndex: =10

                TakePhoto_HW_9 As icon.Camera:
                    DisplayMode: =If(ReSubCol_DraftFW,DisplayMode.Edit,DisplayMode.Disabled)
                    Height: =30
                    Icon: =Icon.Camera
                    OnSelect: |-
                        =Set(Camera_Return,"Draft");
                        Reset(AddMediaButton1);//清空photo
                        Set(IsFirstDraft,false);
                        Set(Camera_Type,"CollectFWDraftMsg");
                        Navigate(Camera)
                    Visible: =If(IsBlank(ThisItem.Photo),true,false)
                    Width: =44
                    X: =292
                    ZIndex: =11

            Label2_45 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="*动火作业人员"
                Width: =155
                ZIndex: =2

            Label2_46 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件号"
                Width: =302
                X: =328
                ZIndex: =3

            Icon1_14 As icon.Add:
                Color: =RGBA(255, 255, 255, 1)
                DisplayMode: =If(ReSubCol_DraftFW,DisplayMode.Edit,DisplayMode.Disabled)
                FocusedBorderThickness: =5
                Height: =30
                Icon: =Icon.Add
                OnSelect: |-
                    =Collect(Col_DraftFW,{Name:"",ID:"",Photo:Blank()})
                Width: =30
                X: =586
                ZIndex: =4

            Label2_60 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件照片"
                Width: =173
                X: =155
                ZIndex: =5

            ButtonCanvas2_4 As Button:
                AccessibleLabel: ="sd"
                BasePaletteColor: =
                DisplayMode: =DisplayMode.Edit
                Font: =""
                FontColor: =
                FontItalic: =false
                FontStrikethrough: =false
                FontUnderline: =false
                FontWeight: =""
                Height: =32
                OnSelect: |-
                    =ClearCollect(Col_DraftFW,{Name:"",ID:"",Photo:Blank()});
                    Set(ReSubCol_DraftFW,true);
                Text: ="重置"
                Width: =96
                X: =520
                Y: =Gal_DraftFW.Y+Gal_DraftFW.Height
                ZIndex: =6

        Container_HotWorkNew_8 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =415
            LayoutMinHeight: =60
            LayoutMinWidth: =250
            Width: =Parent.Width
            X: =40
            ZIndex: =3

            Label1_461 As label:
                Height: =25
                Size: =12
                Text: ="现场监护人"
                Width: =94
                Y: =51
                ZIndex: =2

            TextInput_OnSiteGuardian4_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpDirector_4.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =521
                X: =93
                Y: =51
                ZIndex: =3

            Label1_462 As label:
                Height: =25
                Size: =12
                Text: ="作业内容"
                Width: =80
                Y: =102
                ZIndex: =5

            Label1_463 As label:
                Height: =25
                Size: =12
                Text: ="*作业动火工具"
                Width: =120
                Y: =151
                ZIndex: =6

            TextInput_FWTools_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Hot).FWTools
                Height: =25
                HintText: ="输入作业动火工具"
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =497
                X: =120
                Y: =151
                ZIndex: =7

            Label1_464 As label:
                Height: =25
                Size: =12
                Text: ="危害辨识"
                Width: =80
                Y: =176
                ZIndex: =8

            TextInput_FWHazard1_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Hot).FWHazard1
                Height: =25
                HintText: ="请输入存在的危害因素"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =456
                X: =161
                Y: =201
                ZIndex: =9

            Label1_465 As label:
                Height: =25
                Size: =12
                Text: ="1）*存在的危害因素"
                Width: =160
                Y: =201
                ZIndex: =10

            Label1_466 As label:
                Height: =25
                Size: =12
                Text: ="2）*可能导致的后果"
                Width: =160
                Y: =226
                ZIndex: =11

            Label1_467 As label:
                Height: =25
                Size: =12
                Text: ="3）*相应的管控措施"
                Width: =160
                Y: =251
                ZIndex: =12

            TextInput_FWHazard2_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Hot).FWHazard2
                Height: =25
                HintText: ="请输入可能导致的后果"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =455
                X: =161
                Y: =226
                ZIndex: =13

            TextInput_FWHazard3_3 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Hot).FWHazard3
                Height: =25
                HintText: ="请输入相应的管控措施"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =455
                X: =161
                Y: =251
                ZIndex: =14

            Label1_460 As label:
                Height: =25
                Size: =12
                Text: ="作业单位"
                Width: =80
                Y: =27
                ZIndex: =17

            TextInput_OpUnit4_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpUnit_2.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =521
                X: =93
                Y: =27
                ZIndex: =18

            Label1_459 As label:
                Height: =25
                Size: =12
                Text: ="作业地点"
                Width: =80
                Y: =2
                ZIndex: =19

            TextInput_OpAr4_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpAr_2.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =521
                X: =93
                Y: =2
                ZIndex: =20

            Label1_468 As label:
                FontWeight: =FontWeight.Bold
                Height: =27
                Size: =12
                Text: ="*动火作业级别"
                Width: =120
                Y: =276
                ZIndex: =21

            Radio_FWLevel_2 As radio:
                BorderColor: =
                Default: =First(Current_Hot).FWLevel
                FocusedBorderColor: =
                FocusedBorderThickness: =0
                Height: =95
                HoverColor: =
                Items: =["一级","二级","三级"]
                Layout: =Layout.Horizontal
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                PressedColor: =
                RadioSize: =24
                Size: =12
                Width: =120
                Y: =303
                ZIndex: =22

            Label1_469 As label:
                Height: =82
                Italic: =true
                PaddingTop: =0
                Size: =10
                Text: |-
                    ="注：一级动火：在生产运行状态下的易燃易爆管道、储罐、容器等特殊危险场所的动火作业(含带压不置换动火作业)
                    二级动火：在易燃易场所进行除一级动火以外的动火作业
                    三级动火：除一级和二级外，凡生产系统全部停机，经清洗、置换、分析合格并采取安全隔离措施后的动火作业"
                Width: =522
                X: =95
                Y: =303
                ZIndex: =23

            TextInput_OpCountent4_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpCountent_2.Text
                DisplayMode: =DisplayMode.View
                Height: =50
                MaxLength: =65
                Mode: =TextMode.MultiLine
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =537
                X: =93
                Y: =101
                ZIndex: =24

            Label1_244 As label:
                Height: =25
                Size: =12
                Text: ="开始时间"
                Width: =80
                Y: =76
                ZIndex: =25

            Label1_245 As label:
                Height: =25
                Size: =12
                Text: ="结束时间"
                Width: =80
                X: =315
                Y: =76
                ZIndex: =26

            Label1_470 As label:
                Height: =25
                Size: =12
                Text: ="选择工厂"
                Visible: =If(Radio_FWLevel_2.Selected.Value="一级",true,false)
                Width: =80
                Y: =385
                ZIndex: =33

            Dropdown_OpDept_5 As dropdown:
                BorderStyle: =BorderStyle.None
                ChevronBackground: =RGBA(0, 0, 0, 0)
                ChevronFill: =RGBA(39, 67, 125, 1)
                Default: =First(Current_Normal).FactoryName
                Height: =25
                Items: =Factory
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                Size: =12
                Visible: =If(Radio_FWLevel_2.Selected.Value="一级",true,false)
                Width: =251
                X: =80
                Y: =385
                ZIndex: =34

            TextInput_OpAr1_19 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Text(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =222
                X: =93
                Y: =76
                ZIndex: =35

            TextInput_OpAr1_20 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Text(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =221
                X: =395
                Y: =76
                ZIndex: =36

        Container_NormalSchemaHot_1 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label1_traning_13.Height+Gallery7_13.Height+Gallery7_13.AllItemsCount*2
            LayoutMinHeight: =150
            LayoutMinWidth: =250
            Visible: =Gallery7_13.AllItemsCount<>0
            Width: =630
            ZIndex: =4

            "Gallery7_13 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                DelayItemLoading: =true
                Height: =Self.AllItemsCount*25
                Items: |-
                    =Filter(Sort('Licenses File',ID,SortOrder.Descending),StartsWith('File name with extension',SearchID&"_CSHotWork"))
                    
                    
                    // =SearchID&"_"
                    
                    //
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =25
                Width: =618
                Y: =Label1_traning_13.Height
                ZIndex: =3

                Title6_13 As label:
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =25
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.Title
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 112
                    X: =96
                    Y: =
                    ZIndex: =2

                Body1_13 As label:
                    FontWeight: =FontWeight.Lighter
                    Height: =25
                    OnSelect: =Launch(ThisItem.'Link to item')
                    PaddingLeft: =0
                    PaddingRight: =0
                    Text: =ThisItem.'File name with extension'
                    Underline: =true
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 32
                    X: =16
                    ZIndex: =4

            Label1_traning_13 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="动火作业施工方案 (点击跳转查看) :"
                Width: =467
                ZIndex: =4

        Container2_3 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =DataCardValue_ConstructionSchemeHot_1.Height+Label1_246.Height+3
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Visible: =false
            Width: =630
            ZIndex: =5

            Label1_246 As label:
                Height: =25
                Size: =12
                Text: ="*重新上传施工方案（若重新提交则会覆盖原有文件）"
                Width: =630
                ZIndex: =1

            DataCardValue_ConstructionSchemeHot_1 As attachments:
                AddAttachmentText: ="附加文件(word/pdf/图片)"
                BorderColor: =RGBA(9, 33, 98, 1)
                Height: =If(CountRows(DataCardValue_ConstructionSchemeHot_1.Attachments)<=1,105,105+(CountRows(DataCardValue_ConstructionSchemeHot_1.Attachments)-1)*40)
                IsInDataCard: =true
                Items: =Blank()
                MaxAttachments: =3
                MaxAttachmentSize: =30
                PaddingBottom: =5
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PaddingRight: =5
                PaddingTop: =5
                Reset: =true
                Size: =12
                Tooltip: =
                Width: =615
                Y: =25
                ZIndex: =2

        Container_HighNew_21 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Gallery3_12.Height+Label1_508.Height+TextInput_ProjLederConfirm_15.Height+Label1_484.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =6

            "Gallery3_12 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                DelayItemLoading: =true
                Height: |
                    =Sum(Self.AllItems,Int(Label_height_13.Text))
                Items: =Filter(Gal_HotWorkSafetyControl2,Not(IsBlank(Content)))
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                Selectable: =false
                ShowScrollbar: =false
                TemplatePadding: =1
                TemplateSize: =Int(Label_height_13.Text)
                Width: =Parent.Width
                Y: =Label1_508.Height+TextInput_FWHazard1_10.Height+1+25
                ZIndex: =3

                Label_height_13 As label:
                    Height: =20
                    OnSelect: =Select(Parent)
                    Size: =21
                    Text: =Title3_15.Height+Gallery3_12.TemplatePadding+4
                    Visible: =false
                    Width: =100
                    X: =498
                    ZIndex: =1

                Radio_PatrolTnspection_31 As radio:
                    BorderColor: =
                    Default: =Switch(ThisItem.Confirm,true,"是",false,"不适用")
                    FocusedBorderColor: =
                    FocusedBorderThickness: =0
                    Height: =25
                    HoverColor: =
                    Items: =["是","不适用"]
                    Layout: =Layout.Horizontal
                    PaddingBottom: =0
                    PaddingTop: =0
                    PressedColor: =
                    RadioSize: =15
                    Size: =12
                    Width: =155
                    ZIndex: =2

                Title3_15 As label:
                    AutoHeight: =true
                    Height: =20
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =15
                    PaddingTop: =0
                    Size: =12
                    Text: =ThisItem.Content
                    VerticalAlign: =VerticalAlign.Top
                    Width: =464
                    X: =155
                    ZIndex: =4

            Label1_508 As label:
                FontWeight: =FontWeight.Bold
                Height: =25
                Size: =11
                Text: ="现场安全控制措施：项目负责人应同现场负责人对以上控制措施进行检查确认"
                Width: =559
                ZIndex: =4

            Label1_471 As label:
                Height: =25
                Size: =12
                Text: ="*消防水带数量"
                Width: =120
                Y: =25
                ZIndex: =5

            Label1_472 As label:
                Height: =25
                Size: =12
                Text: ="*灭火器数量"
                Width: =100
                X: =222
                Y: =25
                ZIndex: =6

            Label1_639 As label:
                Height: =25
                Size: =12
                Text: ="*防火毯数量"
                Width: =101
                X: =415
                Y: =25
                ZIndex: =7

            TextInput_FWHazard1_10 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Hot).FireHose
                Fill: =RGBA(0, 0, 0, 0)
                Format: =TextFormat.Number
                Height: =25
                HintText: ="消防水带数量"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =102
                X: =120
                Y: =25
                ZIndex: =9

            TextInput_FWHazard1_11 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Hot).FireExtinguisher
                Fill: =RGBA(0, 0, 0, 0)
                Format: =TextFormat.Number
                Height: =25
                HintText: ="灭火器数量"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =93
                X: =322
                Y: =25
                ZIndex: =10

            TextInput_FWHazard1_12 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Hot).FireBlanket
                Fill: =RGBA(0, 0, 0, 0)
                Format: =TextFormat.Number
                Height: =25
                HintText: ="防火毯数量"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =103
                X: =516
                Y: =25
                ZIndex: =11

            Label1_640 As label:
                Height: =25
                Size: =12
                Text: ="其他器材名 "
                Width: =93
                Y: =50
                ZIndex: =12

            TextInput_FWOtherToolNumber_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Hot).FireOtherNumber
                Fill: =RGBA(0, 0, 0, 0)
                Format: =TextFormat.Number
                Height: =25
                HintText: ="其他器材数量"
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =189
                X: =430
                Y: =50
                ZIndex: =13

            TextInput_FWOtherTool_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Hot).FireOther
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                HintText: ="其他器材名"
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =229
                X: =93
                Y: =50
                ZIndex: =14

            Label1_641 As label:
                Height: =25
                Size: =12
                Text: ="其他器材数量"
                Width: =108
                X: =322
                Y: =50
                ZIndex: =15

            Label1_484 As label:
                Height: =25
                Size: =12
                Text: ="项目负责人确认："
                Width: =140
                Y: =458
                ZIndex: =16

            TextInput_ProjLederConfirm_15 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_ProjLeder.Text
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =461
                X: =140
                Y: =458
                ZIndex: =17

    Container_LiftingNew_5 As groupContainer.verticalAutoLayoutContainer:
        Height: =1018
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        Visible: =If(Vis_Current="Lifting",true,false)
        Width: =630
        X: =5
        Y: =46
        ZIndex: =6

        Container_LiftingDraft1 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =100
            LayoutMinHeight: =70
            LayoutMinWidth: =250
            Width: =630
            X: =5
            Y: =107
            ZIndex: =1

            Image3_15 As image:
                Height: =74
                Image: ='1694500910899'
                Width: =78
                ZIndex: =1

            Label3_9 As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =70
                Size: =21
                Text: |-
                    ="Lifting Work Permit
                    吊装作业许可证"
                Width: =560
                X: =36
                Y: =7
                ZIndex: =2

            Label3_30 As label:
                Align: =Align.Center
                Color: =RGBA(184, 0, 0, 1)
                FontWeight: =FontWeight.Semibold
                Height: =26
                Size: =10.5
                Text: ="定义：利用吊车或者起升机构将重物吊起，并使重物发生位置变化的作业过程"
                Width: =630
                Y: =72
                ZIndex: =3

        Container_LiftingDraft2 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =130
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =630
            X: =5
            Y: =107
            ZIndex: =2

            Label1_387 As label:
                Height: =25
                Size: =12
                Text: ="作业内容"
                Width: =80
                Y: =53
                ZIndex: =1

            Icon1_5 As icon.Add:
                Color: =RGBA(255, 255, 255, 1)
                FocusedBorderThickness: =5
                Height: =30
                Icon: =Icon.Add
                OnSelect: |-
                    =Collect(Gal_HeightsPersMsg,{Name:"",ID:""})
                Width: =30
                X: =600
                Y: =135
                ZIndex: =2

            Label1_308 As label:
                Height: =25
                Size: =12
                Text: ="吊装地点"
                Width: =80
                Y: =25
                ZIndex: =3

            TextInput_OpAr2_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpAr_2.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =536
                X: =83
                Y: =25
                ZIndex: =4

            Label1_392 As label:
                Height: =25
                Size: =12
                Text: ="*被吊物"
                Width: =80
                Y: =100
                ZIndex: =5

            TextInput_SuspendedObject_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Lifting).SuspendedObject
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                HintText: ="输入被吊物名称"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =206
                X: =85
                Y: =100
                ZIndex: =6

            TextInput_OpCountent2_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpCountent_2.Text
                DisplayMode: =DisplayMode.View
                Height: =50
                MaxLength: =65
                Mode: =TextMode.MultiLine
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =536
                X: =83
                Y: =50
                ZIndex: =7

            Label1_440 As label:
                Height: =25
                Size: =12
                Text: ="*被吊物重量(T)"
                Width: =118
                X: =291
                Y: =100
                ZIndex: =8

            TextInput_SuspendedObjectWeight_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Lifting).SuspendedObjectWeight
                Fill: =RGBA(0, 0, 0, 0)
                Format: =TextFormat.Number
                Height: =25
                HintText: ="输入被吊物重量"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =206
                X: =409
                Y: =100
                ZIndex: =9

            Label1_240 As label:
                Height: =25
                Size: =12
                Text: ="作业单位"
                Width: =80
                ZIndex: =12

            TextInput_OpUnit2_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpUnit_2.Text
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =536
                X: =83
                ZIndex: =13

        Container_LiftingDraft3 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label1_traning_10.Height+Gallery7_10.Height+Gallery7_10.AllItemsCount*2
            LayoutMinHeight: =150
            LayoutMinWidth: =250
            Visible: =Gallery7_10.AllItemsCount<>0
            Width: =630
            ZIndex: =3

            "Gallery7_10 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                DelayItemLoading: =true
                Height: =Self.AllItemsCount*25
                Items: |-
                    =Filter('Licenses File',StartsWith('File name with extension',SearchID&"_CSLiftingWork"))
                    
                    
                    // =SearchID&"_"
                    
                    //
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =25
                Width: =618
                Y: =Label1_traning_10.Height
                ZIndex: =3

                Title6_10 As label:
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =25
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.Title
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 112
                    X: =96
                    Y: =
                    ZIndex: =2

                Body1_10 As label:
                    FontWeight: =FontWeight.Lighter
                    Height: =25
                    OnSelect: =Launch(ThisItem.'Link to item')
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.'File name with extension'
                    Underline: =true
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 32
                    X: =16
                    ZIndex: =4

            Label1_traning_10 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="当前吊装作业施工方案 (点击跳转查看) :"
                Width: =463
                ZIndex: =4

        Container_LiftingDraft4 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =DataCardValue_ConstructionSchemeLifting_1.Height+Label1_241.Height+3
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Visible: =false
            Width: =630
            ZIndex: =4

            Label1_241 As label:
                Height: =28
                Size: =12
                Text: ="*重新上传施工方案（若重新提交则会覆盖原有文件）"
                Width: =579
                X: =3
                ZIndex: =1

            DataCardValue_ConstructionSchemeLifting_1 As attachments:
                AddAttachmentText: ="附加文件(word/pdf/图片)"
                BorderColor: =RGBA(9, 33, 98, 1)
                Height: =If(CountRows(DataCardValue_ConstructionSchemeLifting_1.Attachments)<=1,105,105+(CountRows(DataCardValue_ConstructionSchemeLifting_1.Attachments)-1)*40)
                IsInDataCard: =true
                Items: =Blank()
                MaxAttachments: =3
                MaxAttachmentSize: =30
                PaddingBottom: =5
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PaddingRight: =5
                PaddingTop: =5
                Reset: =true
                Size: =12
                Tooltip: =
                Width: =618
                Y: =28
                ZIndex: =2

        Container_LiftingDraft5 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label_125.Height+Gal_DraftLW_EQ.Height+ButtonCanvas2_1.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =5

            "Gal_DraftLW_EQ As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =If(Self.AllItemsCount=0,1,Self.AllItemsCount)*30
                Items: =Col_DraftLW_EQ
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =30
                Width: =630
                Y: =31
                ZIndex: =1

                Rectangle3_11 As rectangle:
                    Height: =31
                    OnSelect: =Select(Parent)
                    Visible: =ThisItem.IsSelected
                    Width: =4
                    ZIndex: =6

                TextInput_LW_Equipments_2 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.Equipments
                    DisabledFill: =RGBA(255, 255, 255, 1)
                    DisplayMode: =If(ReSubCol_DraftLW_EQ,DisplayMode.Edit,DisplayMode.Disabled)
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    HintText: ="输入吊装设备名"
                    OnChange: |-
                        =Patch(Col_DraftLW_EQ,ThisItem,{Equipments:Self.Text});
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =217
                    X: =4
                    ZIndex: =7

                TextInput_LW_EquipmentsID_2 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.ID
                    DisabledFill: =RGBA(255, 255, 255, 1)
                    DisplayMode: =If(ReSubCol_DraftLW_EQ,DisplayMode.Edit,DisplayMode.Disabled)
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    HintText: ="输入吊装设备编号"
                    OnChange: |-
                        =Patch(Col_DraftLW_EQ,ThisItem,{ID:Self.Text});
                        //ClearCollect(Col_DraftLW_EQPatch,Concat(ForAll(Col_DraftLW_EQ,Concatenate(Equipments,":",ID)),Value,";"))
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =409
                    X: =221
                    ZIndex: =8

                Icon4_8 As icon.Cancel:
                    DisplayMode: =If(ReSubCol_DraftLW_EQ,DisplayMode.Edit,DisplayMode.Disabled)
                    Height: =18
                    Icon: =Icon.Cancel
                    OnSelect: =Remove(Col_DraftLW_EQ,ThisItem)
                    Width: =20
                    X: =591
                    Y: =6
                    ZIndex: =9

            Label_125 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =29
                Size: =12
                Text: ="*吊装设备"
                Width: =223
                Y: =1
                ZIndex: =2

            Label2_40 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =29
                Size: =12
                Text: ="*编号"
                Width: =407
                X: =223
                Y: =1
                ZIndex: =3

            Icon1_11 As icon.Add:
                Color: =RGBA(255, 255, 255, 1)
                DisplayMode: =If(ReSubCol_DraftLW_EQ,DisplayMode.Edit,DisplayMode.Disabled)
                FocusedBorderThickness: =5
                Height: =30
                Icon: =Icon.Add
                OnSelect: |-
                    =Collect(Col_DraftLW_EQ,{Equipments:"",ID:""})
                Width: =30
                X: =586
                ZIndex: =4

            ButtonCanvas2_1 As Button:
                AccessibleLabel: ="sd"
                BasePaletteColor: =
                DisplayMode: =DisplayMode.Edit
                Font: =""
                FontColor: =
                FontItalic: =false
                FontStrikethrough: =false
                FontUnderline: =false
                FontWeight: =""
                Height: =32
                OnSelect: |-
                    =ClearCollect(Col_DraftLW_EQ,{Name:"",ID:""});
                    Set(ReSubCol_DraftLW_EQ,true);
                Text: ="重置"
                Width: =96
                X: =520
                Y: =Gal_DraftLW_EQ.Y+Gal_DraftLW_EQ.Height
                ZIndex: =5

        Container_LiftingDraft6 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0.1
            Height: =60
            LayoutMinHeight: =60
            LayoutMinWidth: =250
            Width: =Parent.Width
            X: =40
            ZIndex: =6

            Label1_453 As label:
                Height: =25
                Size: =12
                Text: ="*吊装设备起重能力(T)"
                Width: =167
                X: =1
                Y: =2
                ZIndex: =28

            TextInput_LiftingCapacity_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Lifting).LiftingCapacity
                Fill: =RGBA(0, 0, 0, 0)
                Format: =TextFormat.Number
                Height: =25
                HintText: ="设备起重能力"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =449
                X: =168
                Y: =2
                ZIndex: =29

            Label1_242 As label:
                Height: =25
                Size: =12
                Text: ="开始时间"
                Width: =Len(Self.Text)*20
                X: =1
                Y: =30
                ZIndex: =30

            Label1_243 As label:
                Height: =25
                Size: =12
                Text: ="结束时间"
                Width: =80
                X: =291
                Y: =30
                ZIndex: =31

            TextInput_OpAr1_17 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Text(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =210
                X: =81
                Y: =30
                ZIndex: =32

            TextInput_OpAr1_18 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Text(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =245
                X: =371
                Y: =30
                ZIndex: =33

        Container_LiftingDraft7 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label2_43.Height+Gal_DraftLW_Commander.Height+ButtonCanvas2_2.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =7

            "Gal_DraftLW_Commander As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =If(Self.AllItemsCount=0,1,Self.AllItemsCount)*30
                Items: =Col_DraftLW_Commander
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =30
                Width: =630
                Y: =31
                ZIndex: =1

                Rectangle3_13 As rectangle:
                    Height: =30
                    OnSelect: =Select(Parent)
                    Visible: =ThisItem.IsSelected
                    Width: =4
                    ZIndex: =6

                TextInput_LW_Commander_2 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.Name
                    DisabledFill: =RGBA(255, 255, 255, 1)
                    DisplayMode: =If(ReSubCol_DraftLW_Commander,DisplayMode.Edit,DisplayMode.Disabled)
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    HintText: ="输入指挥人员姓名"
                    OnChange: |
                        =Patch(Col_DraftLW_Commander,ThisItem,{Name:Self.Text});
                        //ClearCollect(Gal_LW_CommanderIDPatch,Concat(ForAll(Col_DraftLW_Commander,Concatenate(Name,":",ID)),Value,";"))
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =151
                    X: =4
                    ZIndex: =7

                TextInput_LW_CommanderID_2 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.ID
                    DisabledFill: =RGBA(255, 255, 255, 1)
                    DisplayMode: =If(ReSubCol_DraftLW_Commander,DisplayMode.Edit,DisplayMode.Disabled)
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    HintText: ="输入证件号"
                    OnChange: |-
                        =Patch(Col_DraftLW_Commander,ThisItem,{ID:Self.Text});
                        //ClearCollect(Gal_LW_CommanderIDPatch,Concat(ForAll(Col_DraftLW_Commander,Concatenate(Name,":",ID)),Value,";"))
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =294
                    X: =336
                    ZIndex: =8

                Icon4_10 As icon.Cancel:
                    DisplayMode: =If(ReSubCol_DraftLW_Commander,DisplayMode.Edit,DisplayMode.Disabled)
                    Height: =18
                    Icon: =Icon.Cancel
                    OnSelect: =Remove(Col_DraftLW_Commander,ThisItem)
                    Width: =20
                    X: =591
                    Y: =6
                    ZIndex: =9

                Image_Photo_18 As image:
                    Height: =30
                    Image: =ThisItem.Photo
                    OnSelect: |-
                        =Set(ShowPhoto,ThisItem.Photo.Full);
                        Set(WhereBack,"Draft");
                        Set(IsFirstDraft,false);
                        Navigate(PhotoGraph);
                    Width: =181
                    X: =155
                    ZIndex: =10

                TakePhoto_HW_8 As icon.Camera:
                    DisplayMode: =If(ReSubCol_DraftLW_Commander,DisplayMode.Edit,DisplayMode.Disabled)
                    Height: =30
                    Icon: =Icon.Camera
                    OnSelect: |
                        =Set(Camera_Return,"Draft");
                        Set(IsFirstDraft,false);
                        Set(Camera_Type,"CollectLW2DraftMsg");
                        Reset(AddMediaButton1);//清空photo
                        Navigate(Camera)
                    Visible: =If(IsBlank(ThisItem.Photo),true,false)
                    Width: =44
                    X: =292
                    ZIndex: =11

            Label2_43 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="*指挥人员"
                Width: =155
                ZIndex: =2

            Label2_44 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件号"
                Width: =302
                X: =328
                ZIndex: =3

            Icon1_13 As icon.Add:
                Color: =RGBA(255, 255, 255, 1)
                DisplayMode: =If(ReSubCol_DraftLW_Commander,DisplayMode.Edit,DisplayMode.Disabled)
                FocusedBorderThickness: =5
                Height: =30
                Icon: =Icon.Add
                OnSelect: |-
                    =Collect(Col_DraftLW_Commander,{Name:"",ID:"",Photo:Blank()})
                Width: =30
                X: =586
                ZIndex: =4

            Label2_59 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件照片"
                Width: =173
                X: =155
                ZIndex: =5

            ButtonCanvas2_2 As Button:
                AccessibleLabel: ="sd"
                BasePaletteColor: =
                DisplayMode: =DisplayMode.Edit
                Font: =""
                FontColor: =
                FontItalic: =false
                FontStrikethrough: =false
                FontUnderline: =false
                FontWeight: =""
                Height: =32
                OnSelect: |-
                    =ClearCollect(Col_DraftLW_Commander,{Name:"",ID:"",Photo:Blank()});
                    Set(ReSubCol_DraftLW_Commander,true);
                Text: ="重置"
                Width: =96
                X: =520
                Y: =Gal_DraftLW_Commander.Y+Gal_DraftLW_Commander.Height
                ZIndex: =6

        Container_LiftingDraft8 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label2_41.Height+Gal_DraftLW_Worker.Height+ButtonCanvas2_3.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =8

            "Gal_DraftLW_Worker As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =If(Self.AllItemsCount=0,1,Self.AllItemsCount)*30
                Items: =Col_DraftLW_Worker
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =30
                Width: =630
                Y: =31
                ZIndex: =1

                Rectangle3_12 As rectangle:
                    Height: =30
                    OnSelect: =Select(Parent)
                    Visible: =ThisItem.IsSelected
                    Width: =4
                    ZIndex: =6

                TextInput_LW_Worker_2 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.Name
                    DisabledFill: =RGBA(255, 255, 255, 1)
                    DisplayMode: =If(ReSubCol_DraftLW_Worker,DisplayMode.Edit,DisplayMode.Disabled)
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    HintText: ="输入吊装人员姓名"
                    OnChange: |+
                        =Patch(Col_DraftLW_Worker,ThisItem,{Name:Self.Text});
                        ClearCollect(Gal_LW_NameIDPatch,Concat(ForAll(Col_DraftLW_Worker,Concatenate(Name,":",ID)),Value,";"))
                        
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =151
                    X: =4
                    ZIndex: =7

                TextInput_LW_ID_2 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.ID
                    DisabledFill: =RGBA(255, 255, 255, 1)
                    DisplayMode: =If(ReSubCol_DraftLW_Worker,DisplayMode.Edit,DisplayMode.Disabled)
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    HintText: ="输入证件号"
                    OnChange: |-
                        =Patch(Col_DraftLW_Worker,ThisItem,{ID:Self.Text});
                        ClearCollect(Gal_LW_NameIDPatch,Concat(ForAll(Col_DraftLW_Worker,Concatenate(Name,":",ID)),Value,";"))
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =294
                    X: =336
                    ZIndex: =8

                Icon4_9 As icon.Cancel:
                    DisplayMode: =If(ReSubCol_DraftLW_Worker,DisplayMode.Edit,DisplayMode.Disabled)
                    Height: =18
                    Icon: =Icon.Cancel
                    OnSelect: =Remove(Col_DraftLW_Worker,ThisItem)
                    Width: =20
                    X: =591
                    Y: =6
                    ZIndex: =9

                Image_Photo_17 As image:
                    Height: =30
                    Image: =ThisItem.Photo
                    OnSelect: |-
                        =Set(ShowPhoto,ThisItem.Photo.Full);
                        Set(WhereBack,"Draft");
                        Set(IsFirstDraft,false);
                        Navigate(PhotoGraph);
                    Width: =181
                    X: =155
                    ZIndex: =10

                TakePhoto_HW_7 As icon.Camera:
                    DisplayMode: =If(ReSubCol_DraftLW_Worker,DisplayMode.Edit,DisplayMode.Disabled)
                    Height: =30
                    Icon: =Icon.Camera
                    OnSelect: |-
                        =Set(Camera_Return,"Draft");
                        Set(IsFirstDraft,false);
                        Set(Camera_Type,"CollectLWDraftMsg");
                        Reset(AddMediaButton1);//清空photo
                        Navigate(Camera)
                    Visible: =If(IsBlank(ThisItem.Photo),true,false)
                    Width: =44
                    X: =292
                    ZIndex: =11

            Label2_41 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="*吊装人员姓名"
                Width: =155
                ZIndex: =2

            Label2_42 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件号"
                Width: =302
                X: =328
                ZIndex: =3

            Icon1_12 As icon.Add:
                Color: =RGBA(255, 255, 255, 1)
                DisplayMode: =If(ReSubCol_DraftLW_Worker,DisplayMode.Edit,DisplayMode.Disabled) 
                FocusedBorderThickness: =5
                Height: =30
                Icon: =Icon.Add
                OnSelect: |-
                    =Collect(Col_DraftLW_Worker,{Name:"",ID:"",Photo:Blank()})
                Width: =30
                X: =586
                ZIndex: =4

            Label2_58 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件照片"
                Width: =173
                X: =155
                ZIndex: =5

            ButtonCanvas2_3 As Button:
                AccessibleLabel: ="sd"
                BasePaletteColor: =
                DisplayMode: =DisplayMode.Edit
                Font: =""
                FontColor: =
                FontItalic: =false
                FontStrikethrough: =false
                FontUnderline: =false
                FontWeight: =""
                Height: =32
                OnSelect: |-
                    =ClearCollect(Col_DraftLW_Worker,{Name:"",ID:"",Photo:Blank()});
                    Set(ReSubCol_DraftLW_Worker,true);
                Text: ="重置"
                Width: =96
                X: =520
                Y: =Gal_DraftLW_Worker.Height+Gal_DraftLW_Worker.Y
                ZIndex: =6

        Container_LiftingDraft9 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =140
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            PaddingBottom: =2
            PaddingTop: =2
            Width: =Parent.Width
            ZIndex: =9

            Label1_455 As label:
                Height: =25
                Size: =12
                Text: ="危害辨识"
                Width: =81
                Y: =30
                ZIndex: =1

            Label1_454 As label:
                Height: =25
                Size: =12
                Text: ="现场监护人"
                Width: =94
                Y: =5
                ZIndex: =5

            TextInput_OnSiteGuardian2_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpDirector_4.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =228
                X: =94
                Y: =5
                ZIndex: =6

            TextInput_LWHazard1_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Lifting).LWHazard1
                Height: =25
                HintText: ="请输入存在的危害因素"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =467
                X: =161
                Y: =55
                ZIndex: =7

            Label1_456 As label:
                Height: =25
                Size: =12
                Text: ="1）*存在的危害因素"
                Width: =160
                Y: =55
                ZIndex: =11

            Label1_457 As label:
                Height: =25
                Size: =12
                Text: ="2）*可能导致的后果"
                Width: =160
                Y: =80
                ZIndex: =12

            Label1_458 As label:
                Height: =25
                Size: =12
                Text: ="3）*相应的管控措施"
                Width: =160
                Y: =105
                ZIndex: =13

            TextInput_LWHazard2_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Lifting).LWHazard2
                Height: =25
                HintText: ="请输入可能导致的后果"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =467
                X: =161
                Y: =80
                ZIndex: =14

            TextInput_LWHazard3_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Lifting).LWHazard3
                Height: =25
                HintText: ="请输入相应的管控措施"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =467
                X: =161
                Y: =105
                ZIndex: =15

        Container_LiftingDraft10 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Gallery3_11.Height+Label1_507.Height+TextInput_ProjLederConfirm_10.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =10

            Label1_301 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="项目负责人确认:"
                Width: =140
                Y: =Gallery3_11.Y+Gallery3_11.Height
                ZIndex: =1

            TextInput_ProjLederConfirm_10 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_ProjLeder.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =461
                X: =140
                Y: =Gallery3_11.Y+Gallery3_11.Height
                ZIndex: =2

            "Gallery3_11 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                DelayItemLoading: =true
                Height: =Sum(Self.AllItems,Int(Label_height_12.Text))
                Items: =Filter(Gal_LiftingWorkControl2,Not(IsBlank(Content)))
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                Selectable: =false
                ShowScrollbar: =false
                TemplatePadding: =1
                TemplateSize: =Title3_14.Height
                Width: =Parent.Width
                Y: =Label1_507.Height
                ZIndex: =3

                Label_height_12 As label:
                    Height: =20
                    OnSelect: =Select(Parent)
                    Size: =21
                    Text: =Title3_14.Height+Gallery3_11.TemplatePadding+5
                    Visible: =false
                    Width: =100
                    X: =498
                    ZIndex: =1

                Radio_PatrolTnspection_30 As radio:
                    BorderColor: =
                    Default: =Switch(ThisItem.Confirm,true,"是",false,"不适用")
                    FocusedBorderColor: =
                    FocusedBorderThickness: =0
                    Height: =25
                    HoverColor: =
                    Items: =["是","不适用"]
                    Layout: =Layout.Horizontal
                    PaddingBottom: =0
                    PaddingTop: =0
                    PressedColor: =
                    RadioSize: =15
                    Size: =12
                    Width: =155
                    ZIndex: =2

                Title3_14 As label:
                    AutoHeight: =true
                    Height: =39
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =15
                    PaddingTop: =0
                    Size: =12
                    Text: =ThisItem.Content
                    VerticalAlign: =VerticalAlign.Top
                    Width: =464
                    X: =155
                    ZIndex: =4

            Label1_507 As label:
                FontWeight: =FontWeight.Bold
                Height: =25
                Size: =11
                Text: ="现场安全控制措施：项目负责人应同现场负责人对以上控制措施进行检查确认"
                Width: =559
                ZIndex: =4

    Container_HighNew_3 As groupContainer.verticalAutoLayoutContainer:
        Height: =1018
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        Visible: =If(Vis_Current="High",true,false)
        Width: =630
        X: =5
        Y: =46
        ZIndex: =7

        Container_HighDraft1 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =100
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            Width: =630
            X: =5
            Y: =107
            ZIndex: =1

            Image3_14 As image:
                Height: =74
                Image: ='1694500910899'
                Width: =78
                ZIndex: =1

            Label3_8 As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =70
                Size: =21
                Text: |-
                    ="High Work Permit
                    高处作业许可证"
                Width: =560
                X: =36
                Y: =7
                ZIndex: =2

            Label3_29 As label:
                Align: =Align.Center
                Color: =RGBA(184, 0, 0, 1)
                FontWeight: =FontWeight.Semibold
                Height: =26
                Size: =10.5
                Text: ="高空作业定义：在坠落高度基准面2米以上（含2米）有可能坠落的高处进行的作业。"
                Width: =630
                Y: =74
                ZIndex: =3

        Container_HighDraft2 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label2_38.Height+Gal_DraftHW.Height+ButtonCanvas2.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =2

            "Gal_DraftHW As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =If(Self.AllItemsCount=0,1,Self.AllItemsCount)*30
                Items: =Col_DraftHW
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =30
                Width: =Parent.Width
                Y: =31
                ZIndex: =1

                Rectangle3_10 As rectangle:
                    DisplayMode: =If(ReSubCol_DraftHW,DisplayMode.Edit,DisplayMode.Disabled)
                    Height: =30
                    OnSelect: =Select(Parent)
                    Visible: =ThisItem.IsSelected
                    Width: =4
                    ZIndex: =6

                TextInput_HW_Name_2 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.Name
                    DisabledFill: =RGBA(255, 255, 255, 1)
                    DisplayMode: =If(ReSubCol_DraftHW,DisplayMode.Edit,DisplayMode.Disabled)
                    Fill: =RGBA(0, 0, 0, 0)
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    HintText: ="输入作业人员姓名"
                    OnChange: |-
                        =Patch(Col_DraftHW,ThisItem,{Name:Self.Text});
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =153
                    ZIndex: =7

                TextInput_HW_ID_2 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.ID
                    DisabledFill: =RGBA(255, 255, 255, 1)
                    DisplayMode: =If(ReSubCol_DraftHW,DisplayMode.Edit,DisplayMode.Disabled)
                    Fill: =RGBA(0, 0, 0, 0)
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    HintText: ="输入证件号"
                    OnChange: |-
                        =Patch(Col_DraftHW,ThisItem,{ID:Self.Text});
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =299
                    X: =331
                    ZIndex: =8

                Icon_HW_Cancel_1 As icon.Cancel:
                    DisplayMode: =If(ReSubCol_DraftHW,DisplayMode.Edit,DisplayMode.Disabled)
                    Height: =18
                    Icon: =Icon.Cancel
                    OnSelect: =Remove(Col_DraftHW,ThisItem)
                    Width: =20
                    X: =586
                    Y: =6
                    ZIndex: =9

                Image_Photo_16 As image:
                    Height: =30
                    Image: =ThisItem.Photo
                    OnSelect: |-
                        =Set(ShowPhoto,ThisItem.Photo.Full);
                        Set(WhereBack,"Draft");
                        Set(IsFirstDraft,false);
                        Navigate(PhotoGraph);
                    Width: =178
                    X: =153
                    ZIndex: =10

                TakePhoto_HW_6 As icon.Camera:
                    DisplayMode: =If(ReSubCol_DraftHW,DisplayMode.Edit,DisplayMode.Disabled)
                    Height: =30
                    Icon: =Icon.Camera
                    OnSelect: |-
                        =Set(Camera_Return,"Draft");
                        Set(IsFirstDraft,false);
                        Set(Camera_Type,"CollectHWDraftMsg");
                        Reset(AddMediaButton1);//清空photo
                        Navigate(Camera);
                    Visible: =If(IsBlank(ThisItem.Photo),true,false)
                    Width: =44
                    X: =290
                    ZIndex: =11

            Label2_38 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="*登高作业人员"
                Width: =155
                ZIndex: =2

            Label2_39 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件号"
                Width: =302
                X: =328
                ZIndex: =3

            Icon_HW_Add_2 As icon.Add:
                Color: =RGBA(255, 255, 255, 1)
                DisplayMode: =If(ReSubCol_DraftHW,DisplayMode.Edit,DisplayMode.Disabled)
                FocusedBorderThickness: =5
                Height: =30
                Icon: =Icon.Add
                OnSelect: |-
                    =Collect(Col_DraftHW,{Name:"",ID:"",Photo:Blank()})
                Width: =30
                X: =582
                ZIndex: =4

            Label2_57 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件照片"
                Width: =173
                X: =155
                ZIndex: =5

            ButtonCanvas2 As Button:
                AccessibleLabel: ="sd"
                BasePaletteColor: =
                DisplayMode: =DisplayMode.Edit
                Font: =""
                FontColor: =
                FontItalic: =false
                FontStrikethrough: =false
                FontUnderline: =false
                FontWeight: =""
                Height: =32
                OnSelect: |-
                    =ClearCollect(Col_DraftHW,{Name:"",ID:"",Photo:Blank()});
                    Set(ReSubCol_DraftHW,true);
                Text: ="重置"
                Width: =96
                X: =520
                Y: =Gal_DraftHW.Y+Gal_DraftHW.Height
                ZIndex: =6

        Container_HighDraft3 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =365
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            X: =5
            Y: =107
            ZIndex: =3

            Label1_231 As label:
                Height: =25
                Size: =12
                Text: ="施工内容描述"
                Width: =107
                Y: =102
                ZIndex: =3

            Label1_234 As label:
                Height: =25
                Size: =12
                Text: ="危害辨识"
                Width: =107
                Y: =205
                ZIndex: =4

            Label1_226 As label:
                Height: =25
                Size: =12
                Text: ="作业单位"
                Width: =107
                ZIndex: =5

            Label1_233 As label:
                Height: =25
                Size: =12
                Text: ="*作业等级"
                Width: =107
                Y: =152
                ZIndex: =7

            Label1_238 As label:
                Height: =25
                Size: =12
                Text: ="*设备与工具"
                Width: =120
                Y: =306
                ZIndex: =8

            Label1_227 As label:
                Height: =25
                Size: =12
                Text: ="现场监护人"
                Width: =107
                Y: =25
                ZIndex: =9

            TextInput_OnSiteGuardian1_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpDirector_4.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =511
                X: =107
                Y: =25
                ZIndex: =11

            TextInput_OpUnit1_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpUnit_2.Text
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =511
                X: =107
                ZIndex: =12

            TextInput_HWHazard1_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_High).HWHazard1
                Height: =25
                HintText: ="请输入存在的危害因素"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =458
                X: =161
                Y: =230
                ZIndex: =13

            TextInput_HWOtherTools_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_High).HWOtherTools
                Height: =25
                HintText: ="请输入所需使用的其他设备"
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =535
                X: =83
                Y: =331
                ZIndex: =14

            Label1_228 As label:
                Height: =25
                Size: =12
                Text: ="作业地点"
                Width: =107
                Y: =50
                ZIndex: =15

            TextInput_OpAr1_14 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpAr_2.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =512
                X: =107
                Y: =50
                ZIndex: =16

            TextInput_OpCountent1_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpCountent_2.Text
                DisplayMode: =DisplayMode.View
                Height: =50
                MaxLength: =65
                Mode: =TextMode.MultiLine
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =511
                X: =107
                Y: =100
                ZIndex: =17

            Radio_HWLevel_1 As radio:
                BorderColor: =
                Default: =First(Current_High).HWLevel
                FocusedBorderColor: =
                FocusedBorderThickness: =0
                Height: =60
                HoverColor: =
                Items: =["一级(2-5米)","二级(5-15米)","三级(15-30米)","特级(30米以上)"]
                Layout: =Layout.Horizontal
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                PressedColor: =
                RadioSize: =22
                Size: =12
                Width: =523
                X: =96
                Y: =150
                ZIndex: =18

            Label1_235 As label:
                Height: =26
                Size: =12
                Text: ="1）*存在的危害因素"
                Width: =160
                Y: =230
                ZIndex: =19

            Label1_236 As label:
                Height: =25
                Size: =12
                Text: ="2）*可能导致的后果"
                Width: =160
                Y: =256
                ZIndex: =20

            Label1_237 As label:
                Height: =25
                Size: =12
                Text: ="3）*相应的管控措施"
                Width: =160
                Y: =281
                ZIndex: =21

            TextInput_HWHazard2_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_High).HWHazard2
                Height: =25
                HintText: ="请输入可能导致的后果"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =458
                X: =161
                Y: =256
                ZIndex: =22

            TextInput_HWHazard3_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_High).HWHazard3
                Height: =25
                HintText: ="请输入相应的管控措施"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =458
                X: =161
                Y: =281
                ZIndex: =23

            Checkbox_Tools1_1 As checkbox:
                CheckboxSize: =25
                Default: =If("自动升降平台/曲臂车" in First(Current_High).HWTools,true,false)
                Height: =30
                OnSelect: |-
                    =ClearCollect(
                        HW_Tools, 
                        {ToolsN: "自动升降平台/曲臂车", State: Checkbox_Tools1_1.Value },
                        {ToolsN: "脚手架", State: Checkbox_Tools2_1.Value },
                        {ToolsN: "梯子", State: Checkbox_Tools3_1.Value }
                    );
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                Size: =12
                Text: ="自动升降平台/曲臂车"
                Width: =208
                X: =107
                Y: =302
                ZIndex: =24

            Checkbox_Tools2_1 As checkbox:
                CheckboxSize: =25
                Default: =If("脚手架" in First(Current_High).HWTools,true,false)
                Height: =30
                OnSelect: |-
                    =ClearCollect(
                        HW_Tools, 
                        {ToolsN: "自动升降平台/曲臂车", State: Checkbox_Tools1_1.Value },
                        {ToolsN: "脚手架", State: Checkbox_Tools2_1.Value },
                        {ToolsN: "梯子", State: Checkbox_Tools3_1.Value }
                    );
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                Size: =12
                Text: ="脚手架"
                Width: =97
                X: =315
                Y: =302
                ZIndex: =25

            Checkbox_Tools3_1 As checkbox:
                CheckboxSize: =25
                Default: =If("梯子" in First(Current_High).HWTools,true,false)
                Height: =30
                OnSelect: |-
                    =ClearCollect(
                        HW_Tools, 
                        {ToolsN: "自动升降平台/曲臂车", State: Checkbox_Tools1_1.Value },
                        {ToolsN: "脚手架", State: Checkbox_Tools2_1.Value },
                        {ToolsN: "梯子", State: Checkbox_Tools3_1.Value }
                    );
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                Size: =12
                Text: ="梯子"
                Width: =83
                X: =417
                Y: =302
                ZIndex: =26

            Label1_239 As label:
                Height: =25
                Size: =12
                Text: ="其他设备"
                Width: =83
                Y: =331
                ZIndex: =27

            Label1_229 As label:
                Height: =25
                Size: =12
                Text: ="开始时间"
                Width: =107
                Y: =75
                ZIndex: =28

            Label1_230 As label:
                Height: =25
                Size: =12
                Text: ="结束时间"
                Width: =100
                X: =310
                Y: =75
                ZIndex: =29

            TextInput_OpAr1_15 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |
                    =Text(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingBottom: =6
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =203
                X: =107
                Y: =75
                ZIndex: =36

            TextInput_OpAr1_16 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Text(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingBottom: =6
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =228
                X: =391
                Y: =75
                ZIndex: =37

        Container_HighDraft4 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label1_traning_9.Height+Gallery7_9.Height+Gallery7_9.AllItemsCount*2
            LayoutMinHeight: =150
            LayoutMinWidth: =250
            Visible: =Gallery7_9.AllItemsCount<>0
            Width: =630
            ZIndex: =4

            "Gallery7_9 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                DelayItemLoading: =true
                Height: =Self.AllItemsCount*25
                Items: |-
                    =Filter('Licenses File',StartsWith('File name with extension',SearchID&"_CSHighWork"))
                    
                    
                    // =SearchID&"_"
                    
                    //
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =25
                Width: =618
                Y: =Label1_traning_9.Height
                ZIndex: =3

                Title6_9 As label:
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =25
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.Title
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 112
                    X: =96
                    Y: =
                    ZIndex: =2

                Body1_9 As label:
                    FontWeight: =FontWeight.Lighter
                    Height: =25
                    OnSelect: =Launch(ThisItem.'Link to item')
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.'File name with extension'
                    Underline: =true
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 32
                    X: =16
                    ZIndex: =4

            Label1_traning_9 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="当前登高作业施工方案 (点击跳转查看) :"
                Width: =507
                ZIndex: =4

        Container_HighDraft5 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.Start
            FillPortions: =0
            Height: =DataCardValue_ConstructionSchemeHigh_1.Height+Label1_232.Height+2
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Visible: =false
            Width: =630
            ZIndex: =5

            Label1_232 As label:
                Height: =25
                Size: =12
                Text: ="*重新上传施工方案（若重新提交则会覆盖原有文件）"
                Width: =488
                ZIndex: =1

            DataCardValue_ConstructionSchemeHigh_1 As attachments:
                AddAttachmentText: ="附加文件(word/pdf/图片)"
                BorderColor: =RGBA(9, 33, 98, 1)
                Height: =If(CountRows(DataCardValue_ConstructionSchemeHigh_1.Attachments)<=1,105,105+(CountRows(DataCardValue_ConstructionSchemeHigh_1.Attachments)-1)*40)
                IsInDataCard: =true
                Items: =Blank()
                MaxAttachments: =3
                MaxAttachmentSize: =30
                PaddingBottom: =5
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PaddingRight: =5
                PaddingTop: =5
                Reset: =true
                Size: =12
                Tooltip: =
                Width: =618
                Y: =25
                ZIndex: =2

        Container_HighDraft6 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Gallery3_10.Height+Label1_506.Height+TextInput_ProjLederConfirm_9.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =6

            Label1_300 As label:
                Height: =25
                Size: =12
                Text: ="项目负责人确认："
                Width: =140
                Y: =Gallery3_10.Y+Gallery3_10.Height
                ZIndex: =1

            TextInput_ProjLederConfirm_9 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_ProjLeder.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =461
                X: =140
                Y: =Gallery3_10.Y+Gallery3_10.Height
                ZIndex: =2

            "Gallery3_10 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                DelayItemLoading: =true
                Height: =Sum(Self.AllItems,Int(Label_height_11.Text))
                Items: =Filter(Gal_HighWorkSafetyControl2,Not(IsBlank(Content)))
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                Selectable: =false
                ShowScrollbar: =false
                TemplatePadding: =1
                TemplateSize: =Title3_13.Height
                Width: =Parent.Width
                Y: =Label1_506.Height
                ZIndex: =3

                Label_height_11 As label:
                    Height: =20
                    OnSelect: =Select(Parent)
                    Size: =21
                    Text: =Title3_13.Height+Gallery3_10.TemplatePadding+4
                    Visible: =false
                    Width: =100
                    X: =498
                    ZIndex: =1

                Radio_PatrolTnspection_29 As radio:
                    BorderColor: =
                    Default: =Switch(ThisItem.Confirm,true,"是",false,"不适用")
                    FocusedBorderColor: =
                    FocusedBorderThickness: =0
                    Height: =25
                    HoverColor: =
                    Items: =["是","不适用"]
                    Layout: =Layout.Horizontal
                    OnSelect: =
                    PaddingBottom: =0
                    PaddingTop: =0
                    PressedColor: =
                    RadioSize: =15
                    Size: =12
                    Width: =155
                    ZIndex: =2

                Title3_13 As label:
                    AutoHeight: =true
                    Height: =39
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =15
                    PaddingTop: =0
                    Size: =12
                    Text: =ThisItem.Content
                    VerticalAlign: =VerticalAlign.Top
                    Width: =465
                    X: =155
                    ZIndex: =4

            Label1_506 As label:
                FontWeight: =FontWeight.Bold
                Height: =25
                Size: =11
                Text: ="现场安全控制措施：项目负责人应同现场负责人对以上控制措施进行检查确认"
                Width: =559
                ZIndex: =4

    Container_NormalNew_2 As groupContainer.verticalAutoLayoutContainer:
        Height: =1018
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        Visible: =If(Vis_Current="Normal",true,false)
        Width: =630
        X: =5
        Y: =46
        ZIndex: =8

        Container_NormalDraft1 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =80
            LayoutMinHeight: =80
            LayoutMinWidth: =250
            Width: =Parent.Width
            X: =5
            Y: =107
            ZIndex: =1

            Image3_12 As image:
                Height: =74
                Image: ='1694500910899'
                Width: =78
                ZIndex: =1

            Label3_6 As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =76
                Size: =21
                Text: |-
                    ="Construction Permit
                    施工许可证"
                Width: =560
                ZIndex: =2

        Container_NormalDraft2 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =460
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            X: =5
            Y: =107
            ZIndex: =2

            ComboBox_OnSiteGuardian_1 As combobox:
                BorderStyle: =BorderStyle.None
                ChevronBackground: =RGBA(0, 0, 0, 0)
                ChevronFill: =RGBA(50, 86, 160, 1)
                DisplayFields: =["DisplayName"]
                Height: =25
                InputTextPlaceholder: ="使用邮箱搜索"
                IsSearchable: =false
                Items: =AllPerson
                OnChange: |-
                    =If(
                        IsBlank(Self.Selected),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                OnSelect: |-
                    =ClearCollect(
                        AllPerson,
                        Office365Users.SearchUser({searchterm:ComboBox_OnSiteGuardian_1.SearchText}),
                        RenameColumns(ShowColumns(Filter(TPL_Login,HasAccount=false),"UserName","Email"),"UserName","DisplayName","Email","Mail")
                        );
                PaddingBottom: =1
                PaddingTop: =1
                SearchFields: =["Mail"]
                SearchItems: =[]
                SelectMultiple: =false
                Size: =12
                Visible: =false
                Width: =190
                X: =116
                Y: =133
                ZIndex: =2

            Label1_153 As label:
                Height: =25
                Size: =12
                Text: ="*项目负责人"
                Width: =110
                Y: =83
                ZIndex: =3

            Label1_152 As label:
                Height: =25
                Size: =12
                Text: ="*作业单位"
                Width: =90
                Y: =56
                ZIndex: =4

            Label1_174 As label:
                Color: =/*If(isTimeWrong=true,Color.DarkRed,RGBA(0, 0, 0, 1))*/
                Height: =25
                Size: =12
                Text: ="*开始时间"
                Width: =90
                Y: =159
                ZIndex: =5

            Label1_218 As label:
                Height: =25
                Size: =12
                Text: ="*施工内容描述"
                Width: =120
                Y: =316
                ZIndex: =6

            Checkbox_Hoisting_1 As checkbox:
                CheckboxSize: =28
                Default: =If("Lifting" in First(Current_Normal).OtherLicenses,true,false)
                Height: =25
                OnSelect: |-
                    =ClearCollect(
                        Licences, 
                        {LicenceN: "Normal", State: true },
                        {LicenceN: "High", State: Checkbox_Heights_1.Value },
                        {LicenceN: "Lifting", State: Checkbox_Hoisting_1.Value },
                        {LicenceN: "Confined Space", State: Checkbox_Limited_1.Value },
                        {LicenceN: "Hot", State: Checkbox_HotWork_1.Value },
                        {LicenceN: "Temporary Electricity", State: Checkbox_TemporaryElectricity_1.Value }
                    );
                    If(
                        ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                        ((
                            DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)>1440||
                            DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)<0
                        )||
                        DateValue(DatePicker_StartDate_1.SelectedDate)<>Today()
                        )
                        ,
                        Set(isTimeWrong,true),
                        Set(isTimeWrong,false)
                    )
                PaddingBottom: =2
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =2
                Size: =12
                Text: ="吊装作业"
                Width: =120
                X: =282
                Y: =263
                ZIndex: =7

            Label1_217 As label:
                Height: =25
                Size: =12
                Text: ="*特种许可"
                Width: =90
                Y: =263
                ZIndex: =8

            Label1_154 As label:
                Height: =25
                Size: =12
                Text: ="*联系方式"
                Width: =90
                X: =310
                Y: =83
                ZIndex: =9

            Label1_155 As label:
                Height: =25
                Size: =12
                Text: ="*作业单位负责人"
                Width: =140
                Y: =108
                ZIndex: =10

            Label1_169 As label:
                Height: =25
                Size: =12
                Text: ="*联系方式"
                Width: =90
                X: =310
                Y: =108
                ZIndex: =11

            Label1_170 As label:
                Height: =25
                Size: =12
                Text: ="*现场监护人"
                Width: =110
                Y: =133
                ZIndex: =12

            Label1_187 As label:
                Height: =25
                Size: =12
                Text: ="*作业区域"
                Width: =90
                Y: =213
                ZIndex: =13

            Label1_173 As label:
                Height: =25
                Size: =12
                Text: ="*联系方式"
                Width: =90
                X: =310
                Y: =133
                ZIndex: =14

            Label1_216 As label:
                Height: =25
                Size: =12
                Text: ="*主要设备/工具"
                Width: =140
                Y: =238
                ZIndex: =15

            Checkbox_HotWork_1 As checkbox:
                CheckboxSize: =28
                Default: =If("Hot" in First(Current_Normal).OtherLicenses,true,false)
                Height: =25
                OnSelect: |-
                    =ClearCollect(
                        Licences, 
                        {LicenceN: "Normal", State: true },
                        {LicenceN: "High", State: Checkbox_Heights_1.Value },
                        {LicenceN: "Lifting", State: Checkbox_Hoisting_1.Value },
                        {LicenceN: "Confined Space", State: Checkbox_Limited_1.Value },
                        {LicenceN: "Hot", State: Checkbox_HotWork_1.Value },
                        {LicenceN: "Temporary Electricity", State: Checkbox_TemporaryElectricity_1.Value }
                    );
                    If(
                        ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                        ((
                            DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)>1440||
                            DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)<0
                        )||
                        DateValue(DatePicker_StartDate_1.SelectedDate)<>Today()
                        )
                        ,
                        Set(isTimeWrong,true),
                        Set(isTimeWrong,false)
                    )
                PaddingBottom: =2
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =2
                Size: =12
                Text: ="热加工操作"
                Width: =138
                X: =116
                Y: =288
                ZIndex: =16

            Checkbox_Limited_1 As checkbox:
                CheckboxSize: =28
                Default: =If("Confined Space" in First(Current_Normal).OtherLicenses,true,false)
                Height: =25
                OnSelect: |-
                    =ClearCollect(
                        Licences, 
                        {LicenceN: "Normal", State: true },
                        {LicenceN: "High", State: Checkbox_Heights_1.Value },
                        {LicenceN: "Lifting", State: Checkbox_Hoisting_1.Value },
                        {LicenceN: "Confined Space", State: Checkbox_Limited_1.Value },
                        {LicenceN: "Hot", State: Checkbox_HotWork_1.Value },
                        {LicenceN: "Temporary Electricity", State: Checkbox_TemporaryElectricity_1.Value }
                    );
                    If(
                        ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                        ((
                            DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)>1440||
                            DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)<0
                        )||
                        DateValue(DatePicker_StartDate_1.SelectedDate)<>Today()
                        )
                        ,
                        Set(isTimeWrong,true),
                        Set(isTimeWrong,false)
                    )
                PaddingBottom: =2
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =2
                Size: =12
                Text: ="有限空间作业"
                Width: =160
                X: =453
                Y: =263
                ZIndex: =17

            Checkbox_TemporaryElectricity_1 As checkbox:
                CheckboxSize: =28
                Default: =If("Temporary Electricity" in First(Current_Normal).OtherLicenses,true,false)
                Height: =25
                OnSelect: |-
                    =ClearCollect(
                        Licences, 
                        {LicenceN: "Normal", State: true },
                        {LicenceN: "High", State: Checkbox_Heights_1.Value },
                        {LicenceN: "Lifting", State: Checkbox_Hoisting_1.Value },
                        {LicenceN: "Confined Space", State: Checkbox_Limited_1.Value },
                        {LicenceN: "Hot", State: Checkbox_HotWork_1.Value },
                        {LicenceN: "Temporary Electricity", State: Checkbox_TemporaryElectricity_1.Value }
                    );
                    If(
                        ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                        ((
                            DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)>1440||
                            DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)<0
                        )||
                        DateValue(DatePicker_StartDate_1.SelectedDate)<>Today()
                        )
                        ,
                        Set(isTimeWrong,true),
                        Set(isTimeWrong,false)
                    )
                PaddingBottom: =2
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =2
                Size: =12
                Text: ="临时用电作业"
                Width: =156
                X: =282
                Y: =288
                ZIndex: =18

            Checkbox_Heights_1 As checkbox:
                CheckboxSize: =28
                Default: =If("High" in First(Current_Normal).OtherLicenses,true,false)
                Height: =25
                OnSelect: |-
                    =ClearCollect(
                        Licences, 
                        {LicenceN: "Normal", State: true },
                        {LicenceN: "High", State: Checkbox_Heights_1.Value },
                        {LicenceN: "Lifting", State: Checkbox_Hoisting_1.Value },
                        {LicenceN: "Confined Space", State: Checkbox_Limited_1.Value },
                        {LicenceN: "Hot", State: Checkbox_HotWork_1.Value },
                        {LicenceN: "Temporary Electricity", State: Checkbox_TemporaryElectricity_1.Value }
                    );
                    If(
                        ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                        ((
                            DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)>1440||
                            DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)<0
                        )||
                        DateValue(DatePicker_StartDate_1.SelectedDate)<>Today()
                        )
                        ,
                        Set(isTimeWrong,true),
                        Set(isTimeWrong,false)
                    )
                PaddingBottom: =2
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =2
                Size: =12
                Text: ="高处作业"
                Width: =120
                X: =116
                Y: =263
                ZIndex: =19

            Label1_181 As label:
                Color: =/*If(isTimeWrong=true,Color.DarkRed,RGBA(0, 0, 0, 1))*/
                Height: =25
                Size: =12
                Text: ="*结束时间"
                Width: =90
                Y: =186
                ZIndex: =20

            TextInput_OpUnit_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).OpUnit
                Height: =25
                HintText: ="输入作业单位"
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =500
                X: =116
                Y: =56
                ZIndex: =21

            "'TextInput_OpDirectorM/P_2' As text":
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =Int(First(Current_Normal).'OpDirectorM/P')
                Format: =TextFormat.Number
                Height: =25
                HintText: ="作业单位负责人手机号"
                OnChange: |-
                    =If(
                        Not(IsMatch(Self.Text, "\d{11}")) && !IsBlank(Self.Text),
                        Notify("请输入十一位数字", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =226
                X: =390
                Y: =108
                ZIndex: =22

            TextInput_OpDirector_3 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).OpDirector
                Height: =25
                HintText: ="作业单位负责人姓名"
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =166
                X: =140
                Y: =108
                ZIndex: =23

            "'TextInput_ProjLederM/P_2' As text":
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =Int(First(Current_Normal).'ProjLeaderM/P')
                Format: =TextFormat.Number
                Height: =25
                HintText: ="项目负责人手机号"
                OnChange: |-
                    =If(
                        Not(IsMatch(Self.Text, "\d{11}")) && !IsBlank(Self.Text),
                        Notify("请输入十一位数字", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =226
                X: =390
                Y: =83
                ZIndex: =24

            "'TextInputTextInput_OnSiteGuardianM/P_2' As text":
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =Int(First(Current_Normal).'OnSiteGuardianM/P')
                Format: =TextFormat.Number
                Height: =25
                HintText: ="现场监护人手机号"
                OnChange: |-
                    =If(
                        Not(IsMatch(Self.Text, "\d{11}")) && !IsBlank(Self.Text),
                        Notify("请输入十一位数字", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =226
                X: =390
                Y: =133
                ZIndex: =25

            TextInput_MainTools_3 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).MainTools
                Height: =25
                HintText: ="请填写主要作业设备或工具"
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =497
                X: =116
                Y: =238
                ZIndex: =26

            DatePicker_StartDate_1 As datepicker:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =/*If(isTimeWrong=true,Color.DarkRed,RGBA(0, 0, 0, 1))*/
                DefaultDate: =First(Current_Normal).StartTime
                Format: ="yyyy/mm/dd"
                Height: =24
                OnChange: |+
                    =If(
                        ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                        ((
                            DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)>1440||
                            DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)<0
                        )||
                        DateValue(DatePicker_StartDate_1.SelectedDate)<>Today()
                        )
                        ,
                        Set(isTimeWrong,true),
                        Set(isTimeWrong,false)
                    )
                    
                    
                PaddingLeft: =5
                PaddingTop: =5
                Size: =12
                Width: =190
                X: =116
                Y: =160
                ZIndex: =27

            DatePicker_EndDate_1 As datepicker:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =/*If(isTimeWrong=true,Color.DarkRed,RGBA(0, 0, 0, 1))*/
                DefaultDate: =First(Current_Normal).EndTime
                Format: ="yyyy/mm/dd"
                Height: =24
                OnChange: |+
                    =If(
                        ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                        ((
                            DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)>1440||
                            DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)<0
                        )||
                        DateValue(DatePicker_StartDate_1.SelectedDate)<>Today()
                        )
                        ,
                        Set(isTimeWrong,true),
                        Set(isTimeWrong,false)
                    )
                    
                    
                PaddingLeft: =5
                PaddingTop: =5
                Size: =12
                Width: =190
                X: =116
                Y: =187
                ZIndex: =28

            TextInput_OpCountent_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).OpCountent
                Height: =50
                HintText: ="对施工内容进行描述"
                MaxLength: =65
                Mode: =TextMode.MultiLine
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =504
                X: =116
                Y: =314
                ZIndex: =29

            TextInput_OpAr_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).OpAr
                Height: =26
                HintText: ="输入详细作业区域"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =252
                X: =371
                Y: =213
                ZIndex: =32

            Label1_166 As label:
                Height: =25
                Size: =12
                Text: ="*申请部门"
                Width: =90
                Y: =31
                ZIndex: =33

            Dropdown_AppliDept_2 As dropdown:
                BorderStyle: =BorderStyle.None
                ChevronBackground: =RGBA(0, 0, 0, 0)
                ChevronFill: =RGBA(39, 67, 125, 1)
                Default: =First(Current_Normal).ApplicationDept
                Height: =25
                Items: =Col_TotalDept
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                Size: =12
                Width: =190
                X: =116
                Y: =31
                ZIndex: =34

            Label1_180 As label:
                Height: =25
                Size: =12
                Text: ="时"
                Width: =35
                X: =421
                Y: =160
                ZIndex: =35

            Dropdown_StartTime_3 As dropdown:
                BorderStyle: =BorderStyle.None
                Color: =/*If(isTimeWrong=true,Color.DarkRed,RGBA(0, 0, 0, 1))*/
                Default: =Hour(First(Current_Normal).StartTime)
                Height: =25
                Items: |-
                    =["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15",
                    "16","17","18","19","20","21","22","23"]
                OnChange: |+
                    =If(
                        ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                        ((
                            DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)>1440||
                            DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)<0
                        )||
                        DateValue(DatePicker_StartDate_1.SelectedDate)<>Today()
                        )
                        ,
                        Set(isTimeWrong,true),
                        Set(isTimeWrong,false)
                    )
                    
                    
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                Size: =12
                Width: =111
                X: =310
                Y: =160
                ZIndex: =36

            Label1_185 As label:
                Height: =25
                Size: =12
                Text: ="时"
                Width: =35
                X: =421
                Y: =188
                ZIndex: =37

            Dropdown_EndTime_3 As dropdown:
                BorderStyle: =BorderStyle.None
                Color: =/*If(isTimeWrong=true,Color.DarkRed,RGBA(0, 0, 0, 1))*/
                Default: =Hour(First(Current_Normal).EndTime)
                Height: =25
                Items: |-
                    =["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15",
                    "16","17","18","19","20","21","22","23"]
                OnChange: |+
                    =If(
                        ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                        ((
                            DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)>1440||
                            DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)<0
                        )||
                        DateValue(DatePicker_StartDate_1.SelectedDate)<>Today()
                        )
                        ,
                        Set(isTimeWrong,true),
                        Set(isTimeWrong,false)
                    )
                    
                    
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                Size: =12
                Width: =111
                X: =310
                Y: =187
                ZIndex: =38

            TextInput_ProjLeder_5 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).ProjLeader
                DisplayMode: =DisplayMode.View
                Height: =25
                HintText: =""
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =190
                X: =116
                Y: =83
                ZIndex: =39

            Label1_164 As label:
                Height: =25
                Size: =12
                Text: ="*项目名称"
                Width: =90
                X: =307
                Y: =6
                ZIndex: =40

            TextInput_OpUnit_7 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).ProjName
                Height: =25
                HintText: ="输入项目名称"
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =226
                X: =390
                Y: =6
                ZIndex: =41

            Label1_215 As label:
                Height: =25
                Size: =12
                Text: ="*项目编号"
                Width: =90
                Y: =6
                ZIndex: =42

            TextInput_ProjLeder_4 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).ProjID
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                HintText: =""
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =190
                X: =116
                Y: =6
                ZIndex: =43

            TextInput_OpDirector_4 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).OnSiteGuardian
                Height: =26
                HintText: ="现场监护人姓名"
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =190
                X: =116
                Y: =133
                ZIndex: =44

            ComboBox1_1 As combobox:
                DefaultSelectedItems: =ShowColumns(Split(First(Current_Normal).OpDept,";"),"Value")
                DisplayFields: =["Value"]
                Height: =25
                Items: =Col_TotalDept
                OnChange: =ClearCollect(Col_SortedDept,Sort(ComboBox1_1.SelectedItems,Value,SortOrder.Ascending))
                PaddingBottom: =1
                PaddingTop: =1
                SearchFields: =["Value"]
                SearchItems: =Search(Col_TotalDept,ComboBox1_1.SearchText,"Value")
                Size: =12
                Width: =255
                X: =116
                Y: =213
                ZIndex: =45

            Label1_179 As label:
                Height: =25
                Size: =12
                Text: ="分"
                Width: =35
                X: =567
                Y: =159
                ZIndex: =46

            Dropdown_StartTime_2 As dropdown:
                BorderStyle: =BorderStyle.None
                Color: =/*If(isTimeWrong=true,Color.DarkRed,RGBA(0, 0, 0, 1))*/
                Default: =Minute(First(Current_Normal).StartTime)
                Height: =25
                Items: =["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"]
                OnChange: |+
                    =If(
                        ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                        ((
                            DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)>1440||
                            DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)<0
                        )||
                        DateValue(DatePicker_StartDate_1.SelectedDate)<>Today()
                        )
                        ,
                        Set(isTimeWrong,true),
                        Set(isTimeWrong,false)
                    )
                    
                    
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                Size: =12
                Width: =111
                X: =456
                Y: =159
                ZIndex: =47

            Label1_184 As label:
                Height: =25
                Size: =12
                Text: ="分"
                Width: =35
                X: =567
                Y: =187
                ZIndex: =48

            Dropdown_EndTime_2 As dropdown:
                BorderStyle: =BorderStyle.None
                Color: =/*If(isTimeWrong=true,Color.DarkRed,RGBA(0, 0, 0, 1))*/
                Default: =Minute(First(Current_Normal).EndTime)
                Height: =25
                Items: =["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"]
                OnChange: |+
                    =If(
                        ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                        ((
                            DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)>1440||
                            DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)<0
                        )||
                        DateValue(DatePicker_StartDate_1.SelectedDate)<>Today()
                        )
                        ,
                        Set(isTimeWrong,true),
                        Set(isTimeWrong,false)
                    )
                    
                    
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                Size: =12
                Width: =111
                X: =456
                Y: =186
                ZIndex: =49

            Label1_219 As label:
                Height: =25
                Size: =12
                Text: ="其他协作人员"
                Width: =116
                Y: =364
                ZIndex: =50

            TextInput_OtherCoWoker_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).OtherCoWoker
                Height: =25
                HintText: ="请输入其他协作人员姓名"
                PaddingBottom: =6
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =504
                X: =116
                Y: =364
                ZIndex: =51

            Label1_222 As label:
                Height: =25
                Size: =12
                Text: ="是否需要巡检"
                Width: =120
                Y: =394
                ZIndex: =52

            Radio_IsPatrol_1 As radio:
                BorderColor: =
                Default: |+
                    =If(
                        "true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"),
                        "是",
                        "否"
                        )
                    
                DisplayMode: |-
                    =If(
                        "true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"),
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                        )
                FocusedBorderColor: =
                FocusedBorderThickness: =0
                Height: =36
                HoverColor: =
                Items: =["是","否"]
                Layout: =Layout.Horizontal
                OnSelect: =true
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                PressedColor: =
                RadioSize: =24
                Size: =12
                Width: =486
                X: =116
                Y: =387
                ZIndex: =53

            Label1_252 As label:
                Height: =25
                Size: =12
                Text: ="是否备案"
                Width: =120
                Y: =430
                ZIndex: =54

            Radio_IsBackUp_1 As radio:
                BorderColor: =
                Default: |+
                    =If(
                        First(Current_Normal).IsBackUp=true,
                        "是",
                        "否"
                        )
                    
                FocusedBorderColor: =
                FocusedBorderThickness: =0
                Height: =36
                HoverColor: =
                Items: =["是","否"]
                Layout: =Layout.Horizontal
                OnSelect: =true
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                PressedColor: =
                RadioSize: =24
                Size: =12
                Width: =486
                X: =116
                Y: =423
                ZIndex: =55

        Container_NormalDraft3 As groupContainer.manualLayoutContainer:
            FillPortions: =0
            Height: =Label1_traning_7.Height+Gallery7_7.Height+Label1_traning_8.Height+Gallery7_8.Height+Gallery7_7.AllItemsCount*2+Gallery7_8.AllItemsCount*2
            LayoutMinHeight: =150
            LayoutMinWidth: =250
            Width: =630
            ZIndex: =3

            "Gallery7_8 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                DelayItemLoading: =true
                Height: =Self.AllItemsCount*25
                Items: |
                    =Filter(Sort('Licenses File',ID,SortOrder.Descending),StartsWith('File name with extension',SearchID&"_DiscloseInformation"))
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =25
                Width: =618
                Y: =Label1_traning_7.Height+Gallery7_7.Height+Label1_traning_8.Height
                ZIndex: =1

                Title6_8 As label:
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =25
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.Title
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 112
                    X: =96
                    Y: =
                    ZIndex: =2

                Body1_8 As label:
                    FontWeight: =FontWeight.Lighter
                    Height: =25
                    OnSelect: =Launch(ThisItem.'Link to item')
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.'File name with extension'
                    Underline: =true
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 32
                    X: =16
                    ZIndex: =4

            Label1_traning_8 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="当前交底材料 (点击跳转查看) :"
                Width: =359
                Y: =Label1_traning_7.Height+Gallery7_7.Height
                ZIndex: =2

            "Gallery7_7 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                DelayItemLoading: =true
                Height: =Self.AllItemsCount*25
                Items: |+
                    =Filter(Sort('Licenses File',ID,SortOrder.Descending),StartsWith('File name with extension',SearchID&"_TrainingPhoto"))
                    
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =25
                Width: =618
                Y: =Label1_traning_7.Height
                ZIndex: =3

                Title6_7 As label:
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =25
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.Title
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 112
                    X: =96
                    Y: =
                    ZIndex: =2

                Body1_7 As label:
                    FontWeight: =FontWeight.Lighter
                    Height: =25
                    OnSelect: =Launch(ThisItem.'Link to item')
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.'File name with extension'
                    Underline: =true
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 32
                    X: =16
                    ZIndex: =4

            Label1_traning_7 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="当前培训照片 (点击跳转查看) :"
                Width: =359
                ZIndex: =4

        Container_NormalDraft4 As groupContainer.manualLayoutContainer:
            FillPortions: =0
            Height: =DataCardValue17_3.Height+Label1_220.Height+DataCardValue17_2.Height+Label1_221.Height+7
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            ZIndex: =4

            DataCardValue17_3 As attachments:
                AddAttachmentText: ="附加文件(pdf/图片)"
                BorderColor: =RGBA(9, 33, 98, 1)
                DisplayMode: =Parent.DisplayMode
                Height: =If(CountRows(DataCardValue17_3.Attachments)<=1,105,105+(CountRows(DataCardValue17_3.Attachments)-1)*40)
                IsInDataCard: =true
                Items: =
                MaxAttachments: =2
                MaxAttachmentSize: =30
                PaddingBottom: =5
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PaddingRight: =5
                PaddingTop: =5
                Reset: =true
                Size: =12
                Tooltip: =
                Width: =629
                Y: =169
                ZIndex: =1

            Label1_220 As label:
                Height: =38
                Size: =12
                Text: ="*重新上传培训照片（若重新提交则会覆盖原有文件）"
                Width: =630
                ZIndex: =4

            Label1_221 As label:
                Height: =34
                Size: =12
                Text: ="*重新上传交底材料（若重新提交则会覆盖原有文件）"
                Width: =629
                X: =1
                Y: =135
                ZIndex: =5

            DataCardValue17_2 As attachments:
                AddAttachmentText: ="附加文件(图片)"
                BorderColor: =RGBA(9, 33, 98, 1)
                Height: =100
                IsInDataCard: =true
                Items: =
                MaxAttachments: =1
                MaxAttachmentSize: =30
                PaddingBottom: =5
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PaddingRight: =5
                PaddingTop: =5
                Reset: =true
                Size: =12
                Tooltip: =
                Width: =629
                Y: =36
                ZIndex: =6

    Container_TemporaryElectricityNew_8 As groupContainer.verticalAutoLayoutContainer:
        Height: =1018
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        Visible: =If(Vis_Current="Temporary Electricity",true,false)
        Width: =630
        X: =5
        Y: =46
        ZIndex: =9

        Container_TemporaryElectricityNew_Title_2 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =110
            LayoutMinHeight: =70
            LayoutMinWidth: =250
            Width: =630
            X: =5
            Y: =107
            ZIndex: =1

            Image3_13 As image:
                Height: =74
                Image: ='1694500910899'
                Width: =78
                ZIndex: =1

            Label3_7 As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =70
                Size: =21
                Text: |-
                    ="Temporary Electricity Use Work Permit
                    临时用电作业许可证"
                Width: =560
                X: =36
                Y: =7
                ZIndex: =2

            Label3_28 As label:
                Align: =Align.Center
                Color: =RGBA(184, 0, 0, 1)
                FontWeight: =FontWeight.Semibold
                Height: =33
                Size: =10.5
                Text: ="定义：除按标准成套配置的，有插头、连线、插座等专用接线装置以外的，所有其他用于临时性用电的电缆、电线、电气开关、设备等，简称临时用电 【使用时间超过1个月的，不能申请临时用电】"
                Width: =630
                Y: =77
                ZIndex: =3

        Container_TemporaryElectricityNew_9 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =55
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =630
            X: =5
            Y: =107
            ZIndex: =2

            Label1_325 As label:
                Height: =25
                Size: =12
                Text: ="作业地点"
                Width: =80
                Y: =27
                ZIndex: =70

            TextInput_OpAr5_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpAr_2.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =537
                X: =80
                Y: =27
                ZIndex: =71

            Label1_320 As label:
                Height: =25
                Size: =12
                Text: ="作业单位"
                Width: =80
                Y: =2
                ZIndex: =72

            TextInput_OpUnit5_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpUnit_2.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =537
                X: =80
                Y: =2
                ZIndex: =73

        Container_TemporaryElectricityNew_10 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label2_36.Height+Gal_DraftTEU.Height+ButtonCanvas2_5.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =3

            "Gal_DraftTEU As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =If(Self.AllItemsCount=0,1,Self.AllItemsCount)*30
                Items: =Col_DraftTEU
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =30
                Width: =630
                Y: =31
                ZIndex: =1

                Rectangle3_9 As rectangle:
                    Height: =30
                    OnSelect: =Select(Parent)
                    Visible: =ThisItem.IsSelected
                    Width: =4
                    ZIndex: =6

                TextInput_TEU_Worker_2 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.Name
                    DisabledFill: =RGBA(255, 255, 255, 1)
                    DisplayMode: =If(ReSubCol_DraftTEU,DisplayMode.Edit,DisplayMode.Disabled) 
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    HintText: ="输入作业人员姓名"
                    OnChange: |-
                        =Patch(Col_DraftTEU,ThisItem,{Name:Self.Text});
                        ClearCollect(Gal_TEU_NameIDPatch,Concat(ForAll(Col_DraftTEU,Concatenate(Name,":",ID)),Value,";"))
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =155
                    ZIndex: =7

                TextInput_TEU_ID_2 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.ID
                    DisabledFill: =RGBA(255, 255, 255, 1)
                    DisplayMode: =If(ReSubCol_DraftTEU,DisplayMode.Edit,DisplayMode.Disabled) 
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    HintText: ="输入证件号"
                    OnChange: |-
                        =Patch(Col_DraftTEU,ThisItem,{ID:Self.Text});
                        ClearCollect(Gal_TEU_NameIDPatch,Concat(ForAll(Col_DraftTEU,Concatenate(Name,":",ID)),Value,";"))
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =301
                    X: =328
                    ZIndex: =8

                Icon4_6 As icon.Cancel:
                    DisplayMode: =If(ReSubCol_DraftTEU,DisplayMode.Edit,DisplayMode.Disabled) 
                    Height: =18
                    Icon: =Icon.Cancel
                    OnSelect: =Remove(Col_DraftTEU,ThisItem)
                    Width: =20
                    X: =589
                    Y: =6
                    ZIndex: =9

                Image_Photo_8 As image:
                    Height: =30
                    Image: =ThisItem.Photo
                    OnSelect: |-
                        =Set(ShowPhoto,ThisItem.Photo.Full);
                        Set(WhereBack,"Draft");
                        Set(IsFirstDraft,false);
                        Navigate(PhotoGraph);
                    Width: =181
                    X: =155
                    ZIndex: =10

                TakePhoto_HW_5 As icon.Camera:
                    DisplayMode: =If(ReSubCol_DraftTEU,DisplayMode.Edit,DisplayMode.Disabled) 
                    Height: =30
                    Icon: =Icon.Camera
                    OnSelect: |-
                        =Set(Camera_Return,"Draft");
                        Set(IsFirstDraft,false);
                        Reset(AddMediaButton1);//清空photo
                        Set(Camera_Type,"CollectTEUDraftMsg");
                        Navigate(Camera)
                    Visible: =If(IsBlank(ThisItem.Photo),true,false)
                    Width: =44
                    X: =292
                    ZIndex: =11

            Label2_36 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="*临时用电作业人员"
                Width: =155
                ZIndex: =2

            Label2_37 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件号"
                Width: =302
                X: =328
                ZIndex: =3

            Icon1_10 As icon.Add:
                Color: =RGBA(255, 255, 255, 1)
                DisplayMode: =If(ReSubCol_DraftTEU,DisplayMode.Edit,DisplayMode.Disabled)
                FocusedBorderThickness: =5
                Height: =30
                Icon: =Icon.Add
                OnSelect: |-
                    =Collect(Col_DraftTEU,{Name:"",ID:"",Photo:Blank()})
                Width: =30
                X: =586
                ZIndex: =4

            Label2_56 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件照片"
                Width: =173
                X: =155
                ZIndex: =5

            ButtonCanvas2_5 As Button:
                AccessibleLabel: ="sd"
                BasePaletteColor: =
                DisplayMode: =DisplayMode.Edit
                Font: =""
                FontColor: =
                FontItalic: =false
                FontStrikethrough: =false
                FontUnderline: =false
                FontWeight: =""
                Height: =32
                OnSelect: |-
                    =ClearCollect(Col_DraftTEU,{Name:"",ID:"",Photo:Blank()});
                    Set(ReSubCol_DraftTEU,true);
                Text: ="重置"
                Width: =96
                X: =520
                Y: =Gal_DraftTEU.Y+Gal_DraftTEU.Height
                ZIndex: =6

        Container_TemporaryElectricityNew_11 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =255
            LayoutMinHeight: =60
            LayoutMinWidth: =250
            Width: =Parent.Width
            X: =40
            ZIndex: =4

            Label1_334 As label:
                Height: =25
                Size: =12
                Text: ="现场监护人"
                Width: =99
                X: =1
                Y: =2
                ZIndex: =28

            TextInput_OnSiteGuardian5_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpDirector_4.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =530
                X: =85
                Y: =2
                ZIndex: =29

            Label1_347 As label:
                Height: =25
                Size: =12
                Text: ="作业内容"
                Width: =80
                Y: =27
                ZIndex: =32

            Label1_348 As label:
                Height: =25
                Size: =12
                Text: ="*用电设备总负荷"
                Width: =133
                Y: =78
                ZIndex: =34

            TextInput_TotalLoad_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_TemporaryElectricity).TotalLoad
                Format: =TextFormat.Number
                Height: =25
                HintText: ="输入用电设备总负荷"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =172
                X: =133
                Y: =78
                ZIndex: =35

            Label1_351 As label:
                Height: =25
                Size: =12
                Text: ="*工作电压"
                Width: =90
                X: =305
                Y: =78
                ZIndex: =36

            TextInput_WorkingVoltage_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_TemporaryElectricity).WorkingVoltage
                Format: =TextFormat.Number
                Height: =25
                HintText: ="输入工作电压"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =219
                X: =395
                Y: =78
                ZIndex: =37

            Label1_366 As label:
                Height: =25
                Size: =12
                Text: ="*电源接入点"
                Width: =100
                Y: =103
                ZIndex: =38

            TextInput_PowerAccessPoint_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_TemporaryElectricity).PowerAccessPoint
                Height: =25
                HintText: ="输入电源接入点"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =514
                X: =100
                Y: =103
                ZIndex: =43

            Label1_378 As label:
                Height: =25
                Size: =12
                Text: ="危害辨识"
                Width: =80
                Y: =153
                ZIndex: =44

            TextInput_TEUHazard1_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_TemporaryElectricity).TEUHazard1
                Height: =25
                HintText: ="请输入存在的危害因素"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =454
                X: =161
                Y: =178
                ZIndex: =45

            Label1_379 As label:
                Height: =25
                Size: =12
                Text: ="1）*存在的危害因素"
                Width: =160
                Y: =178
                ZIndex: =46

            Label1_381 As label:
                Height: =25
                Size: =12
                Text: ="2）*可能导致的后果"
                Width: =160
                Y: =203
                ZIndex: =47

            Label1_386 As label:
                Height: =25
                Size: =12
                Text: ="3）*相应的管控措施"
                Width: =160
                Y: =228
                ZIndex: =48

            TextInput_TEUHazard2_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_TemporaryElectricity).TEUHazard2
                Height: =25
                HintText: ="请输入可能导致的后果"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =454
                X: =161
                Y: =203
                ZIndex: =49

            TextInput_TEUHazard3_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_TemporaryElectricity).TEUHazard3
                Height: =25
                HintText: ="请输入相应的管控措施"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =454
                X: =161
                Y: =228
                ZIndex: =50

            TextInput_OpCountent5_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_OpCountent_2.Text
                DisplayMode: =DisplayMode.View
                Height: =50
                MaxLength: =65
                Mode: =TextMode.MultiLine
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =529
                X: =85
                Y: =28
                ZIndex: =51

            Label1_224 As label:
                Height: =25
                Size: =12
                Text: ="开始时间"
                Width: =80
                Y: =128
                ZIndex: =52

            Label1_225 As label:
                Height: =25
                Size: =12
                Text: ="结束时间"
                Width: =80
                X: =315
                Y: =128
                ZIndex: =53

            TextInput_OpAr1_12 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Text(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =205
                X: =83
                Y: =128
                ZIndex: =54

            TextInput_OpAr1_13 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Text(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =219
                X: =395
                Y: =128
                ZIndex: =55

        Container_NormalSchemaEle_1 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label1_traning_12.Height+Gallery7_12.Height+Gallery7_12.AllItemsCount*2
            LayoutMinHeight: =150
            LayoutMinWidth: =250
            Visible: =Gallery7_12.AllItemsCount<>0
            Width: =630
            ZIndex: =5

            "Gallery7_12 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                DelayItemLoading: =true
                Height: =Self.AllItemsCount*25
                Items: |-
                    =Filter(Sort('Licenses File',ID,SortOrder.Descending),StartsWith('File name with extension',SearchID&"_CSTemporaryElectricityWork"))
                    
                    
                    // =SearchID&"_"
                    
                    //
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =25
                Width: =618
                Y: =Label1_traning_12.Height
                ZIndex: =3

                Title6_12 As label:
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =25
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.Title
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 112
                    X: =96
                    Y: =
                    ZIndex: =2

                Body1_12 As label:
                    FontWeight: =FontWeight.Lighter
                    Height: =25
                    OnSelect: =Launch(ThisItem.'Link to item')
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.'File name with extension'
                    Underline: =true
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 32
                    X: =16
                    ZIndex: =4

            Label1_traning_12 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="当前临时用电作业施工方案 (点击跳转查看) :"
                Width: =566
                ZIndex: =4

        Container2_4 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: |
                =DataCardValue_ConstructionSchemeTemporaryElectricity_1.Height+Label1_223.Height+4
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Visible: =false
            Width: =630
            ZIndex: =6

            Label1_223 As label:
                Height: =26
                Size: =12
                Text: ="*重新上传施工方案（若重新提交则会覆盖原有文件）"
                Width: =615
                Y: =2
                ZIndex: =1

            DataCardValue_ConstructionSchemeTemporaryElectricity_1 As attachments:
                AddAttachmentText: ="附加文件(word/pdf/图片)"
                BorderColor: =RGBA(9, 33, 98, 1)
                Height: =If(CountRows(DataCardValue_ConstructionSchemeTemporaryElectricity_1.Attachments)<=1,105,105+(CountRows(DataCardValue_ConstructionSchemeTemporaryElectricity_1.Attachments)-1)*40)
                IsInDataCard: =true
                Items: =Blank()
                MaxAttachments: =3
                MaxAttachmentSize: =30
                PaddingBottom: =5
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PaddingRight: =5
                PaddingTop: =5
                Reset: =true
                Size: =12
                Tooltip: =
                Width: =615
                Y: =29
                ZIndex: =2

        Container_HighNew_18 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Gallery3_9.Height+Label1_505.Height+TextInput_ProjLederConfirm_7.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =7

            Label1_299 As label:
                Height: =25
                Size: =12
                Text: ="项目负责人确认："
                Width: =140
                Y: =Gallery3_9.Y+Gallery3_9.Height
                ZIndex: =1

            TextInput_ProjLederConfirm_7 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =TextInput_ProjLeder.Text
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =461
                X: =140
                Y: =Gallery3_9.Y+Gallery3_9.Height
                ZIndex: =2

            "Gallery3_9 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                DelayItemLoading: =true
                Height: =Sum(Self.AllItems,Int(Label_height_7.Text))
                Items: =Filter(Gal_TemporaryElectricityUseWorkSafetyControl2,Not(IsBlank(Content)))
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                Selectable: =false
                ShowScrollbar: =false
                TemplatePadding: =1
                TemplateSize: =Int(Label_height_7.Text)
                Width: =Parent.Width
                Y: =Label1_505.Height
                ZIndex: =3

                Label_height_7 As label:
                    Height: =20
                    OnSelect: =Select(Parent)
                    Size: =21
                    Text: =Title3_12.Height+Gallery3_9.TemplatePadding+4
                    Visible: =false
                    Width: =100
                    X: =498
                    ZIndex: =1

                Radio_PatrolTnspection_28 As radio:
                    BorderColor: =
                    Default: =Switch(ThisItem.Confirm,true,"是",false,"不适用")
                    FocusedBorderColor: =
                    FocusedBorderThickness: =0
                    Height: =25
                    HoverColor: =
                    Items: =["是","不适用"]
                    Layout: =Layout.Horizontal
                    PaddingBottom: =0
                    PaddingTop: =0
                    PressedColor: =
                    RadioSize: =15
                    Size: =12
                    Width: =155
                    ZIndex: =2

                Title3_12 As label:
                    AutoHeight: =true
                    Height: =20
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =15
                    PaddingTop: =0
                    Size: =12
                    Text: =ThisItem.Content
                    VerticalAlign: =VerticalAlign.Top
                    Width: =464
                    X: =155
                    ZIndex: =4

            Label1_505 As label:
                FontWeight: =FontWeight.Bold
                Height: =25
                Size: =11
                Text: ="现场安全控制措施：项目负责人应同现场负责人对以上控制措施进行检查确认"
                Width: =559
                ZIndex: =4

    Btn_ReturnHome1_1 As button:
        BorderThickness: =1
        FocusedBorderThickness: =1
        FontWeight: =FontWeight.Normal
        Height: =30
        OnSelect: =Navigate(DraftSearch)
        RadiusBottomLeft: =2
        RadiusBottomRight: =2
        RadiusTopLeft: =2
        RadiusTopRight: =2
        Size: =12
        Text: ="返回"
        Width: =102
        X: =4
        Y: =1106
        ZIndex: =10

    Btn_SaveDraft As button:
        BorderThickness: =1
        DisplayMode: =
        FocusedBorderThickness: =1
        FontWeight: =FontWeight.Normal
        Height: =28
        OnSelect: |
            =ClearCollect(Gal_Ispatch,{Value:true});
            If(
                ("true" in Concat(Filter(Licences,LicenceN<>"Normal"),State,";"))&&
                ((
                    DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)>1440||
                    DateDiff(DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),(DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0)),TimeUnit.Minutes)<0
                )||
                DateValue(DatePicker_StartDate_1.SelectedDate)<>Today()
                )
                ,
                Set(isTimeWrong,true),
                Set(isTimeWrong,false)
            )
            ;
            
            
            //normal表为空, 提醒
            //If("Normal" in Concat(Filter(Licences,State=true),LicenceN),
            If(IsBlank(TextInput_OpUnit_7.Text)||IsBlank(TextInput_OpUnit_2.Text)||IsBlank('TextInput_ProjLederM/P_2'.Text)||IsBlank(TextInput_OpDirector_3.Text)||IsBlank('TextInput_OpDirectorM/P_2'.Text)||IsBlank('TextInputTextInput_OnSiteGuardianM/P_2'.Text)||IsBlank(TextInput_OpAr_2.Text)||IsBlank(TextInput_MainTools_3.Text)||IsBlank(TextInput_OpCountent_2.Text)||IsBlank(TextInput_OpDirector_4.Text)||IsBlank(Concat(ComboBox1_1.SelectedItems,";")),
            Notify("请检查Normal表", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}));
            If(isTimeWrong=true,Notify("特种作业只能当天申请，且工作时间不超过24小时", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}));
            If(
                !IsBlank(LookUp(DataCardValue17_2.Attachments,!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")).Name)||
                (Gallery7_7.AllItemsCount=0&&IsEmpty(DataCardValue17_2.Attachments)),
            //    ,//限制上传的文件格式以及文件不为空
                Notify("培训照片请上传图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            );
            If(
                !IsBlank(LookUp(DataCardValue17_3.Attachments,!EndsWith(ThisRecord.Name,"pdf")&&!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")).Name)||
                (Gallery7_8.AllItemsCount=0&&IsEmpty(DataCardValue17_3.Attachments)),//限制上传的文件格式以及文件不为空
                Notify("交底材料请上传Pdf或图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            );
            
            
            
            
            //High表为空, 提醒
            If("High" in Concat(Filter(Licences,State=true),LicenceN),
            If(IsBlank(TextInput_HWHazard1_2.Text)||IsBlank(TextInput_HWHazard2_2.Text)||IsBlank(TextInput_HWHazard3_2.Text)||IsBlank(Radio_HWLevel_1.Selected.Value),
            Notify("请检查High表", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //High表安全控制提醒
            If("High" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery3_10.AllItems,If(IsBlank(ThisRecord.Radio_PatrolTnspection_29.Selected),
            Notify("请确认High表安全控制措施", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))));
            //登高人员信息表不能为空
            If("High" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Col_DraftHW,
            If(!IsBlank(ThisRecord.Name),
            "",
            Notify("请完善登高作业人员信息1", NotificationType.Error);
            Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))
            );
            If(Gal_DraftHW.AllItemsCount=0,Notify("请完善登高作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))
            );
            //施工方案不能为空
            /*If("High" in Concat(Filter(Licences,State=true),LicenceN),
            If(
                !IsBlank(LookUp(DataCardValue_ConstructionSchemeHigh_1.Attachments,!EndsWith(ThisRecord.Name,"pdf")&&!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")&&!EndsWith(ThisRecord.Name,"doc")&&!EndsWith(ThisRecord.Name,"docx")).Name)||
                (Gallery7_9.AllItemsCount=0&&IsBlank(LookUp(DataCardValue_ConstructionSchemeHigh_1.Attachments,"" in ThisRecord.Name).Name)),
                //限制上传的文件格式以及文件不为空
                Notify("登高作业施工方案请上传Word/Pdf/图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            ));*/
            
            
            //Lifting表为空, 提醒
            If("Lifting" in Concat(Filter(Licences,State=true),LicenceN),
            If(IsBlank(TextInput_SuspendedObject_2.Text)||IsBlank(TextInput_SuspendedObjectWeight_2.Text)||IsBlank(TextInput_LiftingCapacity_2.Text)||IsBlank(TextInput_LWHazard1_2.Text)||IsBlank(TextInput_LWHazard2_2.Text)||IsBlank(TextInput_LWHazard3_2.Text),
            Notify("请检查Lifting表", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //Lifting表安全控制提醒
            If("Lifting" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery3_11.AllItems,If(IsBlank(ThisRecord.Radio_PatrolTnspection_30.Selected),Notify("请确认Lifting表安全控制措施", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))));
            //吊装设备信息表不能为空
            If("Lifting" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Col_DraftLW_EQ,If(IsBlank(ThisRecord.Equipments)||IsBlank(ThisRecord.ID),Notify("请完善吊装设备信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            If(CountRows(Col_DraftLW_EQ)=0,Notify("请完善吊装设备信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //吊装人员信息表不能为空
            If("Lifting" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Col_DraftLW_Worker,If(!IsBlank(ThisRecord.Name),"",Notify("请完善吊装作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            If(Gal_DraftLW_Worker.AllItemsCount=0,Notify("请完善吊装作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //吊装指挥人员信息表不能为空
            If("Lifting" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Col_DraftLW_Commander,If(!IsBlank(ThisRecord.Name),"",Notify("请完善吊装指挥人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            If(Gal_DraftLW_Commander.AllItemsCount=0,Notify("请完善吊装指挥人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //吊装施工方案不能为空
            /*If("Lifting" in Concat(Filter(Licences,State=true),LicenceN),
            If(
                !IsBlank(LookUp(DataCardValue_ConstructionSchemeLifting_1.Attachments,!EndsWith(ThisRecord.Name,"pdf")&&!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")&&!EndsWith(ThisRecord.Name,"doc")&&!EndsWith(ThisRecord.Name,"docx")).Name)||
                (Gallery7_10.AllItemsCount=0&&IsBlank(LookUp(DataCardValue_ConstructionSchemeLifting_1.Attachments,"" in ThisRecord.Name).Name)),
                //限制上传的文件格式以及文件不为空
                Notify("吊装作业施工方案请上传Word/Pdf/图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            ));*/
            
            
            //Confined Space表为空, 提醒
            If("Confined Space" in Concat(Filter(Licences,State=true),LicenceN),
            If(IsBlank(TextInput_CSW_Worker_2.Text)||IsBlank(TextInput_CSWHazard1_2.Text)||IsBlank(TextInput_CSWHazard2_2.Text)||IsBlank(TextInput_CSWHazard3_2.Text)||IsBlank(TextInput_Ventilation_1.Text),
            Notify("请检查Confined Space表", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //Confined Space表安全控制提醒
            If("Confined Space" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery3_13.AllItems,If(IsBlank(ThisRecord.Radio_PatrolTnspection_32.Selected),Notify("请确认Confined Space表安全控制措施", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))));
            //施工方案不能为空
            /*If("Confined Space" in Concat(Filter(Licences,State=true),LicenceN),
            If(
                !IsBlank(LookUp(DataCardValue_ConstructionSchemeConfined_1.Attachments,!EndsWith(ThisRecord.Name,"pdf")&&!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")&&!EndsWith(ThisRecord.Name,"doc")&&!EndsWith(ThisRecord.Name,"docx")).Name)||
                (Gallery7_11.AllItemsCount=0&&IsBlank(LookUp(DataCardValue_ConstructionSchemeConfined_1.Attachments,"" in ThisRecord.Name).Name)),
                //限制上传的文件格式以及文件不为空
                Notify("有限空间作业施工方案请上传Word/Pdf/图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            ));*/
            
            
            //Hot表为空, 提醒
            If("Hot" in Concat(Filter(Licences,State=true),LicenceN),
            If(IsBlank(TextInput_FWHazard1_2.Text)||IsBlank(TextInput_FWHazard2_2.Text)||IsBlank(TextInput_FWHazard3_3.Text)||IsBlank(TextInput_FWHazard1_10.Text)||IsBlank(TextInput_FWHazard1_11.Text)||IsBlank(TextInput_FWHazard1_12.Text)||IsBlank(Radio_FWLevel_2.SelectedText)||IsBlank(TextInput_FWTools_2.Text),
            Notify("请检查Hot表", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //Hot表安全控制提醒
            If("Hot" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery3_12.AllItems,If(IsBlank(ThisRecord.Radio_PatrolTnspection_31.Selected),
            Notify("请确认Hot表安全控制措施", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))));
            //动火作业人员信息不能为空
            If("Hot" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Col_DraftFW,If(!IsBlank(ThisRecord.Name),"",Notify("请完善动火作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            If(Gal_DraftFW.AllItemsCount=0,Notify("请完善动火作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //施工方案不能为空
            /*If("Hot" in Concat(Filter(Licences,State=true),LicenceN),
            If(
                !IsBlank(LookUp(DataCardValue_ConstructionSchemeHot_1.Attachments,!EndsWith(ThisRecord.Name,"pdf")&&!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")&&!EndsWith(ThisRecord.Name,"doc")&&!EndsWith(ThisRecord.Name,"docx")).Name)||
                (Gallery7_13.AllItemsCount=0&&IsBlank(LookUp(DataCardValue_ConstructionSchemeHot_1.Attachments,"" in ThisRecord.Name).Name)),
                //限制上传的文件格式以及文件不为空
                Notify("动火作业施工方案请上传Word/Pdf/图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            ));*/
            
            
            //Temporary Electricity表为空, 提醒
            If("Temporary Electricity" in Concat(Filter(Licences,State=true),LicenceN),
            If(IsBlank(TextInput_TotalLoad_2.Text)||IsBlank(TextInput_WorkingVoltage_2.Text)||IsBlank(TextInput_PowerAccessPoint_2.Text)||IsBlank(TextInput_TEUHazard1_2.Text)||IsBlank(TextInput_TEUHazard2_2.Text)||IsBlank(TextInput_TEUHazard3_2.Text),
            Notify("请检查Temporary Electricity表", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //Temporary Electricity表安全控制提醒
            If("Temporary Electricity" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Gallery3_9.AllItems,If(IsBlank(ThisRecord.Radio_PatrolTnspection_28.Selected),
            Notify("请确认Temporary Electricity表安全控制措施", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false}))));
            //临时用电作业人员信息不能为空
            If("Temporary Electricity" in Concat(Filter(Licences,State=true),LicenceN),
            ForAll(Col_DraftTEU,If(!IsBlank(ThisRecord.Name),"",Notify("临时用电作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            If(Gal_DraftTEU.AllItemsCount=0,Notify("临时用电作业人员信息", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})));
            //施工方案不能为空
            /*If("Temporary Electricity" in Concat(Filter(Licences,State=true),LicenceN),
            If(
                !IsBlank(LookUp(DataCardValue_ConstructionSchemeTemporaryElectricity_1.Attachments,!EndsWith(ThisRecord.Name,"pdf")&&!EndsWith(ThisRecord.Name,"jpg")&&!EndsWith(ThisRecord.Name,"jpe")&&!EndsWith(ThisRecord.Name,"jpeg")&&!EndsWith(ThisRecord.Name,"png")&&!EndsWith(ThisRecord.Name,"doc")&&!EndsWith(ThisRecord.Name,"docx")).Name)||
                (Gallery7_12.AllItemsCount=0&&IsBlank(LookUp(DataCardValue_ConstructionSchemeTemporaryElectricity_1.Attachments,"" in ThisRecord.Name).Name)),
                Notify("临时用电作业施工方案请上传Word/Pdf/图片格式文件！", NotificationType.Error);Patch(Gal_Ispatch,LookUp(Gal_Ispatch,Value=true),{Value:false})
            ));*/
            
            
            If(Not("false" in Concat(Gal_Ispatch,Value,";")),
            ForAll(Filter(Licences,State=true),
            Switch(LicenceN,
            //上传normal表信息&normoal表人员信息证照上传
            "Normal",
            
            
            //清空原有作业区域
            Patch(TPL_NormalLicence,
            LookUp(TPL_NormalLicence,ProjID=SearchID),
            {HoaProduce:"",HoaPrepress:"",HoaPrint:"",HoaComposite:"",
            HoaCutting:"",HoaMaintenance:"",HoaWarehouse:"",
            HoaQuality:"",HoaWCM:"",HoaCBRE:"",HoaEHS:""}
            );
            
            Patch(TPL_NormalLicence,
            LookUp(TPL_NormalLicence,ProjID=SearchID),
            {
                ProjID:SearchID,//当前项目ID
                ProjName:TextInput_OpUnit_7.Text,//项目名称
                ApplicationDept:Dropdown_AppliDept_2.Selected.Value,//申请部门
                OpUnit:TextInput_OpUnit_2.Text,//作业单位
                OpDirector:TextInput_OpDirector_3.Text,//作业单位负责人
                'OpDirectorM/P':'TextInput_OpDirectorM/P_2'.Text,
                StartTime:DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),//结束时间
                ProjLeader:TextInput_ProjLeder_5.Text,//项目负责人
                'ProjLeaderM/P':'TextInput_ProjLederM/P_2'.Text,
                OnSiteGuardian:TextInput_OpDirector_4.Text,//现场监护人
                'OnSiteGuardianM/P':'TextInputTextInput_OnSiteGuardianM/P_2'.Text,
                OpDept:Concat(Col_SortedDept,ThisRecord.Value,";"),//作业区域所在部门
                OpAr:TextInput_OpAr_2.Text,//详细作业区域
                MainTools:TextInput_MainTools_3.Text,//主要作业工具
                OtherLicenses:If(CountRows(Filter(Licences,State=true))=1,"无",Concat(Filter(Licences,State=true&&LicenceN<>"Normal"),LicenceN,";")),//用封号;连接特殊许可证作为该字段内容
                OpCountent:TextInput_OpCountent_2.Text,//施工内容
                IsPatrol:Switch(Radio_IsPatrol_1.Selected.Value,"是",true,"否",false),//是否巡检
                IsBackUp:Switch(Radio_IsBackUp_1.Selected.Value,"是",true,"否",false),//是否备案
                ProjState:"草稿",//默认审批状态
                NeedFactorDire:If(Radio_FWLevel_2.Selected.Value="一级"&&First(Filter(Licences,LicenceN="Hot")).State,true,false),//是否需要厂长
                FactoryName:If(Radio_FWLevel_2.Selected.Value="一级"&&First(Filter(Licences,LicenceN="Hot")).State,Dropdown_OpDept_5.SelectedText.Value,""),//工厂名
                OtherCoWoker:TextInput_OtherCoWoker_1.Text//其他协作人员
            });
            ForAll(Filter(Gal_CollectMsg,ID_Type<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,
                PhotoType:"其他证件",
                Photograph:ThisRecord.Photo,
                Name:ThisRecord.ID_Type
            }));
            
            ForAll(
            ShowColumns(Col_SortedDept,"Value"),
            Switch(
            ThisRecord.Value,
            "生产",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaProduce:"作业区域需审批"}),
            "印前",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaPrepress:"作业区域需审批"}),
            "印刷",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaPrint:"作业区域需审批"}),
            "复合",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaComposite:"作业区域需审批"}),
            "分切",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaCutting:"作业区域需审批"}),
            "维修",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaMaintenance:"作业区域需审批"}),
            "仓库",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaWarehouse:"作业区域需审批"}),
            "质量",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaQuality:"作业区域需审批"}),
            "WCM",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaWCM:"作业区域需审批"}),
            "CBRE",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaCBRE:"作业区域需审批"}),
            "EHS",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaEHS:"作业区域需审批"}))
            );
            
            //判断是否上传培训照片，若上传，则删除原有文件并上传新文件
            If(CountRows(DataCardValue17_2.Attachments)>0,
            RemoveIf('Licenses File',SearchID&"_TrainingPhoto_" in 'File name with extension');
            //培训照片上传
            TPL_UpLoadFile2.Run(
                 {
                     contentBytes: First(DataCardValue17_2.Attachments).Value,
                     name: SearchID&"_TrainingPhoto_"&First(DataCardValue17_2.Attachments).Name
                 }
             )
            );
            
            //判断是否上传交底文件，若上传，则删除原有交底文件并上传新文件
            If(CountRows(DataCardValue17_3.Attachments)>0,
            RemoveIf('Licenses File',SearchID&"_DiscloseInformation_" in 'File name with extension');
            //交底文件上传
            ForAll(
                DataCardValue17_3.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        name: SearchID&"_DiscloseInformation_"&ThisRecord.Name
                    }
                )
            )),
            
            //上传High表信息&High表人员信息证照上传&High安全控制信息上传
            "High",
            If(IsBlank(LookUp(TPL_HighWork,ProjID=SearchID)),
            Patch(TPL_HighWork,
            {
                ProjID:SearchID,//当前项目ID
                OpUnit:TextInput_OpUnit_2.Text,//作业单位
                OnSiteGuardian:TextInput_OpDirector_4.Text,//现场监护人
                OpAr:TextInput_OpAr_2.Text,//作业地点
                OpCountent:TextInput_OpCountent_2.Text,//作业内容
                StartTime:DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),//结束时间
                HWLevel:Radio_HWLevel_1.Selected.Value,//登高作业等级
                HWHazard1:TextInput_HWHazard1_2.Text,//存在的危害因素
                HWHazard2:TextInput_HWHazard2_2.Text,//可能导致的后果
                HWHazard3:TextInput_HWHazard3_2.Text,//相应的管控措施
                HWTools:Concat(Filter(HW_Tools,State=true),ToolsN,";"),//主要工具
                HWOtherTools:TextInput_HWOtherTools_2.Text//其他工具
            });
            
            If(ReSubCol_DraftHW=true,
            RemoveIf(TPL_InfoGathering,ProjID=TextInput_ProjLeder_4.Text&&PhotoType="登高作业人员信息");
            ForAll(Filter(Col_DraftHW,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,//当前项目ID
                PhotoType:"登高作业人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            })));
            
            
            ForAll(
                Gallery3_10.AllItems,
                Switch(ItemID,
                1,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)})
            ))
            /*;
            
            //判断是否上传登高作业施工方案，若上传，则删除原有文件并上传新文件
            If(CountRows(DataCardValue_ConstructionSchemeHigh_1.Attachments)>0,RemoveIf('Licenses File',SearchID&"_CSHighWork_" in 'File name with extension');
            //登高作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeHigh_1.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        name: SearchID&"_CSHighWork_"&ThisRecord.Name
                    }
                )
            ))
            */,
            Patch(TPL_HighWork,
            LookUp(TPL_HighWork,ProjID=SearchID),
            {
                ProjID:SearchID,//当前项目ID
                OpUnit:TextInput_OpUnit_2.Text,//作业单位
                OnSiteGuardian:TextInput_OpDirector_4.Text,//现场监护人
                OpAr:TextInput_OpAr_2.Text,//作业地点
                OpCountent:TextInput_OpCountent_2.Text,//作业内容
                StartTime:DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),//结束时间
                HWLevel:Radio_HWLevel_1.Selected.Value,//登高作业等级
                HWHazard1:TextInput_HWHazard1_2.Text,//存在的危害因素
                HWHazard2:TextInput_HWHazard2_2.Text,//可能导致的后果
                HWHazard3:TextInput_HWHazard3_2.Text,//相应的管控措施
                HWTools:Concat(Filter(HW_Tools,State=true),ToolsN,";"),//主要工具
                HWOtherTools:TextInput_HWOtherTools_2.Text//其他工具
            }));
            
            If(ReSubCol_DraftHW=true,
            RemoveIf(TPL_InfoGathering,ProjID=TextInput_ProjLeder_4.Text&&PhotoType="登高作业人员信息");
            ForAll(Filter(Col_DraftHW,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,//当前项目ID
                PhotoType:"登高作业人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            })));
            
            
            ForAll(
                Gallery3_10.AllItems,
                Switch(ItemID,
                1,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_HighWork,LookUp(TPL_HighWork,ProjID=SearchID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_29.Selected.Value,"是",true,"不适用",false,false)})
            ));
            
            //判断是否上传登高作业施工方案，若上传，则删除原有文件并上传新文件
            /*If(CountRows(DataCardValue_ConstructionSchemeHigh_1.Attachments)>0,RemoveIf('Licenses File',SearchID&"_CSHighWork_" in 'File name with extension');
            //登高作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeHigh_1.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        name: SearchID&"_CSHighWork_"&ThisRecord.Name
                    }
                )
            ))*/
            ,
            
            //上传Lifting表信息&Lifting表人员信息证照上传&Lifting安全控制信息上传
            "Lifting",
            If(IsBlank(LookUp(TPL_LiftingWork,ProjID=SearchID)),
            Patch(TPL_LiftingWork,
            {
                ProjID:SearchID,//当前项目ID
                OpAr:TextInput_OpAr_2.Text,//作业地点
                OpCountent:TextInput_OpCountent_2.Text,//作业内容
                SuspendedObject:TextInput_SuspendedObject_2.Text,//被吊物
                SuspendedObjectWeight:Int(TextInput_SuspendedObjectWeight_2.Text),//被吊物重量
                LiftingCapacity:Int(TextInput_LiftingCapacity_2.Text),//起重能力
                OpUnit:TextInput_OpUnit_2.Text,//作业单位
                StartTime:DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),//结束时间
                OnSiteGuardian:TextInput_OpDirector_4.Text,//现场监护人
                LWHazard1:TextInput_LWHazard1_2.Text,//存在的危害因素
                LWHazard2:TextInput_LWHazard2_2.Text,//可能导致的后果
                LWHazard3:TextInput_LWHazard3_2.Text//相应的管控措施
            });
            If(ReSubCol_DraftLW_EQ,
            RemoveIf(TPL_InfoGathering,ProjID=TextInput_ProjLeder_4.Text&&PhotoType="吊装设备信息");
            ForAll(Filter(Col_DraftLW_EQ,Equipments<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,//当前项目ID
                PhotoType:"吊装设备信息",
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Equipments
            })));
            If(ReSubCol_DraftLW_Commander,
            RemoveIf(TPL_InfoGathering,ProjID=TextInput_ProjLeder_4.Text&&PhotoType="吊装指挥人员信息");
            ForAll(Filter(Col_DraftLW_Commander,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,//当前项目ID
                PhotoType:"吊装指挥人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            })));
            If(ReSubCol_DraftLW_Worker,RemoveIf(TPL_InfoGathering,ProjID=TextInput_ProjLeder_4.Text&&PhotoType="吊装作业人员信息");
            ForAll(Filter(Col_DraftLW_Worker,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,//当前项目ID
                PhotoType:"吊装作业人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            })));
            
            
            ForAll(
                Gallery3_11.AllItems,
                Switch(ItemID,
                1,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)})
            ))
            /*;
            
            //判断是否上传吊装作业施工方案，若上传，则删除原有文件并上传新文件
            If(CountRows(DataCardValue_ConstructionSchemeLifting_1.Attachments)>0,RemoveIf('Licenses File',SearchID&"_CSLiftingWork_" in 'File name with extension');
            //吊装作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeLifting_1.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        name: SearchID&"_CSLiftingWork_"&ThisRecord.Name
                    }
                )
            )
            )
            */,
            Patch(TPL_LiftingWork,
            LookUp(TPL_LiftingWork,ProjID=SearchID),
            {
                ProjID:SearchID,//当前项目ID
                OpAr:TextInput_OpAr_2.Text,//作业地点
                OpCountent:TextInput_OpCountent_2.Text,//作业内容
                SuspendedObject:TextInput_SuspendedObject_2.Text,//被吊物
                SuspendedObjectWeight:Int(TextInput_SuspendedObjectWeight_2.Text),//被吊物重量
                LiftingCapacity:Int(TextInput_LiftingCapacity_2.Text),//起重能力
                OpUnit:TextInput_OpUnit_2.Text,//作业单位
                StartTime:DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),//结束时间
                OnSiteGuardian:TextInput_OpDirector_4.Text,//现场监护人
                LWHazard1:TextInput_LWHazard1_2.Text,//存在的危害因素
                LWHazard2:TextInput_LWHazard2_2.Text,//可能导致的后果
                LWHazard3:TextInput_LWHazard3_2.Text//相应的管控措施
            }));
            If(ReSubCol_DraftLW_EQ,
            RemoveIf(TPL_InfoGathering,ProjID=TextInput_ProjLeder_4.Text&&PhotoType="吊装设备信息");
            ForAll(Filter(Col_DraftLW_EQ,Equipments<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,//当前项目ID
                PhotoType:"吊装设备信息",
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Equipments
            })));
            If(ReSubCol_DraftLW_Commander,
            RemoveIf(TPL_InfoGathering,ProjID=TextInput_ProjLeder_4.Text&&PhotoType="吊装指挥人员信息");
            ForAll(Filter(Col_DraftLW_Commander,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,//当前项目ID
                PhotoType:"吊装指挥人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            })));
            If(ReSubCol_DraftLW_Worker,RemoveIf(TPL_InfoGathering,ProjID=TextInput_ProjLeder_4.Text&&PhotoType="吊装作业人员信息");
            ForAll(Filter(Col_DraftLW_Worker,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,//当前项目ID
                PhotoType:"吊装作业人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            })));
            
            
            ForAll(
                Gallery3_11.AllItems,
                Switch(ItemID,
                1,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_LiftingWork,LookUp(TPL_LiftingWork,ProjID=SearchID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_30.Selected.Value,"是",true,"不适用",false,false)})
            ))
            
            /*;
            
            //判断是否上传吊装作业施工方案，若上传，则删除原有文件并上传新文件
            If(CountRows(DataCardValue_ConstructionSchemeLifting_1.Attachments)>0,RemoveIf('Licenses File',SearchID&"_CSLiftingWork_" in 'File name with extension');
            //吊装作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeLifting_1.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        name: SearchID&"_CSLiftingWork_"&ThisRecord.Name
                    }
                )
            )
            )*/
            ,
            
            
            //上传 有限空间作业 表信息&有限空间作业 安全控制信息上传
            "Confined Space",
            If(IsBlank(LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID)),
            Patch(TPL_ConfinedSpaceWork,
            {
                ProjID:SearchID,//当前项目ID
                OpUnit:TextInput_OpUnit_2.Text,//作业单位
                Worker:TextInput_CSW_Worker_2.Text,//作业人员
                OpAr:TextInput_OpAr_2.Text,//作业地点
                OnSiteGuardian:TextInput_OpDirector_4.Text,//现场监护人
                StartTime:DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),//结束时间
                OpCountent:TextInput_OpCountent_2.Text,//作业内容
                CSWHazard1:TextInput_CSWHazard1_2.Text,//存在的危害因素
                CSWHazard2:TextInput_CSWHazard2_2.Text,//可能导致的后果
                CSWHazard3:TextInput_CSWHazard3_2.Text,//相应的管控措施
                GasDetectionTime:TextInput_Ventilation_1.Text//通风起止时间
            });
            
            ForAll(
                Gallery3_13.AllItems,
                Switch(ItemID,
                1,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)})
            ))
            /*;
            
            //判断是否上传有限空间作业施工方案，若上传，则删除原有文件并上传新文件
            If(CountRows(DataCardValue_ConstructionSchemeConfined_1.Attachments)>0,RemoveIf('Licenses File',SearchID&"_CSConfinedSpaceWork_" in 'File name with extension');
            //有限空间作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeConfined_1.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        name: SearchID&"_CSConfinedSpaceWork_"&ThisRecord.Name
                    }
                )
            ))*/
            ,
            Patch(TPL_ConfinedSpaceWork,
            LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),
            {
                ProjID:SearchID,//当前项目ID
                OpUnit:TextInput_OpUnit_2.Text,//作业单位
                Worker:TextInput_CSW_Worker_2.Text,//作业人员
                OpAr:TextInput_OpAr_2.Text,//作业地点
                OnSiteGuardian:TextInput_OpDirector_4.Text,//现场监护人
                StartTime:DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),//结束时间
                OpCountent:TextInput_OpCountent_2.Text,//作业内容
                CSWHazard1:TextInput_CSWHazard1_2.Text,//存在的危害因素
                CSWHazard2:TextInput_CSWHazard2_2.Text,//可能导致的后果
                CSWHazard3:TextInput_CSWHazard3_2.Text,//相应的管控措施
                GasDetectionTime:TextInput_Ventilation_1.Text//通风起止时间
            }));
            
            ForAll(
                Gallery3_13.AllItems,
                Switch(ItemID,
                1,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_ConfinedSpaceWork,LookUp(TPL_ConfinedSpaceWork,ProjID=SearchID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_32.Selected.Value,"是",true,"不适用",false,false)})
            ))
            /*;
            
            //判断是否上传有限空间作业施工方案，若上传，则删除原有文件并上传新文件
            If(CountRows(DataCardValue_ConstructionSchemeConfined_1.Attachments)>0,RemoveIf('Licenses File',SearchID&"_CSConfinedSpaceWork_" in 'File name with extension');
            //有限空间作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeConfined_1.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        name: SearchID&"_CSConfinedSpaceWork_"&ThisRecord.Name
                    }
                )
            ))*/
            ,
            
            //上传Hot表信息&Hot表人员信息证照上传&Hot安全控制信息上传
            "Hot",
            If(IsBlank(LookUp(TPL_HotWork,ProjID=SearchID)),
            Patch(TPL_HotWork,
            {
                ProjID:SearchID,//当前项目ID
                OpAr:TextInput_OpAr_2.Text,//作业地点
                OpUnit:TextInput_OpUnit_2.Text,//作业单位
                OnSiteGuardian:TextInput_OpDirector_4.Text,//现场监护人
                StartTime:DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),//结束时间
                OpCountent:TextInput_OpCountent_2.Text,//作业内容
                FWTools:TextInput_FWTools_2.Text,//动火作业工具
                FWHazard1:TextInput_FWHazard1_2.Text,//存在的危害因素
                FWHazard2:TextInput_FWHazard2_2.Text,//可能导致的后果
                FWHazard3:TextInput_FWHazard3_3.Text,//相应的管控措施
                FWLevel:Radio_FWLevel_2.SelectedText.Value,//动火作业级别
                FireHose:Int(TextInput_FWHazard1_10.Text),//消防水带数量
                FireExtinguisher:Int(TextInput_FWHazard1_11.Text),//灭火器数量
                FireBlanket:Int(TextInput_FWHazard1_12.Text),//防火毯数量
                FireOther:TextInput_FWOtherTool_2.Text, //其他防火器材名字
                FireOtherNumber:Int(TextInput_FWOtherToolNumber_2.Text) //其他防火器材数量
            });
            
            If(ReSubCol_DraftFW,RemoveIf(TPL_InfoGathering,ProjID=TextInput_ProjLeder_4.Text&&PhotoType="动火作业人员信息");
            ForAll(Filter(Col_DraftFW,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,//当前项目ID
                PhotoType:"动火作业人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            })));
            
            ForAll(
                Gallery3_12.AllItems,
                Switch(ItemID,
                1,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)})
            ))/*
            ;
            
            //判断是否上传有限空间作业施工方案，若上传，则删除原有文件并上传新文件
            If(CountRows(DataCardValue_ConstructionSchemeHot_1.Attachments)>0,RemoveIf('Licenses File',SearchID&"_CSHotWork_" in 'File name with extension');
            //动火作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeHot_1.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        name: SearchID&"_CSHotWork_"&ThisRecord.Name
                    }
                )
            ))*/
            
            
            ,
            Patch(TPL_HotWork,
            LookUp(TPL_HotWork,ProjID=SearchID),
            {
                ProjID:SearchID,//当前项目ID
                OpAr:TextInput_OpAr_2.Text,//作业地点
                OpUnit:TextInput_OpUnit_2.Text,//作业单位
                OnSiteGuardian:TextInput_OpDirector_4.Text,//现场监护人
                StartTime:DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),//结束时间
                OpCountent:TextInput_OpCountent_2.Text,//作业内容
                FWTools:TextInput_FWTools_2.Text,//动火作业工具
                FWHazard1:TextInput_FWHazard1_2.Text,//存在的危害因素
                FWHazard2:TextInput_FWHazard2_2.Text,//可能导致的后果
                FWHazard3:TextInput_FWHazard3_3.Text,//相应的管控措施
                FWLevel:Radio_FWLevel_2.SelectedText.Value,//动火作业级别
                FireHose:Int(TextInput_FWHazard1_10.Text),//消防水带数量
                FireExtinguisher:Int(TextInput_FWHazard1_11.Text),//灭火器数量
                FireBlanket:Int(TextInput_FWHazard1_12.Text),//防火毯数量
                FireOther:TextInput_FWOtherTool_2.Text, //其他防火器材名字
                FireOtherNumber:Int(TextInput_FWOtherToolNumber_2.Text) //其他防火器材数量
            }));
            
            If(ReSubCol_DraftFW,RemoveIf(TPL_InfoGathering,ProjID=TextInput_ProjLeder_4.Text&&PhotoType="动火作业人员信息");
            ForAll(Filter(Col_DraftFW,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,//当前项目ID
                PhotoType:"动火作业人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            })));
            
            ForAll(
                Gallery3_12.AllItems,
                Switch(ItemID,
                1,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_HotWork,LookUp(TPL_HotWork,ProjID=SearchID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_31.Selected.Value,"是",true,"不适用",false,false)})
            ))/*
            ;
            
            //判断是否上传有限空间作业施工方案，若上传，则删除原有文件并上传新文件
            If(CountRows(DataCardValue_ConstructionSchemeHot_1.Attachments)>0,RemoveIf('Licenses File',SearchID&"_CSHotWork_" in 'File name with extension');
            //动火作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeHot_1.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        name: SearchID&"_CSHotWork_"&ThisRecord.Name
                    }
                )
            ))*/
            ,
            
            //上传临时用电表信息&临时用电表人员信息证照上传&临时用电安全控制信息上传
            "Temporary Electricity",
            If(IsBlank(LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID)),
            Patch(TPL_TemporaryElectricityUseWork,
            {
                ProjID:SearchID,//当前项目ID
                OpAr:TextInput_OpAr_2.Text,//作业地点
                OpUnit:TextInput_OpUnit_2.Text,//作业单位
                OnSiteGuardian:TextInput_OpDirector_4.Text,//现场监护人
                OpCountent:TextInput_OpCountent_2.Text,//作业内容
                TotalLoad:TextInput_TotalLoad_2.Text,//用电设备总负荷
                WorkingVoltage:TextInput_WorkingVoltage_2.Text,//工作电压
                PowerAccessPoint:TextInput_PowerAccessPoint_2.Text,//电源接入点
                StartTime:DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),//结束时间
                TEUHazard1:TextInput_TEUHazard1_2.Text,//存在的危害因素
                TEUHazard2:TextInput_TEUHazard2_2.Text,//可能导致的后果
                TEUHazard3:TextInput_TEUHazard3_2.Text//相应的管控措施
            });
            
            If(ReSubCol_DraftTEU,RemoveIf(TPL_InfoGathering,ProjID=TextInput_ProjLeder_4.Text&&PhotoType="临时用电人员信息");
            ForAll(Filter(Col_DraftTEU,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,//当前项目ID
                PhotoType:"临时用电人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            })));
            
            ForAll(
                Gallery3_9.AllItems,
                Switch(ItemID,
                1,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)})
            ))
            /*
            ;
            
            //判断是否上传临时用电作业施工方案，若上传，则删除原有文件并上传新文件
            If(CountRows(DataCardValue_ConstructionSchemeTemporaryElectricity_1.Attachments)>0,
            RemoveIf('Licenses File',SearchID&"_CSTemporaryElectricityWork_" in 'File name with extension');
            //临时用电作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeTemporaryElectricity_1.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        name: SearchID&"_CSTemporaryElectricityWork_"&ThisRecord.Name
                    }
                )
            ))*/
            ,
            Patch(TPL_TemporaryElectricityUseWork,
            LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),
            {
                ProjID:SearchID,//当前项目ID
                OpAr:TextInput_OpAr_2.Text,//作业地点
                OpUnit:TextInput_OpUnit_2.Text,//作业单位
                OnSiteGuardian:TextInput_OpDirector_4.Text,//现场监护人
                OpCountent:TextInput_OpCountent_2.Text,//作业内容
                TotalLoad:TextInput_TotalLoad_2.Text,//用电设备总负荷
                WorkingVoltage:TextInput_WorkingVoltage_2.Text,//工作电压
                PowerAccessPoint:TextInput_PowerAccessPoint_2.Text,//电源接入点
                StartTime:DateValue(DatePicker_StartDate_1.SelectedDate)+Time(Int(Dropdown_StartTime_3.Selected.Value),Int(Dropdown_StartTime_2.Selected.Value),0),//开始时间
                EndTime:DateValue(DatePicker_EndDate_1.SelectedDate)+Time(Int(Dropdown_EndTime_3.Selected.Value),Int(Dropdown_EndTime_2.Selected.Value),0),//结束时间
                TEUHazard1:TextInput_TEUHazard1_2.Text,//存在的危害因素
                TEUHazard2:TextInput_TEUHazard2_2.Text,//可能导致的后果
                TEUHazard3:TextInput_TEUHazard3_2.Text//相应的管控措施
            }));
            
            If(ReSubCol_DraftTEU,RemoveIf(TPL_InfoGathering,ProjID=TextInput_ProjLeder_4.Text&&PhotoType="临时用电人员信息");
            ForAll(Filter(Col_DraftTEU,Name<>""),Patch(TPL_InfoGathering,
            {
                ProjID:SearchID,//当前项目ID
                PhotoType:"临时用电人员信息",
                Photograph:ThisRecord.Photo,
                Identifier:ThisRecord.ID,
                Name:ThisRecord.Name
            })));
            
            ForAll(
                Gallery3_9.AllItems,
                Switch(ItemID,
                1,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control1:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                2,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control2:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                3,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control3:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                4,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control4:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                5,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control5:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                6,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control6:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                7,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control7:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                8,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control8:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                9,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control9:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                10,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control10:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                11,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control11:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                12,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control12:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                13,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control13:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                14,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control14:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)}),
                15,Patch(TPL_TemporaryElectricityUseWork,LookUp(TPL_TemporaryElectricityUseWork,ProjID=SearchID),{Control15:Switch(ThisRecord.Radio_PatrolTnspection_28.Selected.Value,"是",true,"不适用",false,false)})
            ))
            /*
            ;
            
            //判断是否上传临时用电作业施工方案，若上传，则删除原有文件并上传新文件
            If(CountRows(DataCardValue_ConstructionSchemeTemporaryElectricity_1.Attachments)>0,
            RemoveIf('Licenses File',SearchID&"_CSTemporaryElectricityWork_" in 'File name with extension');
            //临时用电作业施工方案上传
            ForAll(
                DataCardValue_ConstructionSchemeTemporaryElectricity_1.Attachments,
                TPL_UpLoadFile2.Run(
                    {
                        contentBytes: ThisRecord.Value,
                        name: SearchID&"_CSTemporaryElectricityWork_"&ThisRecord.Name
                    }
                )
            ))
            */
            ));
            
            
            
            
            //创建一条新的申请界面
            Notify("已存草稿", NotificationType.Success);
            
            
            ClearCollect(Gal_Ispatch,{Value:true});
            Refresh(TPL_NormalLicence);
            Refresh(TPL_HighWork);
            Refresh(TPL_HotWork);
            Refresh(TPL_LiftingWork);
            Refresh(TPL_ConfinedSpaceWork);
            Refresh(TPL_TemporaryElectricityUseWork);
            Refresh(TPL_ConfinedSpaceWork);
            Refresh(TPL_InfoGathering);
            Refresh(TPL_Login);
            Refresh('Licenses File');
            
            
            ClearCollect(List_Login,TPL_Login);
            Set(SearchID,Gal_SearchDraft.Selected.ProjID);//设置搜索ID
            ClearCollect(Current_Normal,Filter(TPL_NormalLicence,ProjID=SearchID));
            ClearCollect(Current_High,Filter(TPL_HighWork,ProjID=SearchID));
            ClearCollect(Current_Lifting,Filter(TPL_LiftingWork,ProjID=SearchID));
            ClearCollect(Current_ConfinedSpace,Filter(TPL_ConfinedSpaceWork,ProjID=SearchID));
            ClearCollect(Current_Hot,Filter(TPL_HotWork,ProjID=SearchID));
            ClearCollect(Current_TemporaryElectricity,Filter(TPL_TemporaryElectricityUseWork,ProjID=SearchID));
            Navigate(home))
        RadiusBottomLeft: =2
        RadiusBottomRight: =2
        RadiusTopLeft: =2
        RadiusTopRight: =2
        Size: =12
        Text: ="保存草稿"
        Visible: =Vis_Sub
        Width: =102
        X: =427
        Y: =1069
        ZIndex: =11

