Approve As screen:
    Height: =//Max(App.Height, App.MinScreenHeight)
    OnVisible: |+
        =//获取选择的施工单的各类许可证的信息
        Refresh('Licenses PDF');
        Refresh(TPL_Patrol);
        ClearCollect(Current_Normal,Filter(TPL_NormalLicence,ProjID=SearchID));
        ClearCollect(Current_High,Filter(TPL_HighWork,ProjID=SearchID));
        ClearCollect(Current_Lifting,Filter(TPL_LiftingWork,ProjID=SearchID));
        ClearCollect(Current_ConfinedSpace,Filter(TPL_ConfinedSpaceWork,ProjID=SearchID));
        ClearCollect(Current_Hot,Filter(TPL_HotWork,ProjID=SearchID));
        ClearCollect(Current_TemporaryElectricity,Filter(TPL_TemporaryElectricityUseWork,ProjID=SearchID));
        //ClearCollect(Gal_NormalPatrol,Filter(TPL_Patrol,ProjID=SearchID,LicenceType="Normal"));
        ClearCollect(GasDetection2,Collect(GasDetection2,{Sampler:"",SampleT:"",SampleP:"",OxyContent:"",CombustibleGas:"",CarbonMonoxide:"",HydrogenSulfide:""}));
        
        
        Set(PdfContent,Blank());
        Set(PdfContent1,Blank());
        Set(PdfContent2,Blank());
        Set(PdfContent3,Blank());
        Set(PdfContent4,Blank());
        Set(PdfContent5,Blank());
        
        //Gal_NormalPatrol
        /*ClearCollect(Temp_AA,Split(First(Current_Normal).OtherDept,";"));
        ClearCollect(Temp_BB,Split(First(Current_Normal).OtherDeptView,";"));
        ClearCollect(Temp_CC,Split(First(Current_Normal).OtherDept,";"),Split(First(Current_Normal).OtherDeptView,";"));
        ClearCollect(Gal_OtherDeptMsg,Blank());
        ForAll(Temp_AA,Collect(Gal_OtherDeptMsg,{Dept:Index(Temp_CC,CountRows(Gal_OtherDeptMsg)+1).Value,
            View:Index(Temp_CC,CountRows(Gal_OtherDeptMsg)+1+CountRows(Temp_AA)).Value}));*/
        
        
        //刷新会签部门信息
        ClearCollect(Current_Normal,Filter(TPL_NormalLicence,ProjID=SearchID));
        ClearCollect(OtherDeptMsg
        ,{Dept:"生产",View:First(Current_Normal).OtherProduce,isMine:If("生产" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"生产" in Hod)).HodBackup}
        ,{Dept:"印前",View:First(Current_Normal).OtherPrepress,isMine:If("印前" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"印前" in Hod)).HodBackup}
        ,{Dept:"印刷",View:First(Current_Normal).OtherPrint,isMine:If("印刷" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"印刷" in Hod)).HodBackup}
        ,{Dept:"复合",View:First(Current_Normal).OtherComposite,isMine:If("复合" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"复合" in Hod)).HodBackup}
        ,{Dept:"分切",View:First(Current_Normal).OtherCutting,isMine:If("分切" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"分切" in Hod)).HodBackup}
        ,{Dept:"维修",View:First(Current_Normal).OtherMaintenance,isMine:If("维修" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"维修" in Hod)).HodBackup}
        ,{Dept:"仓库",View:First(Current_Normal).OtherWarehouse,isMine:If("仓库" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"仓库" in Hod)).HodBackup}
        ,{Dept:"质量",View:First(Current_Normal).OtherQuality,isMine:If("质量" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"质量" in Hod)).HodBackup}
        ,{Dept:"WCM",View:First(Current_Normal).OtherWCM,isMine:If("WCM" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"WCM" in Hod)).HodBackup}
        ,{Dept:"CBRE",View:First(Current_Normal).OtherCBRE,isMine:If("CBRE" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"CBRE" in Hod)).HodBackup});
        
        
        
        //区域负责人审批表
        ClearCollect(HoaApprovalMsg
        ,{Dept:"生产",View:Switch(First(Current_Normal).HoaProduce,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("生产" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"生产" in Hoa)).HoaBackup}
        ,{Dept:"印前",View:Switch(First(Current_Normal).HoaPrepress,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("印前" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"印前" in Hoa)).HoaBackup}
        ,{Dept:"印刷",View:Switch(First(Current_Normal).HoaPrint,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("印刷" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"印刷" in Hoa)).HoaBackup}
        ,{Dept:"复合",View:Switch(First(Current_Normal).HoaComposite,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("复合" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"复合" in Hoa)).HoaBackup}
        ,{Dept:"分切",View:Switch(First(Current_Normal).HoaCutting,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("分切" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"分切" in Hoa)).HoaBackup}
        ,{Dept:"维修",View:Switch(First(Current_Normal).HoaMaintenance,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("维修" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"维修" in Hoa)).HoaBackup}
        ,{Dept:"仓库",View:Switch(First(Current_Normal).HoaWarehouse,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("仓库" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"仓库" in Hoa)).HoaBackup}
        ,{Dept:"质量",View:Switch(First(Current_Normal).HoaQuality,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("质量" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"质量" in Hoa)).HoaBackup}
        ,{Dept:"WCM",View:Switch(First(Current_Normal).HoaWCM,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("WCM" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"WCM" in Hoa)).HoaBackup}
        ,{Dept:"EHS",View:Switch(First(Current_Normal).HoaEHS,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("EHS" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"EHS" in Hoa)).HoaBackup}
        ,{Dept:"CBRE",View:Switch(First(Current_Normal).HoaCBRE,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("CBRE" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"CBRE" in Hoa)).HoaBackup});
        
        
        Set(Vis_AgreeConfirm,false);
        Set(Vis_RefuseReason,false);
        
        
        ClearCollect(
            Licences, 
            {LicenceN: "Normal", State: true },
            {LicenceN: "High", State: Not(IsEmpty(Search(Current_Normal,"High","OtherLicenses")))},
            {LicenceN: "Lifting", State: Not(IsEmpty(Search(Current_Normal,"Lifting","OtherLicenses"))) },
            {LicenceN: "Confined Space", State: Not(IsEmpty(Search(Current_Normal,"Confined Space","OtherLicenses")))},
            {LicenceN: "Hot", State: Not(IsEmpty(Search(Current_Normal,"Hot","OtherLicenses")))},
            {LicenceN: "Temporary Electricity", State: Not(IsEmpty(Search(Current_Normal,"Temporary Electricity","OtherLicenses")))}
        );
        
        
        ClearCollect(Gal_HeightsPersMsg,{Name:"",ID:""});
        ClearCollect(Gal_HighSafetyControl,AddColumns(Sort(Filter(TPL_SafetyControl,!(IsBlank(Content))&&LicenseType="High Work Permit"),ID,SortOrder.Ascending),"Confirm",false));
        
        
        
        /*
        ClearCollect(aaaaaaaaa,RenameColumns(Split(First(Current_Normal).OtherDept,";"),"Value","Dept"),ForAll(Split(First(Current_Normal).OtherDeptView,";"),ThisRecord));
        
        Set(Vis_New,true);
        Set(Vis_Del,true);
        Set(Vis_Sub,true);
        Set(Vis_PDF,false);
        Set(Vis_Current,"Normal");
        Set(Vis_Camera,false);
        
        ClearCollect(Temp_AA,Split(First(Current_Normal).OtherDept,";"));
        ClearCollect(Temp_BB,Split(First(Current_Normal).OtherDeptView,";"));
        ClearCollect(Temp_CC,Split(First(Current_Normal).OtherDept,";"),Split(First(Current_Normal).OtherDeptView,";"));
        ClearCollect(Gal_OtherDeptMsg,Blank());
        ForAll(Temp_AA,Collect(Gal_OtherDeptMsg,{Dept:Index(Temp_CC,CountRows(Gal_OtherDeptMsg)+1).Value,
            View:Index(Temp_CC,CountRows(Gal_OtherDeptMsg)+1+CountRows(Temp_AA)).Value}));
        
        */
        
        
        
        
        
        
        
            
        //读取作业安全控制条例
        ClearCollect(Gal_HighWorkSafetyControl,AddColumns(Sort(Filter(TPL_SafetyControl,LicenseType="High Work Permit"),ID,SortOrder.Ascending),"Confirm",false));
        ClearCollect(Gal_ConfinedSpaceSafetyControl,AddColumns(Sort(Filter(TPL_SafetyControl,LicenseType="Confined Space Work Permit"),ID,SortOrder.Ascending),"Confirm",false));
        ClearCollect(Gal_LiftingWorkControl,AddColumns(Sort(Filter(TPL_SafetyControl,LicenseType="Lifting Work Permit"),ID,SortOrder.Ascending),"Confirm",false));
        ClearCollect(Gal_HotWorkSafetyControl,AddColumns(Sort(Filter(TPL_SafetyControl,LicenseType="Hot Work"),ID,SortOrder.Ascending),"Confirm",false));
        ClearCollect(Gal_TemporaryElectricityUseWorkSafetyControl,AddColumns(Sort(Filter(TPL_SafetyControl,LicenseType="Temporary Electricity Use Work Permit"),ID,SortOrder.Ascending),"Confirm",false));
        
        
        
        
        
        //高处作业
        ClearCollect(Gal_HighWorkSafetyControl2,Gal_HighWorkSafetyControl);
        ForAll(Gal_HighWorkSafetyControl,Switch(ItemID,
        1,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=1),{Confirm:First(Current_High).Control1}),2,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=2),{Confirm:First(Current_High).Control2}),3,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=3),{Confirm:First(Current_High).Control3}),4,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=4),{Confirm:First(Current_High).Control4}),5,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=5),{Confirm:First(Current_High).Control5}),6,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=6),{Confirm:First(Current_High).Control6}),7,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=7),{Confirm:First(Current_High).Control7}),8,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=8),{Confirm:First(Current_High).Control8}),9,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=9),{Confirm:First(Current_High).Control9}),10,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=10),{Confirm:First(Current_High).Control10}),11,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=11),{Confirm:First(Current_High).Control11}),12,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=12),{Confirm:First(Current_High).Control12}),
        13,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=13),{Confirm:First(Current_High).Control13}),14,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=14),{Confirm:First(Current_High).Control14}),15,Patch(Gal_HighWorkSafetyControl2,LookUp(Gal_HighWorkSafetyControl2,ItemID=15),{Confirm:First(Current_High).Control15})
        ));
        
        //有限空间
        ClearCollect(Gal_ConfinedSpaceSafetyControl2,Gal_ConfinedSpaceSafetyControl);
        ForAll(Gal_ConfinedSpaceSafetyControl,Switch(ItemID,
        1,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=1),{Confirm:First(Current_ConfinedSpace).Control1}),2,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=2),{Confirm:First(Current_ConfinedSpace).Control2}),3,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=3),{Confirm:First(Current_ConfinedSpace).Control3}),4,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=4),{Confirm:First(Current_ConfinedSpace).Control4}),5,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=5),{Confirm:First(Current_ConfinedSpace).Control5}),6,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=6),{Confirm:First(Current_ConfinedSpace).Control6}),7,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=7),{Confirm:First(Current_ConfinedSpace).Control7}),8,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=8),{Confirm:First(Current_ConfinedSpace).Control8}),9,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=9),{Confirm:First(Current_ConfinedSpace).Control9}),10,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=10),{Confirm:First(Current_ConfinedSpace).Control10}),11,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=11),{Confirm:First(Current_ConfinedSpace).Control11}),12,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=12),{Confirm:First(Current_ConfinedSpace).Control12}),
        13,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=13),{Confirm:First(Current_ConfinedSpace).Control13}),14,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=14),{Confirm:First(Current_ConfinedSpace).Control14}),15,Patch(Gal_ConfinedSpaceSafetyControl2,LookUp(Gal_ConfinedSpaceSafetyControl2,ItemID=15),{Confirm:First(Current_ConfinedSpace).Control15})
        ));
        
        //吊装作业
        ClearCollect(Gal_LiftingWorkControl2,Gal_LiftingWorkControl);
        ForAll(Gal_LiftingWorkControl,Switch(ItemID,
        1,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=1),{Confirm:First(Current_Lifting).Control1}),2,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=2),{Confirm:First(Current_Lifting).Control2}),3,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=3),{Confirm:First(Current_Lifting).Control3}),4,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=4),{Confirm:First(Current_Lifting).Control4}),5,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=5),{Confirm:First(Current_Lifting).Control5}),6,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=6),{Confirm:First(Current_Lifting).Control6}),7,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=7),{Confirm:First(Current_Lifting).Control7}),8,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=8),{Confirm:First(Current_Lifting).Control8}),9,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=9),{Confirm:First(Current_Lifting).Control9}),10,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=10),{Confirm:First(Current_Lifting).Control10}),11,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=11),{Confirm:First(Current_Lifting).Control11}),12,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=12),{Confirm:First(Current_Lifting).Control12}),
        13,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=13),{Confirm:First(Current_Lifting).Control13}),14,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=14),{Confirm:First(Current_Lifting).Control14}),15,Patch(Gal_LiftingWorkControl2,LookUp(Gal_LiftingWorkControl2,ItemID=15),{Confirm:First(Current_Lifting).Control15})
        ));
        
        //动火作业
        ClearCollect(Gal_HotWorkSafetyControl2,Gal_HotWorkSafetyControl);
        ForAll(Gal_HotWorkSafetyControl,Switch(ItemID,
        1,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=1),{Confirm:First(Current_Hot).Control1}),2,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=2),{Confirm:First(Current_Hot).Control2}),3,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=3),{Confirm:First(Current_Hot).Control3}),4,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=4),{Confirm:First(Current_Hot).Control4}),5,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=5),{Confirm:First(Current_Hot).Control5}),6,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=6),{Confirm:First(Current_Hot).Control6}),7,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=7),{Confirm:First(Current_Hot).Control7}),8,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=8),{Confirm:First(Current_Hot).Control8}),9,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=9),{Confirm:First(Current_Hot).Control9}),10,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=10),{Confirm:First(Current_Hot).Control10}),11,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=11),{Confirm:First(Current_Hot).Control11}),12,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=12),{Confirm:First(Current_Hot).Control12}),
        13,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=13),{Confirm:First(Current_Hot).Control13}),14,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=14),{Confirm:First(Current_Hot).Control14}),15,Patch(Gal_HotWorkSafetyControl2,LookUp(Gal_HotWorkSafetyControl2,ItemID=15),{Confirm:First(Current_Hot).Control15})
        ));
        
        //临时用电
        ClearCollect(Gal_TemporaryElectricityUseWorkSafetyControl2,Gal_TemporaryElectricityUseWorkSafetyControl);
        ForAll(Gal_TemporaryElectricityUseWorkSafetyControl,Switch(ItemID,
        1,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=1),{Confirm:First(Current_TemporaryElectricity).Control1}),2,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=2),{Confirm:First(Current_TemporaryElectricity).Control2}),3,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=3),{Confirm:First(Current_TemporaryElectricity).Control3}),4,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=4),{Confirm:First(Current_TemporaryElectricity).Control4}),5,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=5),{Confirm:First(Current_TemporaryElectricity).Control5}),6,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=6),{Confirm:First(Current_TemporaryElectricity).Control6}),7,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=7),{Confirm:First(Current_TemporaryElectricity).Control7}),8,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=8),{Confirm:First(Current_TemporaryElectricity).Control8}),9,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=9),{Confirm:First(Current_TemporaryElectricity).Control9}),10,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=10),{Confirm:First(Current_TemporaryElectricity).Control10}),11,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=11),{Confirm:First(Current_TemporaryElectricity).Control11}),12,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=12),{Confirm:First(Current_TemporaryElectricity).Control12}),
        13,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=13),{Confirm:First(Current_TemporaryElectricity).Control13}),14,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=14),{Confirm:First(Current_TemporaryElectricity).Control14}),15,Patch(Gal_TemporaryElectricityUseWorkSafetyControl2,LookUp(Gal_TemporaryElectricityUseWorkSafetyControl2,ItemID=15),{Confirm:First(Current_TemporaryElectricity).Control15})
        ));
        Select(Menu_Licence_1,1);
        
        

    "Menu_Licence_1 As gallery.'BrowseLayout_Horizontal_TwoTextOneImageVariant_ver5.0'":
        DelayItemLoading: =true
        Height: =46
        Items: =Filter(Licences,State=true)
        LoadingSpinner: =LoadingSpinner.Data
        OnSelect: =Set(Vis_Current,ThisItem.LicenceN)
        ShowNavigation: =true
        ShowScrollbar: =false
        TemplateFill: =If(ThisItem.IsSelected,RGBA(0, 0, 0, 0),Color.AliceBlue)
        TemplatePadding: =0
        TemplateSize: =104.6
        Width: =630
        X: =4
        ZIndex: =1

        Label4_2 As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Bold
            Height: =45
            OnSelect: =Select(Parent)
            Size: =12
            Text: =ThisItem.LicenceN
            Width: =104.6
            ZIndex: =4

    Btn_ApproverRefuse As button:
        BorderThickness: =1
        DisplayMode: =
        Fill: =RGBA(151, 0, 0, 1)
        FocusedBorderThickness: =1
        FontWeight: =FontWeight.Normal
        Height: =28
        OnSelect: =Set(Vis_ApproveWhich,"Refuse")
        RadiusBottomLeft: =2
        RadiusBottomRight: =2
        RadiusTopLeft: =2
        RadiusTopRight: =2
        Size: =12
        Text: ="拒绝"
        Visible: =Switch(Personal_Identity,"ApplDeptLeader",true,"OpADeptLeader",false,"OtherDeptLeader",false,"EHSLeader",true,"FactoryDirector",true,false)
        Width: =102
        X: =5
        Y: =1069
        ZIndex: =2

    Container_TemporaryElectricityNew_4 As groupContainer.verticalAutoLayoutContainer:
        Height: =990
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        Visible: =If(Vis_Current="Temporary Electricity",true,false)
        Width: =630
        X: =5
        Y: =46
        ZIndex: =3

        Container_TemporaryElectricityNew_Title_1 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =110
            LayoutMinHeight: =70
            LayoutMinWidth: =250
            Width: =630
            X: =5
            Y: =107
            ZIndex: =1

            Image3_9 As image:
                Height: =80
                Image: ='1694500910899'
                Width: =97
                ZIndex: =1

            Label3_26 As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =70
                Size: =21
                Text: |-
                    ="Temporary Electricity Use Work Permit
                    临时用电作业许可证"
                Width: =560
                X: =36
                Y: =7
                ZIndex: =2

            Label3_27 As label:
                Align: =Align.Center
                Color: =RGBA(184, 0, 0, 1)
                FontWeight: =FontWeight.Semibold
                Height: =33
                Size: =10.5
                Text: ="定义：除按标准成套配置的，有插头、连线、插座等专用接线装置以外的，所有其他用于临时性用电的电缆、电线、电气开关、设备等，简称临时用电 【使用时间超过1个月的，不能申请临时用电】"
                Width: =630
                Y: =77
                ZIndex: =3

        Container_TemporaryElectricityNew_5 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =50
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =630
            X: =5
            Y: =107
            ZIndex: =2

            Label1_438 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="作业地点:"
                VerticalAlign: =VerticalAlign.Top
                Width: =80
                ZIndex: =70

            TextInput_OpAr5_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_TemporaryElectricity).OpAr
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =279
                X: =80
                ZIndex: =71

            Label1_437 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="作业单位:"
                Width: =80
                Y: =25
                ZIndex: =72

            TextInput_OpUnit5_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_TemporaryElectricity).OpUnit
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =535
                X: =80
                Y: =25
                ZIndex: =73

        Container_TemporaryElectricityNew_6 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label2_33.Height+Gallery5_16.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =3

            "Gallery5_16 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =If(Self.AllItemsCount=0,1,Self.AllItemsCount)*30
                Items: =Filter(TPL_InfoGathering,ProjID=Text(SearchID),PhotoType="临时用电人员信息")
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =30
                Width: =630
                Y: =31
                ZIndex: =1

                TextInput_TEU_Worker_1 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.Name
                    DisplayMode: =DisplayMode.View
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =149
                    X: =4
                    ZIndex: =7

                TextInput_TEU_ID_1 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.Identifier
                    DisplayMode: =DisplayMode.View
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =295
                    X: =334
                    ZIndex: =8

                Image_Photo_15 As image:
                    Height: =30
                    Image: =ThisItem.Photograph
                    OnSelect: |-
                        =Set(ShowPhoto,ThisItem.Photograph.Full);
                        Set(WhereBack,"Approve");
                        Navigate(PhotoGraph);
                    Width: =220
                    X: =138
                    ZIndex: =9

            Label2_29 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="作业人员"
                Width: =155
                ZIndex: =2

            Label2_33 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证书号"
                Width: =302
                X: =328
                ZIndex: =3

            Label2_92 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件照片"
                Width: =173
                X: =155
                ZIndex: =4

        Container_TemporaryElectricityNew_7 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =255
            LayoutMinHeight: =60
            LayoutMinWidth: =250
            Width: =Parent.Width
            X: =40
            ZIndex: =4

            Label1_439 As label:
                DisplayMode: =DisplayMode.View
                Height: =25
                Size: =12
                Text: |-
                    ="现场监护人:"
                Width: =99
                X: =1
                Y: =2
                ZIndex: =28

            TextInput_OnSiteGuardian5_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_TemporaryElectricity).OnSiteGuardian
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =217
                X: =100
                Y: =2
                ZIndex: =29

            Label1_441 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="作业内容:"
                Width: =100
                Y: =29
                ZIndex: =32

            Label1_442 As label:
                Height: =24
                Size: =12
                Text: |-
                    ="用电设备总负荷:"
                Width: =135
                Y: =78
                ZIndex: =34

            TextInput_TotalLoad_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |
                    =First(Current_TemporaryElectricity).TotalLoad
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =174
                X: =126
                Y: =77
                ZIndex: =35

            Label1_443 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="工作电压:"
                Width: =80
                X: =315
                Y: =77
                ZIndex: =36

            TextInput_WorkingVoltage_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |
                    =First(Current_TemporaryElectricity).WorkingVoltage
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =215
                X: =395
                Y: =77
                ZIndex: =37

            Label1_444 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="电源接入点:"
                Width: =100
                Y: =102
                ZIndex: =38

            TextInput_PowerAccessPoint_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |
                    =First(Current_TemporaryElectricity).PowerAccessPoint
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =528
                X: =100
                Y: =102
                ZIndex: =43

            Label1_447 As label:
                Height: =25
                Size: =12
                Text: ="危害辨识"
                Width: =81
                Y: =151
                ZIndex: =44

            TextInput_TEUHazard1_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_TemporaryElectricity).TEUHazard1
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =449
                X: =161
                Y: =176
                ZIndex: =45

            Label1_448 As label:
                DisplayMode: =DisplayMode.View
                Height: =25
                Size: =12
                Text: |-
                    ="1）存在的危害因素:"
                Width: =160
                Y: =176
                ZIndex: =46

            Label1_449 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="2）可能导致的后果:"
                Width: =160
                X: =1
                Y: =200
                ZIndex: =47

            Label1_450 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="3）相应的管控措施:"
                Width: =160
                X: =1
                Y: =225
                ZIndex: =48

            TextInput_TEUHazard2_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_TemporaryElectricity).TEUHazard2
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =449
                X: =161
                Y: =200
                ZIndex: =49

            TextInput_TEUHazard3_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_TemporaryElectricity).TEUHazard3
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =449
                X: =161
                Y: =225
                ZIndex: =50

            TextInput_OpCountent5_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |
                    =First(Current_TemporaryElectricity).OpCountent
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                MaxLength: =65
                Mode: =TextMode.MultiLine
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =547
                X: =80
                Y: =27
                ZIndex: =51

            Label1_446 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="开始时间:"
                Width: =Len(Self.Text)*20
                Y: =128
                ZIndex: =52

            Label1_445 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="结束时间:"
                Width: =80
                X: =315
                Y: =128
                ZIndex: =53

            TextInput_OpCountent3_14 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |
                    =Text(First(Current_TemporaryElectricity).StartTime,"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =26
                MaxLength: =35
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =235
                X: =80
                Y: =127
                ZIndex: =54

            TextInput_OpCountent3_15 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Text(First(Current_TemporaryElectricity).EndTime,"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                MaxLength: =35
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =232
                X: =387
                Y: =128
                ZIndex: =55

        Container_High_SC_2 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label1_623.Height+Label1_622.Height+Gallery84.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =5

            Label1_623 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="项目负责人确认:"
                Width: =138
                Y: =Gallery84.Y+Gallery84.Height
                ZIndex: =1

            TextInput1_132 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).ProjLeader
                DisplayMode: =DisplayMode.View
                Height: =25
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =461
                X: =138
                Y: =Gallery84.Y+Gallery84.Height
                ZIndex: =2

            "Gallery84 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                Default: =First(Self.AllItems)
                DisplayMode: =DisplayMode.View
                Height: =Sum(Int(ShowColumns(Self.AllItems,"Label_height_10")),Value)+Self.AllItemsCount*1.5
                Items: =Filter(Gal_TemporaryElectricityUseWorkSafetyControl2,Not(IsBlank(Content)))
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                Selectable: =false
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =Int(Label_height_10.Text)
                Width: =Parent.Width
                Y: =Label1_622.Height
                ZIndex: =3

                Label_height_10 As label:
                    DisplayMode: =DisplayMode.View
                    Height: =1
                    OnSelect: =Select(Parent)
                    Size: =20
                    Text: =Label19_1.Height
                    Visible: =false
                    Width: =100
                    X: =40
                    ZIndex: =1

                Radio_PatrolTnspection_27 As radio:
                    BorderColor: =
                    Default: =Switch(ThisItem.Confirm,true,"是",false,"不适用")
                    DisplayMode: =DisplayMode.View
                    FocusedBorderColor: =
                    FocusedBorderThickness: =0
                    Height: =26
                    HoverColor: =
                    Items: =["是","不适用"]
                    Layout: =Layout.Horizontal
                    PaddingBottom: =0
                    PaddingTop: =0
                    PressedColor: =
                    RadioBorderColor: =RGBA(0, 13, 75, 1)
                    RadioSelectionFill: =RGBA(26, 26, 26, 1)
                    RadioSize: =15
                    Size: =12
                    Width: =155
                    Y: =6
                    ZIndex: =2

                Label19_1 As label:
                    AutoHeight: =true
                    Height: =
                    Size: =12
                    Text: =ThisItem.Content
                    VerticalAlign: =VerticalAlign.Top
                    Width: =460
                    X: =155
                    ZIndex: =4

            Label1_622 As label:
                FontWeight: =FontWeight.Bold
                Height: =25
                Size: =12
                Text: ="现场安全控制措施：项目负责人应同现场负责人对以上控制措施进行检查确认"
                Width: =559
                ZIndex: =4

        Label15 As label:
            Height: =0
            LayoutMinHeight: =70
            LayoutMinWidth: =560
            Size: =21
            Text: ="文本"
            Width: =Parent.Width
            ZIndex: =6

    Btn_ApproverAgree As button:
        BorderThickness: =1
        DisplayMode: =
        FocusedBorderThickness: =1
        FontWeight: =FontWeight.Normal
        Height: =28
        OnSelect: =Set(Vis_ApproveWhich,"Agree")
        RadiusBottomLeft: =2
        RadiusBottomRight: =2
        RadiusTopLeft: =2
        RadiusTopRight: =2
        Size: =12
        Text: =Switch(Personal_Identity,"Confirm","确认","Security","确认","同意")
        Visible: =Switch(Personal_Identity,"ApplDeptLeader",true,"OpADeptLeader",false,"OtherDeptLeader",false,"EHSLeader",true,"Confirm",true,"Security",true,"FactoryDirector",true,false)
        Width: =102
        X: =532
        Y: =1069
        ZIndex: =4

    Btn_Back As button:
        BorderThickness: =1
        FocusedBorderThickness: =1
        FontWeight: =FontWeight.Normal
        Height: =30
        OnSelect: =Navigate(Search)
        RadiusBottomLeft: =2
        RadiusBottomRight: =2
        RadiusTopLeft: =2
        RadiusTopRight: =2
        Size: =12
        Text: ="返回"
        Width: =102
        X: =5
        Y: =1101
        ZIndex: =5

    Label7 As label:
        Height: =39
        Italic: =true
        Size: =12
        Text: ="您当前身份是："&Switch(Personal_Identity,"ApplDeptLeader","申请部门负责人","OpADeptLeader","作业区域负责人","OtherDeptLeader","会签部门负责人","EHSLeader","EHS负责人","Patrol","巡检人员","Confirm","项目负责人","Security","保安","SubSecurity","保安","FactoryDirector","厂长","无")
        Width: =314
        X: =177
        Y: =1062
        ZIndex: =6

    Btn_OutPutPDF As button:
        FontWeight: =FontWeight.Normal
        Height: =25
        OnSelect: |-
            =//Select(Label3_25);
            ClearCollect(LicenseA,Filter(Licences,State=true),{Index:0});
            ClearCollect(LicenseB,Blank());
            ForAll(LicenseA,
            Collect(LicenseB,{LicenceN:ThisRecord.LicenceN,State:ThisRecord.State,Index:CountRows(LicenseB)+1}));
            Remove(LicenseB,LookUp(LicenseB,State=Blank()));
            
            //Switch(Vis_Current,
            
            Set(P,TPL_PdfOutput2.Run(
                "ID_"&SearchID&"_"&Vis_Current&".pdf",
                {file: { name: "ID_"&SearchID&"_"&Vis_Current&".pdf",
                         contentBytes:Switch(Vis_Current,
                         "Normal",PDF(Container_Normal,{ExpandContainers:true}),
                         "High",PDF(Container_HighNew_4,{ExpandContainers:true}),
                         "Lifting",PDF(Container_LiftingNew_8,{ExpandContainers:true}),
                         "Confined Space",PDF(Container_ConfinedSpaceNew_2,{ExpandContainers:true}),
                         "Hot",PDF(Container_HotWorkNew_3,{ExpandContainers:true}),
                         "Temporary Electricity",PDF(Container_TemporaryElectricityNew_4,{ExpandContainers:true}))}
               })
            );
            Refresh( 'Licenses PDF')
            
            /*If("Normal" in Concat(LicenseB,LicenceN,";"),
            Select(Menu_Licence_1,LookUp(LicenseB,LicenceN="Normal").Index);
            Set(PdfContent,PDF(Container_Normal,{ExpandContainers:true}));
            Set(P,PdfOutput.Run(
                "ID_"&SearchID&"_"&"Normal"&".pdf",
                {file: { name: "ID_"&SearchID&"_"&"Normal"&".pdf",
                         contentBytes:PdfContent}})
            )
            );
            
            
            If("High" in Concat(LicenseB,LicenceN,";"),
            Select(Menu_Licence_1,LookUp(LicenseB,LicenceN="High").Index);
            Set(PdfContent1,PDF(Container_HighNew_4,{ExpandContainers:true}));
            Set(P1,PdfOutput.Run(
                "ID_"&SearchID&"_"&"High"&".pdf",
                {file: { name: "ID_"&SearchID&"_"&"High"&".pdf",
                         contentBytes:PdfContent1}})
            ));
            
            
            If("Lifting" in Concat(LicenseB,LicenceN,";"),
            Select(Menu_Licence_1,LookUp(LicenseB,LicenceN="Lifting").Index);
            Set(PdfContent2,PDF(Container_LiftingNew_8,{ExpandContainers:true}));
            Set(P2,PdfOutput.Run(
                "ID_"&SearchID&"_""Lifting"&".pdf",
                {file: { name: "ID_"&SearchID&"_"&"Lifting"&".pdf",
                         contentBytes:PdfContent2}})
            ));
            
            
            If("Confined Space" in Concat(LicenseB,LicenceN,";"),
            Select(Menu_Licence_1,LookUp(LicenseB,LicenceN="Confined Space").Index);
            Set(PdfContent3,PDF(Container_ConfinedSpaceNew_2,{ExpandContainers:true}));
            Set(P3,PdfOutput.Run(
                "ID_"&SearchID&"_"&"Confined Space"&".pdf",
                {file: { name: "ID_"&SearchID&"_"&"Confined Space"&".pdf",
                         contentBytes:PdfContent3}})
            ));
            
            
            If("Hot" in Concat(LicenseB,LicenceN,";"),
            Select(Menu_Licence_1,LookUp(LicenseB,LicenceN="Hot").Index);
            Set(PdfContent4,PDF(Container_HotWorkNew_3,{ExpandContainers:true}));
            Set(P4,PdfOutput.Run(
                "ID_"&SearchID&"_"&"Hot"&".pdf",
                {file: { name: "ID_"&SearchID&"_"&"Hot"&".pdf",
                         contentBytes:PdfContent4}})
            ));
            
            
            If("Temporary Electricity" in Concat(LicenseB,LicenceN,";"),
            Select(Menu_Licence_1,LookUp(LicenseB,LicenceN="Temporary Electricity").Index);
            Set(PdfContent5,PDF(Container_TemporaryElectricityNew_4,{ExpandContainers:true}));
            Set(P5,PdfOutput.Run(
                "ID_"&SearchID&"_"&"Temporary Electricity"&".pdf",
                {file: { name: "ID_"&SearchID&"_"&"Temporary Electricity"&".pdf",
                         contentBytes:PdfContent5}})
            ));
            
            
            Refresh('Licenses PDF');
            
            //获取选择的施工单的各类许可证的信息
            ClearCollect(Current_Normal,Filter(TPL_NormalLicence,ProjID=SearchID));
            ClearCollect(Current_High,Filter(TPL_HighWork,ProjID=SearchID));
            ClearCollect(Current_Lifting,Filter(TPL_LiftingWork,ProjID=SearchID));
            ClearCollect(Current_ConfinedSpace,Filter(TPL_ConfinedSpaceWork,ProjID=SearchID));
            ClearCollect(Current_Hot,Filter(TPL_HotWork,ProjID=SearchID));
            ClearCollect(Current_TemporaryElectricity,Filter(TPL_TemporaryElectricityUseWork,ProjID=SearchID));
            
            
            */
            
            /*
            
            If("Normal" in Concat(LicenseB,LicenceN),
            Select(Menu_Licence_1,LookUp(LicenseB,LicenceN="Normal").Index);
            Set(PdfContent,PDF(Container_Normal,{ExpandContainers:true}));
            Set(PdfContent,PDF(Container_Normal,{ExpandContainers:true}));
                PdfOutput.Run(
                "ID_"&SearchID&"_"&"Normal"&".pdf",
                {file: { name: "ID_"&SearchID&"_"&"Normal"&".pdf",
                         contentBytes:PdfContent}}
            ));
            
            If("High" in Concat(LicenseB,LicenceN),
            Select(Menu_Licence_1,LookUp(LicenseB,LicenceN="High").Index);
            Set(PdfContent1,PDF(Container_HighNew_4,{ExpandContainers:true}));
            Set(PdfContent1,PDF(Container_HighNew_4,{ExpandContainers:true}));
            Set(PdfContent1,PDF(Container_HighNew_4,{ExpandContainers:true}));
            Set(PdfContent1,PDF(Container_HighNew_4,{ExpandContainers:true}));
                PdfOutput.Run(
                "ID_"&SearchID&"_"&"High"&".pdf",
                {file: { name: "ID_"&SearchID&"_"&"High"&".pdf",
                         contentBytes:PdfContent1}}
            ));
            
            
            If("Lifting" in Concat(LicenseB,LicenceN),
            Select(Menu_Licence_1,LookUp(LicenseB,LicenceN="Lifting").Index);
            Set(PdfContent2,PDF(Container_LiftingNew_8,{ExpandContainers:true}));
            Set(PdfContent2,PDF(Container_LiftingNew_8,{ExpandContainers:true}));
            Set(PdfContent2,PDF(Container_LiftingNew_8,{ExpandContainers:true}));
            Set(PdfContent2,PDF(Container_LiftingNew_8,{ExpandContainers:true}));
                PdfOutput.Run(
                "ID_"&SearchID&"_""Lifting"&".pdf",
                {file: { name: "ID_"&SearchID&"_"&"Lifting"&".pdf",
                         contentBytes:PdfContent2}}
            ));
            
            If("Confined Space" in Concat(LicenseB,LicenceN),
            Select(Menu_Licence_1,LookUp(LicenseB,LicenceN="Confined Space").Index);
            Set(PdfContent3,PDF(Container_ConfinedSpaceNew_2,{ExpandContainers:true}));
            Set(PdfContent3,PDF(Container_ConfinedSpaceNew_2,{ExpandContainers:true}));
            Set(PdfContent3,PDF(Container_ConfinedSpaceNew_2,{ExpandContainers:true}));
            Set(PdfContent3,PDF(Container_ConfinedSpaceNew_2,{ExpandContainers:true}));
                PdfOutput.Run(
                "ID_"&SearchID&"_"&"Confined Space"&".pdf",
                {file: { name: "ID_"&SearchID&"_"&"Confined Space"&".pdf",
                         contentBytes:PdfContent3}}
            ));
            
            If("Hot" in Concat(LicenseB,LicenceN),
            Select(Menu_Licence_1,LookUp(LicenseB,LicenceN="Hot").Index);
            Set(PdfContent4,PDF(Container_HotWorkNew_3,{ExpandContainers:true}));
            Set(PdfContent4,PDF(Container_HotWorkNew_3,{ExpandContainers:true}));
            Set(PdfContent4,PDF(Container_HotWorkNew_3,{ExpandContainers:true}));
            Set(PdfContent4,PDF(Container_HotWorkNew_3,{ExpandContainers:true}));
                PdfOutput.Run(
                "ID_"&SearchID&"_"&"Hot"&".pdf",
                {file: { name: "ID_"&SearchID&"_"&"Hot"&".pdf",
                         contentBytes:PdfContent4}}
            ));
            
            If("Temporary Electricity" in Concat(LicenseB,LicenceN),
            Select(Menu_Licence_1,LookUp(LicenseB,LicenceN="Temporary Electricity").Index);
            Set(PdfContent5,PDF(Container_TemporaryElectricityNew_4,{ExpandContainers:true}));
            Set(PdfContent5,PDF(Container_TemporaryElectricityNew_4,{ExpandContainers:true}));
            Set(PdfContent5,PDF(Container_TemporaryElectricityNew_4,{ExpandContainers:true}));
            Set(PdfContent5,PDF(Container_TemporaryElectricityNew_4,{ExpandContainers:true}));
                PdfOutput.Run(
                "ID_"&SearchID&"_"&"Temporary Electricity"&".pdf",
                {file: { name: "ID_"&SearchID&"_"&"Temporary Electricity"&".pdf",
                         contentBytes:PdfContent5}}
            ));
            */
        RadiusBottomLeft: =2
        RadiusBottomRight: =2
        RadiusTopLeft: =2
        RadiusTopRight: =2
        Size: =12
        Text: ="导出PDF"
        Visible: |-
            =If(
            (
            First(Current_Normal).ProjState="审批通过"||First(Current_Normal).ProjState="已完成"||
            (First(Current_Normal).ProjState="审批中"
            &&((First(Current_Normal).NeedFactorDire=true&&First(Current_Normal).FactoryDirector="同意"&&IsBlank(First(Current_Normal).ConstructionPlateID))||(First(Current_Normal).NeedFactorDire=false&&First(Current_Normal).EHSView="同意"&&IsBlank(First(Current_Normal).ConstructionPlateID)))
            )
            )
            &&Personal_Identity<>"Patrol"
            &&Personal_Identity<>"Confirm"
            &&Personal_Identity<>"Security",
            true,false)
        Width: =100
        X: =426
        Y: =1106
        ZIndex: =7

    Btn_OutPutPDF_1 As button:
        DisplayMode: |-
            =//If(First(Current_Normal).ProjState="审批通过",true,false)
            If(CountRows(Filter(Sort('Licenses PDF',ID,SortOrder.Descending),"ID_"&SearchID&"_" in Name))<>0,DisplayMode.Edit,DisplayMode.Disabled)
        FontWeight: =FontWeight.Normal
        Height: =25
        OnSelect: |-
            =Refresh('Licenses PDF');
            
            
            Navigate(PDF);
        RadiusBottomLeft: =2
        RadiusBottomRight: =2
        RadiusTopLeft: =2
        RadiusTopRight: =2
        Size: =12
        Text: ="查看PDF"
        Width: =102
        X: =532
        Y: =1106
        ZIndex: =8

    Container_HotWorkNew_3 As groupContainer.verticalAutoLayoutContainer:
        Height: =990
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        Visible: =If(Vis_Current="Hot",true,false)
        Width: =630
        X: =5
        Y: =46
        ZIndex: =9

        Container_HotWorkNew_Title_1 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =100
            LayoutMinHeight: =80
            LayoutMinWidth: =250
            Width: =630
            X: =5
            Y: =107
            ZIndex: =1

            Label3_20 As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =70
                Size: =21
                Text: ="热加工（动火）作业许可证"
                Width: =560
                X: =36
                Y: =7
                ZIndex: =58

            Label3_21 As label:
                Align: =Align.Center
                Color: =RGBA(184, 0, 0, 1)
                FontWeight: =FontWeight.Semibold
                Height: =26
                Size: =10.5
                Text: ="高空作业定义：在坠落高度基准面2米以上（含2米）有可能坠落的高处进行的作业。"
                Width: =630
                Y: =74
                ZIndex: =59

            Image3_8 As image:
                Height: =80
                Image: ='1694500910899'
                Width: =97
                ZIndex: =60

        Container_HotWorkNew_4 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label2_13.Height+Gallery5_9.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =2

            "Gallery5_9 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =If(Self.AllItemsCount=0,1,Self.AllItemsCount)*30
                Items: =Filter(TPL_InfoGathering,ProjID=Text(SearchID),PhotoType="动火作业人员信息")
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =30
                Width: =630
                Y: =31
                ZIndex: =1

                TextInput_HW_Worker_1 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.Name
                    DisplayMode: =DisplayMode.View
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =155
                    ZIndex: =7

                TextInput__HW_ID_1 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.Identifier
                    DisplayMode: =DisplayMode.View
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =295
                    X: =334
                    ZIndex: =8

                Image_Photo_14 As image:
                    Height: =30
                    Image: =ThisItem.Photograph
                    OnSelect: |-
                        =Set(ShowPhoto,ThisItem.Photograph.Full);
                        Set(WhereBack,"Approve");
                        Navigate(PhotoGraph);
                    Width: =179
                    X: =155
                    ZIndex: =9

            Label2_13 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="动火作业人员"
                Width: =155
                ZIndex: =2

            Label2_20 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件号"
                Width: =302
                X: =328
                ZIndex: =3

            Label2_90 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件照片"
                Width: =173
                X: =155
                ZIndex: =4

        Container_HotWorkNew_5 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =415
            LayoutMinHeight: =60
            LayoutMinWidth: =250
            Width: =Parent.Width
            X: =40
            ZIndex: =3

            Label1_365 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="现场监护人:"
                Width: =104
                Y: =50
                ZIndex: =28

            TextInput_OnSiteGuardian4_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Hot).OnSiteGuardian
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =209
                X: =92
                Y: =50
                ZIndex: =29

            Label1_367 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="作业内容:"
                Width: =81
                Y: =102
                ZIndex: =32

            Label1_368 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="作业动火工具:"
                Width: =120
                Y: =152
                ZIndex: =34

            TextInput_FWTools_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Hot).FWTools
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =516
                X: =112
                Y: =152
                ZIndex: =35

            Label1_369 As label:
                FontWeight: =FontWeight.Bold
                Height: =25
                Size: =12
                Text: ="危害辨识"
                Width: =81
                Y: =177
                ZIndex: =44

            TextInput_FWHazard1_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Hot).FWHazard1
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =455
                X: =161
                Y: =202
                ZIndex: =45

            Label1_370 As label:
                Height: =25
                Size: =12
                Text: ="1）存在的危害因素："
                Width: =174
                Y: =202
                ZIndex: =46

            Label1_371 As label:
                Height: =25
                Size: =12
                Text: ="2）可能导致的后果："
                Width: =174
                Y: =227
                ZIndex: =47

            Label1_372 As label:
                Height: =25
                Size: =12
                Text: ="3）相应的管控措施："
                Width: =174
                Y: =252
                ZIndex: =48

            TextInput_FWHazard2_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Hot).FWHazard2
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =455
                X: =161
                Y: =227
                ZIndex: =49

            TextInput_FWHazard3_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Hot).FWHazard3
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =455
                X: =161
                Y: =252
                ZIndex: =50

            Label1_364 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="作业单位:"
                Width: =90
                Y: =25
                ZIndex: =53

            TextInput_OpUnit4_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Hot).OpUnit
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =483
                X: =90
                Y: =25
                ZIndex: =54

            Label1_353 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="作业地点:"
                Width: =81
                ZIndex: =55

            TextInput_OpAr4_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Hot).OpAr
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =524
                X: =90
                ZIndex: =56

            Label1_373 As label:
                FontWeight: =FontWeight.Bold
                Height: =25
                Size: =12
                Text: ="动火作业级别"
                Width: =120
                Y: =277
                ZIndex: =57

            Radio_FWLevel_1 As radio:
                BorderColor: =
                Default: =First(Current_Hot).FWLevel
                DisplayMode: =DisplayMode.View
                FocusedBorderColor: =
                FocusedBorderThickness: =0
                Height: =82
                HoverColor: =
                Items: =["一级","二级","三级"]
                Layout: =Layout.Horizontal
                PaddingBottom: =0
                PaddingTop: =0
                PressedColor: =
                RadioSize: =24
                Size: =11
                Width: =120
                Y: =302
                ZIndex: =58

            Label1_374 As label:
                Height: =82
                Italic: =true
                PaddingTop: =0
                Size: =10
                Text: |-
                    ="注：一级动火：在生产运行状态下的易燃易爆管道、储罐、容器等特殊危险场所的动火作业(含带压不置换动火作业)
                    二级动火：在易燃易场所进行除一级动火以外的动火作业
                    三级动火：除一级和二级外，凡生产系统全部停机，经清洗、置换、分析合格并采取安全隔离措施后的动火作业"
                Width: =521
                X: =95
                Y: =302
                ZIndex: =59

            TextInput_OpCountent4_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Hot).OpCountent
                DisplayMode: =DisplayMode.View
                Height: =50
                MaxLength: =65
                Mode: =TextMode.MultiLine
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =525
                X: =81
                Y: =101
                ZIndex: =60

            Label1_190 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="开始时间:"
                Width: =81
                Y: =76
                ZIndex: =61

            Label1_192 As label:
                Height: =25
                Size: =12
                Text: ="结束时间："
                Width: =92
                X: =315
                Y: =76
                ZIndex: =62

            TextInput_OpCountent3_12 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |
                    =Text(First(Current_Hot).StartTime,"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                MaxLength: =35
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =220
                X: =81
                Y: =76
                ZIndex: =63

            TextInput_OpCountent3_13 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Text(First(Current_Hot).EndTime,"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                MaxLength: =35
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =214
                X: =400
                Y: =76
                ZIndex: =64

            Label1_630 As label:
                Height: =25
                Size: =12
                Text: ="工厂："
                Visible: =If(Radio_FWLevel_1.Selected.Value="一级",true,false)
                Width: =60
                Y: =384
                ZIndex: =66

            TextInput_FWHazard3_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).FactoryName
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =455
                X: =60
                Y: =384
                ZIndex: =67

        Label11 As label:
            Height: =1
            LayoutMinHeight: =70
            LayoutMinWidth: =560
            OnSelect: =true
            Size: =21
            Text: =""
            Width: =Parent.Width
            ZIndex: =5

        Container_High_SC_1 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: |+
                =Label1_620.Height+Gallery83.Height+Label1_621.Height+Label1_428.Height+Label1_636.Height
                
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =6

            Label1_621 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="项目负责人确认:"
                Width: =138
                Y: =Gallery83.Y+Gallery83.Height
                ZIndex: =1

            TextInput1_131 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).ProjLeader
                DisplayMode: =DisplayMode.View
                Height: =25
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =11
                Width: =461
                X: =138
                Y: =Gallery83.Y+Gallery83.Height
                ZIndex: =2

            "Gallery83 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                Default: =First(Self.AllItems)
                DelayItemLoading: =true
                DisplayMode: =DisplayMode.View
                Height: |
                    =Sum(Int(ShowColumns(Self.AllItems,"Label_height_9")),Value)+Self.AllItemsCount*1.5
                Items: |-
                    =
                    Filter(Gal_HotWorkSafetyControl2,Not(IsBlank(Content)))
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =Int(Label_height_9.Text)
                Width: =Parent.Width
                Y: =50+If(IsBlank(First(Current_Hot).FireOther),0,25)
                ZIndex: =3

                Label_height_9 As label:
                    Height: =1
                    OnSelect: =Select(Parent)
                    Size: =20
                    Text: =Label19_2.Height
                    Visible: =false
                    Width: =100
                    X: =40
                    ZIndex: =1

                Radio_PatrolTnspection_26 As radio:
                    BorderColor: =
                    Default: =Switch(ThisItem.Confirm,true,"是",false,"不适用")
                    DisplayMode: =DisplayMode.View
                    FocusedBorderColor: =
                    FocusedBorderThickness: =0
                    Height: =25
                    HoverColor: =
                    Items: =["是","不适用"]
                    Layout: =Layout.Horizontal
                    PaddingBottom: =0
                    PaddingTop: =0
                    PressedColor: =
                    RadioBorderColor: =RGBA(0, 13, 75, 1)
                    RadioSelectionFill: =RGBA(26, 26, 26, 1)
                    RadioSize: =15
                    Size: =12
                    Width: =155
                    Y: =6
                    ZIndex: =2

                Label19_2 As label:
                    AutoHeight: =true
                    Height: =
                    Size: =12
                    Text: =ThisItem.Content
                    VerticalAlign: =VerticalAlign.Top
                    Width: =460
                    X: =155
                    ZIndex: =4

            Label1_620 As label:
                FontWeight: =FontWeight.Bold
                Height: =25
                Size: =12
                Text: ="现场安全控制措施：项目负责人应同现场负责人对以上控制措施进行检查确认"
                Width: =559
                ZIndex: =4

            Label1_428 As label:
                Height: =25
                Size: =12
                Text: ="消防水带数量"
                Width: =120
                Y: =25
                ZIndex: =5

            Label1_434 As label:
                Height: =25
                Size: =12
                Text: ="灭火器数量"
                Width: =100
                X: =222
                Y: =25
                ZIndex: =6

            Label1_635 As label:
                Height: =25
                Size: =12
                Text: ="防火毯数量"
                Width: =101
                X: =415
                Y: =25
                ZIndex: =7

            TextInput_FWHazard1_7 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Hot).FireHose
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Format: =TextFormat.Number
                Height: =25
                HintText: ="消防水带数量"
                OnChange: =
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =116
                X: =106
                Y: =25
                ZIndex: =8

            TextInput_FWHazard1_8 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Hot).FireExtinguisher
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Format: =TextFormat.Number
                Height: =25
                HintText: ="灭火器数量"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =93
                X: =322
                Y: =25
                ZIndex: =9

            TextInput_FWHazard1_9 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Hot).FireBlanket
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Format: =TextFormat.Number
                Height: =25
                HintText: ="防火毯数量"
                OnChange: |-
                    =If(
                        IsBlank(Self.Text),
                        Notify("不能为空", NotificationType.Error); Reset(Self)
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =103
                X: =516
                Y: =25
                ZIndex: =10

            Label1_636 As label:
                Height: =25
                Size: =12
                Text: ="其他器材名 "
                Visible: =If(IsBlank(First(Current_Hot).FireOther),false,true)
                Width: =93
                Y: =50
                ZIndex: =11

            TextInput_FWOtherToolNumber_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Hot).FireOtherNumber
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Format: =TextFormat.Number
                Height: =25
                HintText: ="其他器材数量"
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Visible: =If(IsBlank(First(Current_Hot).FireOther),false,true)
                Width: =189
                X: =430
                Y: =50
                ZIndex: =12

            TextInput_FWOtherTool_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Hot).FireOther
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                HintText: ="其他器材名"
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Visible: =If(IsBlank(First(Current_Hot).FireOther),false,true)
                Width: =229
                X: =93
                Y: =50
                ZIndex: =13

            Label1_637 As label:
                Height: =25
                Size: =12
                Text: ="其他器材数量"
                Visible: =If(IsBlank(First(Current_Hot).FireOther),false,true)
                Width: =108
                X: =322
                Y: =50
                ZIndex: =14

        Label11_1 As label:
            Height: =1
            LayoutMinHeight: =70
            LayoutMinWidth: =560
            OnSelect: =true
            Size: =21
            Text: =""
            Width: =Parent.Width
            ZIndex: =7

        Label16 As label:
            Height: =70
            LayoutMinHeight: =70
            LayoutMinWidth: =560
            Size: =21
            Text: ="文本"
            Visible: =false
            Width: =560
            ZIndex: =8

    Container_ConfinedSpaceNew_2 As groupContainer.verticalAutoLayoutContainer:
        Height: =990
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        Visible: =If(Vis_Current="Confined Space",true,false)
        Width: =630
        X: =4
        Y: =46
        ZIndex: =10

        Container_ConfinedSpaceNew_Title_1 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =110
            LayoutMinHeight: =70
            LayoutMinWidth: =250
            Width: =630
            X: =5
            Y: =107
            ZIndex: =1

            Image3_7 As image:
                Height: =80
                Image: ='1694500910899'
                Width: =97
                ZIndex: =1

            Label3_18 As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =70
                Size: =21
                Text: |-
                    ="Confined Space Work Permit
                    有限空间作业许可证"
                Width: =560
                X: =36
                Y: =7
                ZIndex: =2

            Label3_19 As label:
                Align: =Align.Center
                Color: =RGBA(184, 0, 0, 1)
                FontWeight: =FontWeight.Semibold
                Height: =33
                Size: =10.5
                Text: ="有限空间定义： 封闭或者部分封闭，出入口较为狭窄，作业人员不能长时间在内工作，自然通风不良，易造成有毒有害、易燃易爆物质积聚或者含氧量不足的空间 。"
                Width: =630
                Y: =77
                ZIndex: =3

        Container_ConfinedSpaceNew_3 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =290
            LayoutMinHeight: =60
            LayoutMinWidth: =250
            Width: =Parent.Width
            X: =40
            ZIndex: =2

            Label1_350 As label:
                DisplayMode: =DisplayMode.View
                Height: =25
                Size: =12
                Text: |-
                    ="现场监护人:"
                Width: =96
                Y: =30
                ZIndex: =28

            TextInput_OnSiteGuardian3_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_ConfinedSpace).OnSiteGuardian
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =536
                X: =94
                Y: =30
                ZIndex: =29

            Label1_352 As label:
                DisplayMode: =DisplayMode.View
                Height: =25
                Size: =12
                Text: |-
                    ="作业内容:"
                Width: =80
                Y: =106
                ZIndex: =32

            TextInput_OpCountent3_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |
                    =First(Current_ConfinedSpace).OpCountent
                DisplayMode: =DisplayMode.View
                Height: =50
                MaxLength: =65
                Mode: =TextMode.MultiLine
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =530
                X: =80
                Y: =103
                ZIndex: =33

            Label1_360 As label:
                DisplayMode: =DisplayMode.View
                Height: =25
                Size: =12
                Text: ="危害辨识"
                Width: =80
                Y: =179
                ZIndex: =44

            TextInput_CSWHazard1_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_ConfinedSpace).CSWHazard1
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =449
                X: =161
                Y: =204
                ZIndex: =45

            Label1_361 As label:
                DisplayMode: =DisplayMode.View
                Height: =25
                Size: =12
                Text: |-
                    ="1）存在的危害因素:"
                Width: =160
                Y: =204
                ZIndex: =46

            Label1_362 As label:
                DisplayMode: =DisplayMode.View
                Height: =25
                Size: =12
                Text: |-
                    ="2）可能导致的后果:"
                Width: =160
                Y: =229
                ZIndex: =47

            Label1_363 As label:
                DisplayMode: =DisplayMode.View
                Height: =25
                Size: =12
                Text: |-
                    ="3）相应的管控措施:"
                Width: =160
                Y: =254
                ZIndex: =48

            TextInput_CSWHazard2_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_ConfinedSpace).CSWHazard2
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =449
                X: =161
                Y: =229
                ZIndex: =49

            TextInput_CSWHazard3_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_ConfinedSpace).CSWHazard3
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =449
                X: =161
                Y: =254
                ZIndex: =50

            Label1_339 As label:
                DisplayMode: =DisplayMode.View
                Height: =25
                Size: =12
                Text: |-
                    ="作业地点:"
                Width: =80
                Y: =80
                ZIndex: =51

            TextInput_OpAr3_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_ConfinedSpace).OpAr
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =216
                X: =80
                Y: =80
                ZIndex: =52

            Label1_338 As label:
                DisplayMode: =DisplayMode.View
                Height: =25
                Size: =12
                Text: |-
                    ="作业单位:"
                Width: =80
                Y: =5
                ZIndex: =53

            TextInput_OpUnit3_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_ConfinedSpace).OpUnit
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =550
                X: =80
                Y: =5
                ZIndex: =54

            Label1_359 As label:
                DisplayMode: =DisplayMode.View
                Height: =25
                Size: =12
                Text: |-
                    ="作业人员:"
                Width: =80
                Y: =55
                ZIndex: =55

            TextInput_CSW_Worker_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_ConfinedSpace).Worker
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =216
                X: =80
                Y: =55
                ZIndex: =56

            Label1_188 As label:
                DisplayMode: =DisplayMode.View
                Height: =25
                Size: =12
                Text: |-
                    ="开始时间:"
                Width: =80
                Y: =154
                ZIndex: =57

            Label1_186 As label:
                DisplayMode: =DisplayMode.View
                Height: =25
                Size: =12
                Text: |-
                    ="结束时间:"
                Width: =80
                X: =298
                Y: =154
                ZIndex: =58

            TextInput_OpCountent3_4 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |
                    =Text(First(Current_ConfinedSpace).StartTime,"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =26
                MaxLength: =35
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =218
                X: =80
                Y: =153
                ZIndex: =66

            TextInput_OpCountent3_5 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |
                    =Text(First(Current_ConfinedSpace).EndTime,"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                MaxLength: =35
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =229
                X: =381
                Y: =154
                ZIndex: =67

        Container_High_1 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Gallery81_2.Y+Gallery81_2.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =3

            Label1_616 As label:
                FontWeight: =FontWeight.Bold
                Height: =25
                Size: =12
                Text: ="现场安全控制措施：项目负责人应同现场负责人对以上控制措施进行检查确认"
                Width: =599
                ZIndex: =1

            Label1_634 As label:
                Height: =25
                Size: =12
                Text: ="通风起止时间："
                Width: =145
                Y: =25
                ZIndex: =2

            Label2_94 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =41
                LineHeight: =1.1
                Size: =12
                Text: |-
                    ="氧含量
                    18~23.5%"
                Width: =83
                X: =287
                Y: =57
                ZIndex: =3

            Label2_95 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =41
                LineHeight: =1.1
                Size: =12
                Text: ="取样人"
                Width: =70
                Y: =57
                ZIndex: =4

            Label2_96 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =41
                LineHeight: =1.1
                Size: =12
                Text: ="取样时间"
                Width: =113
                X: =70
                Y: =57
                ZIndex: =5

            Label2_97 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =41
                LineHeight: =1.1
                Size: =12
                Text: ="取样地点"
                Width: =104
                X: =183
                Y: =57
                ZIndex: =6

            Label2_98 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =41
                LineHeight: =1.1
                Size: =12
                Text: ="可燃气体10%LEL"
                Width: =90
                X: =370
                Y: =57
                ZIndex: =7

            Label2_99 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =41
                LineHeight: =1.1
                Size: =12
                Text: ="一氧化碳20mg/m3"
                Width: =86
                X: =460
                Y: =57
                ZIndex: =8

            Label2_100 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =41
                LineHeight: =1.1
                Size: =12
                Text: ="硫化氢10mg/m3"
                Width: =86
                X: =544
                Y: =57
                ZIndex: =9

            "Gallery81_2 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                BorderColor: =RGBA(214, 223, 238, 1)
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =(Self.AllItemsCount)*30
                Items: =Filter(TPL_GasDetection,ProjID=SearchID)
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =30
                Width: =Parent.Width
                Y: =98
                ZIndex: =10

                TextInput3_21 As text:
                    Align: =Align.Center
                    BorderColor: =RGBA(214, 223, 238, 1)
                    BorderThickness: =1
                    Default: =ThisItem.Sampler
                    DisplayMode: =DisplayMode.View
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =11
                    Width: =70
                    ZIndex: =12

                TextInput3_22 As text:
                    Align: =Align.Center
                    BorderColor: =RGBA(214, 223, 238, 1)
                    BorderThickness: =1
                    Default: =ThisItem.SampleT
                    DisplayMode: =DisplayMode.View
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =11
                    Width: =113
                    X: =70
                    ZIndex: =13

                TextInput3_23 As text:
                    Align: =Align.Center
                    BorderColor: =RGBA(214, 223, 238, 1)
                    BorderThickness: =1
                    Default: =ThisItem.SampleP
                    DisplayMode: =DisplayMode.View
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =11
                    Width: =104
                    X: =183
                    ZIndex: =14

                TextInput3_24 As text:
                    Align: =Align.Center
                    BorderColor: =RGBA(214, 223, 238, 1)
                    BorderThickness: =1
                    Default: =ThisItem.OxyContent
                    DisplayMode: =DisplayMode.View
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =11
                    Width: =83
                    X: =287
                    ZIndex: =15

                TextInput3_25 As text:
                    Align: =Align.Center
                    BorderColor: =RGBA(214, 223, 238, 1)
                    BorderThickness: =1
                    Default: =ThisItem.CombustibleGas
                    DisplayMode: =DisplayMode.View
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =11
                    Width: =83
                    X: =370
                    ZIndex: =16

                TextInput3_26 As text:
                    Align: =Align.Center
                    BorderColor: =RGBA(214, 223, 238, 1)
                    BorderThickness: =1
                    Default: =ThisItem.CarbonMonoxide
                    DisplayMode: =DisplayMode.View
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =11
                    Width: =94
                    X: =453
                    ZIndex: =17

                TextInput3_27 As text:
                    Align: =Align.Center
                    BorderColor: =RGBA(214, 223, 238, 1)
                    BorderThickness: =1
                    Default: =ThisItem.HydrogenSulfide
                    DisplayMode: =DisplayMode.View
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =11
                    Width: =83
                    X: =547
                    ZIndex: =18

            Label1_638 As label:
                Height: =25
                Size: =12
                Text: =First(Current_ConfinedSpace).GasDetectionTime
                Width: =188
                X: =117
                Y: =25
                ZIndex: =11

        Container_High_2 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Btn_SubPatrol_1.Y+Btn_SubPatrol_1.Height+5
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Visible: |-
                =If(Personal_Identity="Patrol",true,false)
                //First(Current_Normal).IsPatrol
            Width: =Parent.Width
            ZIndex: =4

            Icon_HW_Add_1 As icon.Add:
                Color: =RGBA(15, 84, 140, 1)
                FocusedBorderThickness: =5
                Height: =25
                Icon: =Icon.Add
                OnSelect: |+
                    =Collect(GasDetection2,{Sampler:"",SampleT:"",SampleP:"",OxyContent:"",CombustibleGas:"",CarbonMonoxide:"",HydrogenSulfide:""})
                    
                Tooltip: ="新增一行"
                Width: =25
                X: =588
                Y: =4
                ZIndex: =1

            Btn_SubPatrol_1 As button:
                BorderThickness: =1
                FocusedBorderThickness: =1
                FontWeight: =FontWeight.Normal
                Height: =25
                OnSelect: |-
                    =ForAll(
                        Gallery81_1.AllItems,
                    If(IsBlank(ThisRecord.TextInput3_14.Text)||IsBlank(ThisRecord.TextInput3_15.Text)||IsBlank(ThisRecord.TextInput3_15.Text),
                    Notify("请补全信息！",NotificationType.Error),
                    Patch(TPL_GasDetection,
                    {ProjID:SearchID,Sampler:ThisRecord.TextInput3_14.Text,SampleT:ThisRecord.TextInput3_15.Text
                    ,SampleP:ThisRecord.TextInput3_16.Text,OxyContent:ThisRecord.TextInput3_17.Text,CombustibleGas:ThisRecord.TextInput3_18.Text
                    ,CarbonMonoxide:ThisRecord.TextInput3_19.Text,HydrogenSulfide:ThisRecord.TextInput3_20.Text})
                    ));
                    
                    ClearCollect(GasDetection2,{Sampler:"",SampleT:"",SampleP:"",OxyContent:"",CombustibleGas:"",CarbonMonoxide:"",HydrogenSulfide:""});
                    
                    Refresh(TPL_GasDetection);
                    Refresh(TPL_NormalLicence);
                    //刷新许可证信息
                    ClearCollect(Current_Normal,Filter(TPL_NormalLicence,ProjID=SearchID));
                    ClearCollect(Current_High,Filter(TPL_HighWork,ProjID=SearchID));
                    ClearCollect(Current_Lifting,Filter(TPL_LiftingWork,ProjID=SearchID));
                    ClearCollect(Current_ConfinedSpace,Filter(TPL_ConfinedSpaceWork,ProjID=SearchID));
                    ClearCollect(Current_Hot,Filter(TPL_HotWork,ProjID=SearchID));
                    ClearCollect(Current_TemporaryElectricity,Filter(TPL_TemporaryElectricityUseWork,ProjID=SearchID));
                    ClearCollect(Gal_NormalPatrolNew,{InspectionStaff:"",InspectionTime:DateTime(2000,1,1,0,0,0),InspectionPhoto:SampleImage});
                    
                    Refresh(TPL_Patrol);
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Text: ="提交"
                Width: =102
                X: =516
                Y: =Gallery81_1.Y+Gallery81_1.Height+5
                ZIndex: =2

            "Gallery81_1 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                BorderColor: =RGBA(214, 223, 238, 1)
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =(Self.AllItemsCount)*30
                Items: =GasDetection2
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =30
                Width: =Parent.Width
                Y: =Icon_HW_Add_1.Height+Icon_HW_Add_1.Y+5
                ZIndex: =3

                TextInput3_14 As text:
                    Align: =Align.Center
                    BorderColor: =RGBA(214, 223, 238, 1)
                    BorderThickness: =0.5
                    Default: =ThisItem.Sampler
                    Height: =30
                    OnChange: =
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Reset: =true
                    Size: =11
                    Width: =70
                    ZIndex: =12

                TextInput3_15 As text:
                    Align: =Align.Center
                    BorderColor: =RGBA(214, 223, 238, 1)
                    BorderThickness: =0.5
                    Default: =ThisItem.SampleT
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Reset: =true
                    Size: =11
                    Width: =113
                    X: =70
                    ZIndex: =13

                TextInput3_16 As text:
                    Align: =Align.Center
                    BorderColor: =RGBA(214, 223, 238, 1)
                    BorderThickness: =0.5
                    Default: =ThisItem.SampleP
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Reset: =true
                    Size: =11
                    Width: =104
                    X: =183
                    ZIndex: =14

                TextInput3_17 As text:
                    Align: =Align.Center
                    BorderColor: =RGBA(214, 223, 238, 1)
                    BorderThickness: =0.5
                    Default: =ThisItem.OxyContent
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Reset: =true
                    Size: =11
                    Width: =83
                    X: =287
                    ZIndex: =15

                TextInput3_18 As text:
                    Align: =Align.Center
                    BorderColor: =RGBA(214, 223, 238, 1)
                    BorderThickness: =0.5
                    Default: =ThisItem.CombustibleGas
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Reset: =true
                    Size: =11
                    Width: =83
                    X: =370
                    ZIndex: =16

                TextInput3_19 As text:
                    Align: =Align.Center
                    BorderColor: =RGBA(214, 223, 238, 1)
                    BorderThickness: =0.5
                    Default: =ThisItem.CarbonMonoxide
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Reset: =true
                    Size: =11
                    Width: =94
                    X: =453
                    ZIndex: =17

                TextInput3_20 As text:
                    Align: =Align.Center
                    BorderColor: =RGBA(214, 223, 238, 1)
                    BorderThickness: =0.5
                    Default: =ThisItem.CarbonMonoxide
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Reset: =true
                    Size: =11
                    Width: =83
                    X: =547
                    ZIndex: =18

                Icon4_7 As icon.Cancel:
                    Height: =18
                    Icon: =Icon.Cancel
                    OnSelect: =Remove(GasDetection2,ThisItem)
                    Tooltip: ="清空此行"
                    Width: =18
                    X: =607
                    Y: =6
                    ZIndex: =19

        Container_High_3 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label1_625.Height+Label1_625.Y
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =5

            "Gallery80 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                Default: =First(Self.AllItems)
                DelayItemLoading: =true
                DisplayMode: =DisplayMode.View
                Height: =Sum(Self.AllItems,Int(Label_height_6.Text)+Self.TemplatePadding+1)
                Items: =Filter(Gal_ConfinedSpaceSafetyControl2,Not(IsBlank(Content)))
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                Selectable: =false
                ShowScrollbar: =false
                TemplatePadding: =1
                TemplateSize: =Int(Label_height_6.Text)
                Width: =Parent.Width
                Y: =5
                ZIndex: =1

                Label_height_6 As label:
                    Height: =20
                    OnSelect: =Select(Parent)
                    Size: =20
                    Text: =Title3_10.Height+Gallery80.TemplatePadding+4
                    Visible: =false
                    Width: =100
                    X: =498
                    ZIndex: =1

                Radio_PatrolTnspection_24 As radio:
                    BorderColor: =
                    Default: =Switch(ThisItem.Confirm,true,"是",false,"不适用")
                    DisplayMode: =DisplayMode.View
                    FocusedBorderColor: =
                    FocusedBorderThickness: =0
                    Height: =25
                    HoverColor: =
                    Items: =["是","不适用"]
                    Layout: =Layout.Horizontal
                    PaddingBottom: =0
                    PaddingTop: =0
                    PressedColor: =
                    RadioSize: =15
                    Size: =12
                    Width: =155
                    ZIndex: =2

                Title3_10 As label:
                    AutoHeight: =true
                    Height: =20
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =15
                    PaddingTop: =0
                    Size: =12
                    Text: =ThisItem.Content
                    VerticalAlign: =VerticalAlign.Top
                    Width: =473
                    X: =155
                    ZIndex: =4

            Label1_625 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="项目负责人确认:"
                Width: =138
                Y: =Gallery80.Y+Gallery80.Height
                ZIndex: =15

            TextInput1_134 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).ProjLeader
                DisplayMode: =DisplayMode.View
                Height: =25
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =461
                X: =138
                Y: =Gallery80.Y+Gallery80.Height
                ZIndex: =16

    Container_LiftingNew_8 As groupContainer.verticalAutoLayoutContainer:
        Height: =990
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        Visible: =If(Vis_Current="Lifting",true,false)
        Width: =630
        X: =5
        Y: =46
        ZIndex: =11

        Container_LiftingNew_Title_1 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =100
            LayoutMinHeight: =70
            LayoutMinWidth: =250
            Width: =630
            X: =5
            Y: =107
            ZIndex: =1

            Image3_6 As image:
                Height: =80
                Image: ='1694500910899'
                Width: =97
                ZIndex: =1

            Label3_3 As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =70
                Size: =21
                Text: |-
                    ="Lifting Work Permit
                    吊装作业许可证"
                Width: =560
                X: =36
                Y: =7
                ZIndex: =2

            Label3_22 As label:
                Align: =Align.Center
                Color: =RGBA(184, 0, 0, 1)
                FontWeight: =FontWeight.Semibold
                Height: =26
                Size: =10.5
                Text: ="定义：利用吊车或者起升机构将重物吊起，并使重物发生位置变化的作业过程"
                Width: =630
                Y: =72
                ZIndex: =3

        Container_LiftingNew_9 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =130
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =630
            X: =5
            Y: =107
            ZIndex: =2

            Label1_321 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="作业内容:"
                Width: =80
                Y: =78
                ZIndex: =4

            Label1_305 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="吊装地点:"
                Width: =80
                Y: =25
                ZIndex: =50

            TextInput_OpAr2_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Lifting).OpAr
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =533
                X: =80
                Y: =25
                ZIndex: =51

            Label1_375 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="被吊物:"
                Width: =81
                Y: =50
                ZIndex: =68

            TextInput_SuspendedObject_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |
                    =First(Current_Lifting).SuspendedObject
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =191
                X: =80
                Y: =50
                ZIndex: =69

            Label1_376 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="被吊物重量(T):"
                Width: =113
                X: =271
                Y: =50
                ZIndex: =70

            TextInput_SuspendedObjectWeight_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |
                    =First(Current_Lifting).SuspendedObjectWeight
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =205
                X: =381
                Y: =50
                ZIndex: =71

            TextInput_OpCountent2_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |
                    =First(Current_Lifting).OpCountent
                DisplayMode: =DisplayMode.View
                Height: =50
                MaxLength: =65
                Mode: =TextMode.MultiLine
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =543
                X: =80
                Y: =75
                ZIndex: =72

            Label1_207 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="作业单位:"
                Width: =80
                ZIndex: =73

            TextInput_OpUnit2_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Lifting).OpUnit
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =542
                X: =81
                ZIndex: =74

        Container_LiftingNew_10 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label_124.Height+Gallery5_10.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =3

            "Gallery5_10 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =If(Self.AllItemsCount=0,1,Self.AllItemsCount)*30
                Items: =Filter(TPL_InfoGathering,ProjID=Text(SearchID),PhotoType="吊装设备信息")
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =30
                Width: =630
                Y: =31
                ZIndex: =1

                TextInput_LW_Equipments_1 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.Name
                    DisplayMode: =DisplayMode.View
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =217
                    X: =4
                    ZIndex: =7

                TextInput_LW_EquipmentsID_1 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.Identifier
                    DisplayMode: =DisplayMode.View
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =385
                    X: =234
                    ZIndex: =8

            Label_124 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="吊装设备"
                Width: =216
                ZIndex: =2

            Label2_21 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="编号"
                Width: =414
                X: =216
                ZIndex: =3

        Container_LiftingNew_11 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0.1
            Height: =60
            LayoutMinHeight: =60
            LayoutMinWidth: =250
            Width: =Parent.Width
            X: =40
            ZIndex: =4

            Label1_377 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="吊装设备起重能力(T):"
                Width: =161
                X: =1
                Y: =2
                ZIndex: =28

            TextInput_LiftingCapacity_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Lifting).LiftingCapacity
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =110
                X: =162
                Y: =2
                ZIndex: =29

            Label1_306 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="开始时间:"
                Width: =80
                X: =1
                Y: =27
                ZIndex: =30

            Label1_194 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="结束时间:"
                Width: =80
                X: =271
                Y: =27
                ZIndex: =31

            TextInput_OpCountent3_10 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Text(First(Current_Lifting).StartTime,"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                MaxLength: =35
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =188
                X: =84
                Y: =27
                ZIndex: =32

            TextInput_OpCountent3_11 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Text(First(Current_Lifting).EndTime,"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                MaxLength: =35
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =267
                X: =352
                Y: =27
                ZIndex: =33

        Container_LiftingNew_12 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label2_22.Height+Gallery5_11.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =5

            "Gallery5_11 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =If(Self.AllItemsCount=0,1,Self.AllItemsCount)*30
                Items: =Filter(TPL_InfoGathering,ProjID=Text(SearchID),PhotoType="吊装作业人员信息")
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =30
                Width: =630
                Y: =31
                ZIndex: =1

                TextInput_LW_Worker_1 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.Name
                    DisplayMode: =DisplayMode.View
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =150
                    X: =4
                    ZIndex: =7

                TextInput_LW_ID_1 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.Identifier
                    DisplayMode: =DisplayMode.View
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =277
                    X: =342
                    ZIndex: =8

                Image_Photo_12 As image:
                    Height: =30
                    Image: =ThisItem.Photograph
                    OnSelect: |-
                        =Set(ShowPhoto,ThisItem.Photograph.Full);
                        Set(WhereBack,"Approve");
                        Navigate(PhotoGraph);
                    Width: =177
                    X: =154
                    ZIndex: =9

            Label2_22 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="吊装人员姓名"
                Width: =155
                ZIndex: =2

            Label2_23 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件号"
                Width: =302
                X: =328
                ZIndex: =3

            Label2_88 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件照片"
                Width: =173
                X: =155
                ZIndex: =4

        Container_LiftingNew_14 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label2_24.Height+Gallery5_12.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =7

            "Gallery5_12 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =If(Self.AllItemsCount=0,1,Self.AllItemsCount)*30
                Items: =Filter(TPL_InfoGathering,ProjID=Text(SearchID),PhotoType="吊装指挥人员信息")
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =30
                Width: =630
                Y: =31
                ZIndex: =1

                TextInput_LW_Commander_1 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.Name
                    DisplayMode: =DisplayMode.View
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =147
                    X: =4
                    ZIndex: =7

                TextInput_LW_CommanderID_1 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.Identifier
                    DisplayMode: =DisplayMode.View
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =277
                    X: =342
                    ZIndex: =8

                Image_Photo_13 As image:
                    Height: =30
                    Image: =ThisItem.Photograph
                    OnSelect: |-
                        =Set(ShowPhoto,ThisItem.Photograph.Full);
                        Set(WhereBack,"Approve");
                        Navigate(PhotoGraph);
                    Width: =180
                    X: =151
                    ZIndex: =9

            Label2_24 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="指挥人员"
                Width: =155
                ZIndex: =2

            Label2_25 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件号"
                Width: =302
                X: =328
                ZIndex: =3

            Label2_89 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件照片"
                Width: =173
                X: =155
                ZIndex: =4

        Container_LiftingNew_15 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =135
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            PaddingBottom: =2
            PaddingTop: =2
            Width: =Parent.Width
            ZIndex: =8

            Label1_382 As label:
                FontWeight: =FontWeight.Bold
                Height: =25
                Size: =12
                Text: ="危害辨识"
                Width: =81
                Y: =25
                ZIndex: =1

            Label1_380 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="现场监护人:"
                Width: =95
                ZIndex: =5

            TextInput_OnSiteGuardian2_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Lifting).OnSiteGuardian
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =211
                X: =93
                ZIndex: =6

            TextInput_LWHazard1_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Lifting).LWHazard1
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =452
                X: =161
                Y: =51
                ZIndex: =7

            Label1_383 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="1）存在的危害因素:"
                Width: =160
                Y: =51
                ZIndex: =11

            Label1_384 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="2）可能导致的后果:"
                Width: =160
                Y: =75
                ZIndex: =12

            Label1_385 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="3）相应的管控措施:"
                Width: =160
                Y: =100
                ZIndex: =13

            TextInput_LWHazard2_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Lifting).LWHazard2
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =452
                X: =161
                Y: =75
                ZIndex: =14

            TextInput_LWHazard3_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Lifting).LWHazard3
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =452
                X: =161
                Y: =100
                ZIndex: =15

        Container_High_SC As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label1_452.Height+Label1_452.Y+5
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =9

            Label1_452 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="项目负责人确认:"
                Width: =138
                Y: =Gallery82.Y+Gallery82.Height
                ZIndex: =1

            TextInput1_130 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).ProjLeader
                DisplayMode: =DisplayMode.View
                Height: =25
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =461
                X: =138
                Y: =Gallery82.Y+Gallery82.Height
                ZIndex: =2

            "Gallery82 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                Default: =First(Self.AllItems)
                Height: |
                    =Sum(Int(ShowColumns(Self.AllItems,"Label_height_8")),Value)+Self.AllItemsCount*2
                Items: =Filter(Gal_LiftingWorkControl2,Not(IsBlank(Content)))
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                Selectable: =false
                TemplatePadding: =1
                TemplateSize: =Int(Label_height_8.Text)
                Width: =Parent.Width
                Y: =25
                ZIndex: =3

                Label_height_8 As label:
                    DisplayMode: =DisplayMode.View
                    Height: =13
                    OnSelect: =Select(Parent)
                    Size: =20
                    Text: =Title3_11.Height
                    Visible: =false
                    Width: =100
                    X: =40
                    ZIndex: =1

                Radio_PatrolTnspection_25 As radio:
                    BorderColor: =
                    Default: =Switch(ThisItem.Confirm,true,"是",false,"不适用")
                    DisplayMode: =DisplayMode.View
                    FocusedBorderColor: =
                    FocusedBorderThickness: =0
                    Height: =25
                    HoverColor: =
                    Items: =["是","不适用"]
                    Layout: =Layout.Horizontal
                    PaddingBottom: =0
                    PaddingTop: =0
                    PressedColor: =
                    RadioBorderColor: =RGBA(0, 13, 75, 1)
                    RadioSelectionFill: =RGBA(26, 26, 26, 1)
                    RadioSize: =15
                    Size: =12
                    Width: =155
                    Y: =6
                    ZIndex: =2

                Title3_11 As label:
                    AutoHeight: =true
                    Height: =20
                    OnSelect: =Select(Parent)
                    Size: =12
                    Text: =ThisItem.Content
                    Width: =460
                    X: =155
                    ZIndex: =3

            Label1_451 As label:
                FontWeight: =FontWeight.Bold
                Height: =25
                Size: =12
                Text: ="现场安全控制措施：项目负责人应同现场负责人对以上控制措施进行检查确认"
                Width: =559
                ZIndex: =4

        Label12_1 As label:
            Height: =0
            LayoutMinHeight: =70
            LayoutMinWidth: =560
            Size: =21
            Text: ="文本"
            Width: =Parent.Width
            ZIndex: =10

    Container_HighNew_4 As groupContainer.verticalAutoLayoutContainer:
        Height: =990
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        Visible: =If(Vis_Current="High",true,false)
        Width: =630
        X: =5
        Y: =46
        ZIndex: =12

        Container_HighNew_Title_1 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =100
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            Width: =630
            X: =5
            Y: =107
            ZIndex: =1

            Label3_23 As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =70
                Size: =21
                Text: |-
                    ="High Work Permit
                    高处作业许可证"
                Width: =560
                X: =36
                Y: =7
                ZIndex: =58

            Label3_24 As label:
                Align: =Align.Center
                Color: =RGBA(184, 0, 0, 1)
                FontWeight: =FontWeight.Semibold
                Height: =26
                Size: =10.5
                Text: ="高空作业定义：在坠落高度基准面2米以上（含2米）有可能坠落的高处进行的作业。"
                Width: =630
                Y: =74
                ZIndex: =59

            Image3_5 As image:
                Height: =80
                Image: ='1694500910899'
                Width: =97
                ZIndex: =60

        Container_HighNew_5 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label2_26.Height+Gallery5_13.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =2

            "Gallery5_13 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =If(Self.AllItemsCount=0,1,Self.AllItemsCount)*30
                Items: =Filter(TPL_InfoGathering,ProjID=Text(SearchID),PhotoType="登高作业人员信息")
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =30
                Width: =Parent.Width
                Y: =31
                ZIndex: =1

                TextInput_HW_Name_1 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.Name
                    DisplayMode: =DisplayMode.View
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    OnChange: =ThisItem.Name
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =144
                    X: =4
                    ZIndex: =7

                TextInput_HW_ID_1 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.Identifier
                    DisplayMode: =DisplayMode.View
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =296
                    X: =334
                    ZIndex: =8

                Image_Photo_11 As image:
                    Height: =30
                    Image: =ThisItem.Photograph
                    OnSelect: |-
                        =Set(ShowPhoto,ThisItem.Photograph.Full);
                        Set(WhereBack,"Approve");
                        Navigate(PhotoGraph);
                    Width: =186
                    X: =148
                    ZIndex: =9

            Label2_17 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="登高作业人员"
                Width: =155
                ZIndex: =2

            Label2_26 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件号"
                Width: =302
                X: =328
                ZIndex: =3

            Label2_87 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件照片"
                Width: =173
                X: =155
                ZIndex: =4

        Container_HighNew_6 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =335
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =630
            X: =5
            Y: =107
            ZIndex: =3

            Label1_395 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="施工内容描述:"
                Width: =112
                Y: =106
                ZIndex: =4

            Label1_397 As label:
                Height: =25
                Size: =12
                Text: ="危害辨识"
                Width: =80
                Y: =177
                ZIndex: =13

            Label1_388 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="作业单位:"
                Width: =80
                ZIndex: =14

            Label1_396 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="作业等级:"
                Width: =80
                Y: =152
                ZIndex: =16

            Label1_401 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="设备与工具:"
                Width: =95
                Y: =278
                ZIndex: =17

            Label1_389 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="现场监护人:"
                Width: =106
                Y: =26
                ZIndex: =31

            TextInput_OnSiteGuardian1_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_High).OnSiteGuardian
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =526
                X: =94
                Y: =25
                ZIndex: =34

            TextInput_OpUnit1_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_High).OpUnit
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =539
                X: =80
                ZIndex: =35

            TextInput_HWHazard1_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_High).HWHazard1
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =461
                X: =149
                Y: =202
                ZIndex: =38

            TextInput_HWOtherTools_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_High).HWOtherTools
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =529
                X: =81
                Y: =303
                ZIndex: =39

            Label1_390 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="作业地点:"
                Width: =80
                Y: =52
                ZIndex: =50

            TextInput_OpAr1_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_High).OpAr
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =539
                X: =80
                Y: =52
                ZIndex: =51

            TextInput_OpCountent1_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_High).OpCountent
                DisplayMode: =DisplayMode.View
                Height: =50
                MaxLength: =65
                Mode: =TextMode.MultiLine
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =500
                X: =110
                Y: =102
                ZIndex: =56

            Label1_398 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="1）存在的危害因素:"
                Width: =161
                Y: =202
                ZIndex: =58

            Label1_400 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="3）相应的管控措施:"
                Width: =161
                Y: =253
                ZIndex: =61

            TextInput_HWHazard2_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_High).HWHazard2
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =461
                X: =149
                Y: =228
                ZIndex: =62

            TextInput_HWHazard3_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_High).HWHazard3
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =461
                X: =149
                Y: =253
                ZIndex: =63

            Label1_402 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="其他设备:"
                Width: =80
                Y: =303
                ZIndex: =67

            Label1_393 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="开始时间:"
                Width: =80
                Y: =77
                ZIndex: =68

            Label1_391 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="结束时间:"
                Width: =80
                X: =317
                Y: =77
                ZIndex: =69

            TextInput_OpCountent3_8 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Text(First(Current_High).StartTime,"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                MaxLength: =35
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =237
                X: =80
                Y: =77
                ZIndex: =70

            TextInput_OpCountent3_9 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |-
                    =Text(First(Current_Normal).EndTime,"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                MaxLength: =35
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =213
                X: =397
                Y: =77
                ZIndex: =71

            TextInput_HWOtherTools_4 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_High).HWTools
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =525
                X: =97
                Y: =278
                ZIndex: =73

            TextInput_OpCountent1_4 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_High).HWLevel
                DisplayMode: =DisplayMode.View
                Height: =25
                MaxLength: =84
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =530
                X: =80
                Y: =152
                ZIndex: =74

            Label1_399 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="2）可能导致的后果:"
                Width: =161
                Y: =228
                ZIndex: =75

        Container_HighNew_7 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label1_403.Height+Label1_624.Height+Gallery8.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =4

            "Gallery8 As gallery.'BrowseLayout_Flexible_NewsFeed_ver5.0'":
                DelayItemLoading: =true
                Height: =Sum(Int(ShowColumns(Self.AllItems,"Label20")),Value)+Self.AllItemsCount*2
                Items: =Filter(Gal_HighWorkSafetyControl2,Not(IsBlank(Content)))
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =Int(Label20.Text)
                Width: =630
                Y: =Label1_403.Height
                ZIndex: =1

                Label19 As label:
                    AutoHeight: =true
                    Height: =
                    Size: =12
                    Text: =ThisItem.Content
                    VerticalAlign: =VerticalAlign.Top
                    Width: =462
                    X: =155
                    ZIndex: =3

                Radio_PatrolTnspection_16 As radio:
                    BorderColor: =
                    Default: =Switch(ThisItem.Confirm,true,"是",false,"不适用")
                    DisplayMode: =DisplayMode.View
                    FocusedBorderColor: =
                    FocusedBorderThickness: =0
                    Height: =27
                    HoverColor: =
                    Items: =["是","不适用"]
                    Layout: =Layout.Horizontal
                    PaddingBottom: =0
                    PaddingTop: =0
                    PressedColor: =
                    RadioBorderColor: =RGBA(0, 13, 75, 1)
                    RadioSelectionFill: =RGBA(26, 26, 26, 1)
                    RadioSize: =15
                    Size: =12
                    Width: =155
                    Y: =6
                    ZIndex: =4

                Label20 As label:
                    Height: =0
                    Size: =21
                    Text: =Label19.Height
                    Width: =52
                    ZIndex: =5

            Label1_404 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="项目负责人确认:"
                Width: =138
                Y: =Gallery8.Y+Gallery8.Height
                ZIndex: =1

            TextInput1_127 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).ProjLeader
                DisplayMode: =DisplayMode.View
                Height: =25
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =11
                Width: =461
                X: =138
                Y: =Gallery8.Y+Gallery8.Height
                ZIndex: =2

            Label1_403 As label:
                FontWeight: =FontWeight.Bold
                Height: =25
                Size: =12
                Text: ="现场安全控制措施：项目负责人应同现场负责人对以上控制措施进行检查确认"
                Width: =559
                ZIndex: =4

            Label1_624 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="项目负责人确认:"
                Width: =138
                Y: =Gallery8.Y+Gallery8.Height
                ZIndex: =5

            TextInput1_133 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).ProjLeader
                DisplayMode: =DisplayMode.View
                Height: =25
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =461
                X: =138
                Y: =Gallery8.Y+Gallery8.Height
                ZIndex: =6

        Label12 As label:
            Height: =0
            LayoutMinHeight: =70
            LayoutMinWidth: =560
            Size: =21
            Text: ="文本"
            Width: =Parent.Width
            ZIndex: =5

    Container_Normal As groupContainer.verticalAutoLayoutContainer:
        Height: =1010
        LayoutDirection: =LayoutDirection.Vertical
        LayoutGap: =2
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        Visible: =If(Vis_Current="Normal",true,false)
        Width: =630
        X: =5
        Y: =46
        ZIndex: =13

        Container_NormalNew_Title_1 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =80
            LayoutMinHeight: =80
            LayoutMinWidth: =250
            Width: =630
            X: =5
            Y: =107
            ZIndex: =2

            Label3_25 As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =76
                Size: =21
                Text: |-
                    ="Construction Permit
                    施工许可证"
                Width: =560
                X: =35
                ZIndex: =58

            Image3_4 As image:
                Height: =80
                Image: ='1694500910899'
                Width: =97
                ZIndex: =59

        Container_NormalNew_7 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =350
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =630
            X: =5
            Y: =107
            ZIndex: =3

            Label1_412 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="项目负责人:"
                Width: =100
                Y: =75
                ZIndex: =1

            Label1_156 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="作业单位:"
                Width: =100
                Y: =50
                ZIndex: =2

            Label1_408 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="开始时间:"
                Width: =100
                Y: =150
                ZIndex: =3

            Label1_419 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="施工内容描述:"
                Width: =120
                Y: =303
                ZIndex: =4

            Label1_418 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="特种许可:"
                Width: =100
                Y: =250
                ZIndex: =12

            Label1_413 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="联系方式:"
                Width: =100
                X: =308
                Y: =75
                ZIndex: =13

            Label1_406 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="作业单位负责人:"
                Width: =140
                Y: =100
                ZIndex: =14

            Label1_407 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="联系方式:"
                Width: =80
                X: =308
                Y: =100
                ZIndex: =15

            Label1_414 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="现场监护人:"
                Width: =100
                Y: =125
                ZIndex: =16

            Label1_416 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="作业区域:"
                Width: =100
                Y: =175
                ZIndex: =17

            Label1_415 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="联系方式:"
                Width: =100
                X: =308
                Y: =125
                ZIndex: =18

            Label1_417 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="主要设备/工具:"
                Width: =140
                Y: =200
                ZIndex: =19

            Label1_410 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="结束时间:"
                Width: =100
                X: =308
                Y: =150
                ZIndex: =31

            TextInput_OpUnit_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).OpUnit
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =508
                X: =105
                Y: =50
                ZIndex: =32

            "'TextInput_OpDirectorM/P_1' As text":
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).'OpDirectorM/P'
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =227
                X: =388
                Y: =100
                ZIndex: =34

            TextInput_OpDirector_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).OpDirector
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =179
                X: =120
                Y: =100
                ZIndex: =35

            TextInput_ProjLeder_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).ProjLeader
                DisplayMode: =DisplayMode.View
                Height: =25
                HintText: =""
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =198
                X: =105
                Y: =75
                ZIndex: =36

            "'TextInput_ProjLederM/P_1' As text":
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).'ProjLeaderM/P'
                DisplayMode: =DisplayMode.View
                Height: =25
                HintText: =""
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =227
                X: =388
                Y: =75
                ZIndex: =37

            TextInput_OnSiteGuardian_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).OnSiteGuardian
                DisplayMode: =DisplayMode.View
                Height: =25
                HintText: =""
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =198
                X: =105
                Y: =125
                ZIndex: =38

            "'TextInputTextInput_OnSiteGuardianM/P_1' As text":
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).'OnSiteGuardianM/P'
                DisplayMode: =DisplayMode.View
                Height: =25
                HintText: =""
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =227
                X: =388
                Y: =125
                ZIndex: =39

            TextInput_MainTools_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).MainTools
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Tooltip: =First(Current_Normal).MainTools
                Width: =493
                X: =120
                Y: =200
                ZIndex: =41

            TextInput_OpCountent_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).OpCountent
                DisplayMode: =DisplayMode.View
                Height: =50
                MaxLength: =65
                Mode: =TextMode.MultiLine
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =510
                X: =120
                Y: =300
                ZIndex: =44

            Label1_420 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="是否需要巡检:"
                Width: =120
                Y: =275
                ZIndex: =54

            TextInput_OpAr_1 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).OpAr
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                HintText: ="详细区域"
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =304
                X: =309
                Y: =175
                ZIndex: =60

            Label1_405 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="申请部门:"
                Width: =100
                Y: =25
                ZIndex: =62

            Dropdown_AppliDept_1 As dropdown:
                BorderStyle: =BorderStyle.None
                ChevronBackground: =RGBA(0, 0, 0, 0)
                ChevronFill: =RGBA(39, 67, 125, 1)
                Default: =
                DisplayMode: =DisplayMode.View
                Height: =25
                Items: =Current_Normal.ApplicationDept
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                Size: =12
                Width: =198
                X: =105
                Y: =25
                ZIndex: =63

            TextInput_OpUnit_3 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).OtherLicenses
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =493
                X: =120
                Y: =250
                ZIndex: =73

            TextInput_OpCountent_4 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =Switch(First(Current_Normal).IsPatrol,true,"是",false,"否")
                DisplayMode: =DisplayMode.View
                Height: =25
                MaxLength: =30
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =45
                X: =120
                Y: =275
                ZIndex: =74

            TextInput_OpCountent3_6 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |
                    =Text(First(Current_Normal).StartTime,"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                MaxLength: =35
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =204
                X: =105
                Y: =150
                ZIndex: =75

            TextInput_OpCountent3_7 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: |
                    =Text(First(Current_Normal).EndTime,"yyyy/mm/dd hh:mm")
                DisplayMode: =DisplayMode.View
                Height: =25
                MaxLength: =35
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =242
                X: =388
                Y: =150
                ZIndex: =76

            Label1_189 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="项目编号:"
                Width: =100
                ZIndex: =79

            TextInput_ProjLeder_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).ProjID
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                HintText: =""
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =198
                X: =105
                ZIndex: =80

            Label1_191 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="项目名称:"
                Width: =100
                X: =308
                ZIndex: =81

            TextInput_OpUnit_8 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).ProjName
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =25
                HintText: =""
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =225
                X: =388
                ZIndex: =82

            TextInput_OpUnit_4 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).OpDept
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =204
                X: =105
                Y: =175
                ZIndex: =83

            Label1_424 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="其他协作人员:"
                Width: =120
                Y: =225
                ZIndex: =84

            TextInput_MainTools_2 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =First(Current_Normal).OtherCoWoker
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Tooltip: =First(Current_Normal).MainTools
                Width: =478
                X: =120
                Y: =225
                ZIndex: =85

            Label1_485 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="是否备案:"
                Width: =100
                X: =309
                Y: =275
                ZIndex: =86

            TextInput_OpCountent_5 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Default: =Switch(First(Current_Normal).IsBackUp,true,"是",false,"否")
                DisplayMode: =DisplayMode.View
                Height: =25
                MaxLength: =30
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =45
                X: =388
                Y: =275
                ZIndex: =87

        Container_NormalData As groupContainer.manualLayoutContainer:
            FillPortions: =0
            Height: =Label1_traning.Height+Gallery7.Height+Label1_traning_1.Height+Gallery7_1.Height+Gallery7.AllItemsCount*2+Gallery7_1.AllItemsCount*2
            LayoutMinHeight: =150
            LayoutMinWidth: =250
            Width: =630
            ZIndex: =4

            "Gallery7_1 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                DelayItemLoading: =true
                Height: =Self.AllItemsCount*25
                Items: |-
                    =Filter(Sort('Licenses File',ID,SortOrder.Descending),StartsWith('File name with extension',SearchID&"_DiscloseInformation"))
                    
                    
                    // =SearchID&"_"
                    
                    //
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =25
                Width: =618
                Y: =Label1_traning.Height+Gallery7.Height+Label1_traning_1.Height
                ZIndex: =1

                Title6_1 As label:
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =25
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.Title
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 112
                    X: =96
                    Y: =
                    ZIndex: =2

                Body1_1 As label:
                    FontWeight: =FontWeight.Lighter
                    Height: =25
                    OnSelect: =Launch(ThisItem.'Link to item')
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.'File name with extension'
                    Underline: =true
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 32
                    X: =16
                    ZIndex: =4

            Label1_traning_1 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="交底材料 (点击跳转查看) :"
                Width: =286
                Y: =Label1_traning.Height+Gallery7.Height
                ZIndex: =2

            "Gallery7 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                DelayItemLoading: =true
                Height: =Self.AllItemsCount*25
                Items: |+
                    =Filter(Sort('Licenses File',ID,SortOrder.Descending),StartsWith('File name with extension',SearchID&"_TrainingPhoto"))
                    
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =25
                Width: =618
                Y: =Label1_traning.Height
                ZIndex: =3

                Title6 As label:
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =Self.Size * 1.8
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.Title
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 112
                    X: =96
                    Y: =
                    ZIndex: =2

                Body1 As label:
                    FontWeight: =FontWeight.Lighter
                    Height: =25
                    OnSelect: =Launch(ThisItem.'Link to item')
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.'File name with extension'
                    Underline: =true
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 32
                    X: =16
                    ZIndex: =4

            Label1_traning As label:
                Height: =25
                Size: =12
                Text: |-
                    ="培训照片 (点击跳转查看) :"
                Width: =286
                ZIndex: =4

        Container_Normal_Msg As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label2_27.Height+Gallery5_14.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            PaddingBottom: =1
            PaddingTop: =1
            Visible: =If(IsEmpty(Filter(TPL_InfoGathering,PhotoType="其他证件"&&ProjID=Text(SearchID))),false,true)
            Width: =Parent.Width
            ZIndex: =5

            "Gallery5_14 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =If(Self.AllItemsCount=0,1,Self.AllItemsCount)*30
                Items: =Filter(TPL_InfoGathering,PhotoType="其他证件"&&ProjID=Text(SearchID))
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =30
                Width: =630
                Y: =31
                ZIndex: =1

                Image_Photo_1 As image:
                    Height: =30
                    Image: =ThisItem.Photograph
                    OnSelect: |-
                        =Set(ShowPhoto,ThisItem.Photograph.Full);
                        Set(WhereBack,"Approve");
                        Navigate(PhotoGraph);
                    Width: =340
                    X: =290
                    ZIndex: =3

                Label13 As label:
                    Align: =Align.Center
                    Height: =30
                    OnSelect: =Select(Parent)
                    Size: =12
                    Text: =ThisItem.Name
                    Width: =290
                    ZIndex: =4

            Label2_27 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="作业人员"
                Width: =289
                ZIndex: =2

            Label2_91 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="证件照片"
                Width: =340
                X: =289
                ZIndex: =4

        Container_NormalSchemaHot As groupContainer.manualLayoutContainer:
            FillPortions: =0
            Height: =Label1_traning_2.Height+Gallery7_2.Height+Gallery7_2.AllItemsCount*2
            LayoutMinHeight: =150
            LayoutMinWidth: =250
            Visible: |-
                =//Gallery7_2.AllItemsCount<>0
                false
            Width: =630
            ZIndex: =6

            "Gallery7_2 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                DelayItemLoading: =true
                Height: =Self.AllItemsCount*25
                Items: |-
                    =Filter(Sort('Licenses File',ID,SortOrder.Descending),StartsWith('File name with extension',SearchID&"_CSHotWork"))
                    
                    
                    // =SearchID&"_"
                    
                    //
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =25
                Width: =618
                Y: =Label1_traning_2.Height
                ZIndex: =3

                Title6_2 As label:
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =25
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.Title
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 112
                    X: =96
                    Y: =
                    ZIndex: =2

                Body1_2 As label:
                    FontWeight: =FontWeight.Lighter
                    Height: =25
                    OnSelect: =Launch(ThisItem.'Link to item')
                    PaddingLeft: =0
                    PaddingRight: =0
                    Text: =ThisItem.'File name with extension'
                    Underline: =true
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 32
                    X: =16
                    ZIndex: =4

            Label1_traning_2 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="动火作业施工方案 (点击跳转查看) :"
                Width: =467
                ZIndex: =4

        Container_NormalSchemaLifting As groupContainer.manualLayoutContainer:
            FillPortions: =0
            Height: =Label1_traning_4.Height+Gallery7_4.Height+Gallery7_4.AllItemsCount*2
            LayoutMinHeight: =150
            LayoutMinWidth: =250
            Visible: |-
                =//Gallery7_4.AllItemsCount<>0
                false
            Width: =630
            ZIndex: =7

            "Gallery7_4 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                DelayItemLoading: =true
                Height: =Self.AllItemsCount*25
                Items: |-
                    =Filter('Licenses File',StartsWith('File name with extension',SearchID&"_CSLiftingWork"))
                    
                    
                    // =SearchID&"_"
                    
                    //
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =25
                Width: =618
                Y: =Label1_traning_4.Height
                ZIndex: =3

                Title6_4 As label:
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =25
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.Title
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 112
                    X: =96
                    Y: =
                    ZIndex: =2

                Body1_4 As label:
                    FontWeight: =FontWeight.Lighter
                    Height: =25
                    OnSelect: =Launch(ThisItem.'Link to item')
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.'File name with extension'
                    Underline: =true
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 32
                    X: =16
                    ZIndex: =4

            Label1_traning_4 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="吊装作业施工方案 (点击跳转查看) :"
                Width: =463
                ZIndex: =4

        Container_NormalSchemaHigh As groupContainer.manualLayoutContainer:
            FillPortions: =0
            Height: =Label1_traning_3.Height+Gallery7_3.Height+Gallery7_3.AllItemsCount*2
            LayoutMinHeight: =150
            LayoutMinWidth: =250
            Visible: |-
                =//Gallery7_3.AllItemsCount<>0
                false
            Width: =630
            ZIndex: =8

            "Gallery7_3 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                DelayItemLoading: =true
                Height: =Self.AllItemsCount*25
                Items: |-
                    =Filter('Licenses File',StartsWith('File name with extension',SearchID&"_CSHighWork"))
                    
                    
                    // =SearchID&"_"
                    
                    //
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =25
                Width: =618
                Y: =Label1_traning_3.Height
                ZIndex: =3

                Title6_3 As label:
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =25
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.Title
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 112
                    X: =96
                    Y: =
                    ZIndex: =2

                Body1_3 As label:
                    FontWeight: =FontWeight.Lighter
                    Height: =25
                    OnSelect: =Launch(ThisItem.'Link to item')
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.'File name with extension'
                    Underline: =true
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 32
                    X: =16
                    ZIndex: =4

            Label1_traning_3 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="登高作业施工方案 (点击跳转查看) :"
                Width: =507
                ZIndex: =4

        Container_NormalSchemaSpace As groupContainer.manualLayoutContainer:
            FillPortions: =0
            Height: =Label1_traning_5.Height+Gallery7_5.Height+Gallery7_5.AllItemsCount*2
            LayoutMinHeight: =150
            LayoutMinWidth: =250
            Visible: |-
                =//Gallery7_5.AllItemsCount<>0
                false
            Width: =630
            ZIndex: =9

            "Gallery7_5 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                DelayItemLoading: =true
                Height: =Self.AllItemsCount*25
                Items: |-
                    =Filter(Sort('Licenses File',ID,SortOrder.Descending),StartsWith('File name with extension',SearchID&"_CSConfinedSpaceWork"))
                    
                    
                    // =SearchID&"_"
                    
                    //
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =25
                Width: =618
                Y: =Label1_traning_5.Height
                ZIndex: =3

                Title6_5 As label:
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =25
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.Title
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 112
                    X: =96
                    Y: =
                    ZIndex: =2

                Body1_5 As label:
                    FontWeight: =FontWeight.Lighter
                    Height: =25
                    OnSelect: =Launch(ThisItem.'Link to item')
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.'File name with extension'
                    Underline: =true
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 32
                    X: =16
                    ZIndex: =4

            Label1_traning_5 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="有限空间作业施工方案 (点击跳转查看) :"
                Width: =577
                ZIndex: =4

        Container_NormalSchemaEle As groupContainer.manualLayoutContainer:
            FillPortions: =0
            Height: =Label1_traning_6.Height+Gallery7_6.Height+Gallery7_6.AllItemsCount*2
            LayoutMinHeight: =150
            LayoutMinWidth: =250
            Visible: |-
                =//Gallery7_6.AllItemsCount<>0
                false
            Width: =630
            ZIndex: =10

            "Gallery7_6 As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
                DelayItemLoading: =true
                Height: =Self.AllItemsCount*25
                Items: |-
                    =Filter(Sort('Licenses File',ID,SortOrder.Descending),StartsWith('File name with extension',SearchID&"_CSTemporaryElectricityWork"))
                    
                    
                    // =SearchID&"_"
                    
                    //
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =25
                Width: =618
                Y: =Label1_traning_6.Height
                ZIndex: =3

                Title6_6 As label:
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =25
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.Title
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 112
                    X: =96
                    Y: =
                    ZIndex: =2

                Body1_6 As label:
                    FontWeight: =FontWeight.Lighter
                    Height: =25
                    OnSelect: =Launch(ThisItem.'Link to item')
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.'File name with extension'
                    Underline: =true
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 32
                    X: =16
                    ZIndex: =4

            Label1_traning_6 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="临时用电作业施工方案 (点击跳转查看) :"
                Width: =566
                ZIndex: =4

        Container_Normal_Appr As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =If(Gallery1.Height=0,Label1_425.Height,Gallery1.Height)+If(Gallery1_1.Height=0,Label1_423.Height,Gallery1_1.Height)+Label1_421.Height+30
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            PaddingBottom: =30
            PaddingTop: =3
            Width: =630
            X: =5
            Y: =107
            ZIndex: =11

            Label1_421 As label:
                Height: =25
                Size: =12
                Text: ="申请部门负责人意见："
                Width: =176
                ZIndex: =1

            Label1_423 As label:
                Height: =25
                Size: =12
                Text: ="作业区域负责人意见："
                Width: =176
                Y: =25
                ZIndex: =2

            Label1_425 As label:
                Height: =25
                Size: =12
                Text: ="是否需其他部门会签："
                Width: =176
                Y: =If(Gallery1_1.Height=0,Label1_423.Height,Gallery1_1.Height)+Label1_421.Height
                ZIndex: =3

            Label1_426 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="EHS意见:"
                Width: =94
                Y: =If(Gallery1.Height=0,Label1_425.Height,Gallery1.Height)+If(Gallery1_1.Height=0,Label1_423.Height,Gallery1_1.Height)+Label1_421.Height
                ZIndex: =4

            Label1_422 As label:
                Height: =25
                Size: =12
                Text: |-
                    =//同意，显示同意&空白不显示&其他则为拒绝的内容
                    If(First(Current_Normal).ApplLeaderView="同意","同意"&"  [ "&First(Current_Normal).ApplLeaderName&" ]",
                    If(IsBlank(First(Current_Normal).ApplLeaderView)=true,"","拒绝:"&First(Current_Normal).ApplLeaderView&"  [ "&First(Current_Normal).ApplLeaderName&" ]"))
                    
                    
                    //&"【"&First(Current_Normal).ApplLeaderName&"】"
                Width: =313
                X: =164
                ZIndex: =5

            DatePicker_APPD As datepicker:
                DefaultDate: =First(Current_Normal).ApplLeaderDate
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Format: ="yyyy/mm/dd"
                Height: =25
                PaddingLeft: =5
                PaddingTop: =5
                Size: =12
                Visible: |-
                    =//无数据就不显示
                    If(IsBlank(First(Current_Normal).ApplLeaderDate),false,true)
                Width: =109
                X: =520
                ZIndex: =6

            DatePicker_OPA As datepicker:
                DefaultDate: =First(Current_Normal).OpALeaderDate
                DisplayMode: =DisplayMode.View
                Format: ="yyyy/mm/dd"
                Height: =25
                PaddingLeft: =5
                PaddingTop: =5
                Size: =12
                Visible: |-
                    =//无数据就不显示
                    If(IsBlank(First(Current_Normal).OpALeaderDate),false,true)
                Width: =110
                X: =520
                Y: =26
                ZIndex: =7

            Btn_ApproverAgree_3 As button:
                BorderThickness: =1
                DisplayMode: =
                FocusedBorderThickness: =1
                FontWeight: =FontWeight.Normal
                Height: =28
                OnSelect: |+
                    =Switch(Personal_Identity,
                    "OtherDeptLeader",//会签部门负责人
                    ForAll(Filter(OtherDeptMsg,(isMine=true||AmIBackup=true)&&View="待审批") As A,
                       If(!IsBlank(A.YesOrNo),
                          Switch(A.Dept,
                          "生产",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{OtherProduce:A.YesOrNo,OtherDeptApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDeptApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDept,"生产",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDeptApprovalName,"生产",PersonalMsg.UserName))}),
                          "印前",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{OtherPrepress:A.YesOrNo,OtherDeptApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDeptApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDept,"印前",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDeptApprovalName,"印前",PersonalMsg.UserName))}),
                          "印刷",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{OtherPrint:A.YesOrNo,OtherDeptApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDeptApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDept,"印刷",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDeptApprovalName,"印刷",PersonalMsg.UserName))}),
                          "复合",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{OtherComposite:A.YesOrNo,OtherDeptApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDeptApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDept,"复合",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDeptApprovalName,"复合",PersonalMsg.UserName))}),
                          "分切",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{OtherCutting:A.YesOrNo,OtherDeptApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDeptApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDept,"分切",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDeptApprovalName,"分切",PersonalMsg.UserName))}),
                          "维修",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{OtherMaintenance:A.YesOrNo,OtherDeptApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDeptApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDept,"维修",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDeptApprovalName,"维修",PersonalMsg.UserName))}),
                          "仓库",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{OtherWarehouse:A.YesOrNo,OtherDeptApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDeptApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDept,"仓库",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDeptApprovalName,"仓库",PersonalMsg.UserName))}),
                          "质量",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{OtherQuality:A.YesOrNo,OtherDeptApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDeptApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDept,"质量",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDeptApprovalName,"质量",PersonalMsg.UserName))}),
                          "WCM",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{OtherWCM:A.YesOrNo,OtherDeptApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDeptApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDept,"WCM",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDeptApprovalName,"WCM",PersonalMsg.UserName))}),
                          "CBRE",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{OtherCBRE:A.YesOrNo,OtherDeptApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDeptApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDept,"CBRE",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OtherDeptApprovalName,"CBRE",PersonalMsg.UserName))})
                          );Refresh(TPL_NormalLicence),
                          Error("请选择！"))
                    ),
                    "OpADeptLeader",//区域负责人
                         If(!IsEmpty(Filter(HoaApprovalMsg,(isMine=true||AmIBackup=true)&&View="待审批"&&YesOrNo="")),
                         Notify("请选择！", NotificationType.Error),//没选择弹出错误提示
                         //如果拒绝
                         Set(Vis_ApproveWhich,"Agree")
                    ));
                    
                    
                    
                    Switch(Personal_Identity,
                    "OtherDeptLeader",
                    //刷新会签部门信息
                    Refresh(TPL_NormalLicence);
                    ClearCollect(Current_Normal,Filter(TPL_NormalLicence,ProjID=SearchID));
                    ClearCollect(OtherDeptMsg
                    ,{Dept:"生产",View:First(Current_Normal).OtherProduce,isMine:If("生产" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"生产" in Hod)).HodBackup}
                    ,{Dept:"印前",View:First(Current_Normal).OtherPrepress,isMine:If("印前" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"印前" in Hod)).HodBackup}
                    ,{Dept:"印刷",View:First(Current_Normal).OtherPrint,isMine:If("印刷" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"印刷" in Hod)).HodBackup}
                    ,{Dept:"复合",View:First(Current_Normal).OtherComposite,isMine:If("复合" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"复合" in Hod)).HodBackup}
                    ,{Dept:"分切",View:First(Current_Normal).OtherCutting,isMine:If("分切" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"分切" in Hod)).HodBackup}
                    ,{Dept:"维修",View:First(Current_Normal).OtherMaintenance,isMine:If("维修" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"维修" in Hod)).HodBackup}
                    ,{Dept:"仓库",View:First(Current_Normal).OtherWarehouse,isMine:If("仓库" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"仓库" in Hod)).HodBackup}
                    ,{Dept:"质量",View:First(Current_Normal).OtherQuality,isMine:If("质量" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"质量" in Hod)).HodBackup}
                    ,{Dept:"WCM",View:First(Current_Normal).OtherWCM,isMine:If("WCM" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"WCM" in Hod)).HodBackup}
                    ,{Dept:"CBRE",View:First(Current_Normal).OtherCBRE,isMine:If("CBRE" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"CBRE" in Hod)).HodBackup});
                    );
                    
                    
                    
                    //统计会签部门审批状态
                    
                    Switch(Personal_Identity,
                    "OtherDeptLeader",//会签部门负责人
                    If(!("待审批" in Concat(OtherDeptMsg,View,";")),
                      If("拒绝" in Concat(OtherDeptMsg,View,";"),
                        Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{OtherDeptTotalView:"拒绝",ProjState:"已拒绝"}),
                        Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{OtherDeptTotalView:"同意"});
                        If(First(Filter(List_Login,Email=PersonalMsg.Email)).HasAccount=false&&(PersonalMsg.Email in First(Filter(List_Login,"CBRE" in Hod)).HodBackup||PersonalMsg.Email in First(Filter(List_Login,"CBRE" in Hoa)).HoaBackup||
                    PersonalMsg.Email = First(Filter(List_Login,"CBRE" in Hod)).Email||PersonalMsg.Email = First(Filter(List_Login,"CBRE" in Hoa)).Email),TPL_RAFA_WithoutAccount.Run(SearchID),TPL_RemindApprovalFromApp.Run(SearchID))
                        ),
                          If("拒绝" in Concat(OtherDeptMsg,View,";"),
                        Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{OtherDeptTotalView:"拒绝",ProjState:"已拒绝"})
                        )
                    ),
                    "OpADeptLeader",//区域负责人
                    If(!("待审批" in Concat(HoaApprovalMsg,View,";")),
                      If("拒绝" in Concat(HoaApprovalMsg,View,";"),
                        Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{OpALeaderView:"拒绝",OpALeaderDate:Today(),ProjState:"已拒绝"}),
                        Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{OpALeaderView:"同意",OpALeaderDate:Today()})
                        ),
                          If("拒绝" in Concat(HoaApprovalMsg,View,";"),
                        Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{OpALeaderView:"拒绝",OpALeaderDate:Today(),ProjState:"已拒绝"})
                        )
                    )
                    );
                    
                    
                    Refresh(TPL_NormalLicence);
                    ClearCollect(Current_Normal,Filter(TPL_NormalLicence,ProjID=SearchID));
                    //(可以在表中找到我&该施工单的 申请部门 包含在我负责的部门中||我是申请部门负责人的备用负责人之一)&申请部门负责人意见为空（如果是审批人设置可见并设置身份）
                    If(
                        (PersonalMsg.Email in First(Filter(TPL_Login,First(Current_Normal).ApplicationDept in Hod)).HodBackup
                    ||(Not(IsEmpty(Filter(List_Login,Email=PersonalMsg.Email)))&&First(Current_Normal).ApplicationDept in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod))
                    &&IsBlank(First(Current_Normal).ApplLeaderView),
                    Set(Personal_Identity,"ApplDeptLeader"),
                    //申请部门负责人意见为同意&区域负责人意见为空&（施工单的 区域负责人 包含在我负责的区域中||我是区域负责人负责部门的备用负责人之一）
                    If(First(Current_Normal).ApplLeaderView="同意"
                    &&IsBlank(First(Current_Normal).OpALeaderView)
                    &&(!IsEmpty(Filter(HoaApprovalMsg,View="待审批"&&isMine=true))
                    ||!IsEmpty(Filter(HoaApprovalMsg,View="待审批"&&AmIBackup=true))),
                    Set(Personal_Identity,"OpADeptLeader"),
                    //需要其他部门会签&审批总状态为空白&(存在部门未审批并且isMine=true||存在部门未审批并且我是区域负责人负责部门的备用负责人之一)
                    If(First(Current_Normal).IsOtherDept=true
                    &&!IsBlank(First(Current_Normal).OpALeaderView)  //区域审批总状态不为空
                    &&IsBlank(First(Current_Normal).OtherDeptTotalView)
                    &&(!IsEmpty(Filter(OtherDeptMsg,View="待审批"&&isMine=true))
                    ||!IsEmpty(Filter(OtherDeptMsg,View="待审批"&&AmIBackup=true))),
                    Set(Personal_Identity,"OtherDeptLeader"),
                    //判断EHS 
                    If(!IsBlank(First(Current_Normal).OtherDeptTotalView)  //OtherDeptTotalView=同意/无需
                    &&IsBlank(First(Current_Normal).EHSView)   //EHS意见为空
                    &&First(Current_Normal).ProjState<>"已拒绝"
                    &&("EHS" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod//我是EHS负责人
                    ||PersonalMsg.Email in First(Filter(List_Login,"EHS" in Hod)).HodBackup), //我是EHS备用负责人
                    Set(Personal_Identity,"EHSLeader"),
                    
                    //判断厂长
                    If(First(Current_Normal).NeedFactorDire//需要厂长
                    &&(First(Filter(List_Login,Email=PersonalMsg.Email)).IsFactoryDirector//我是厂长
                    &&First(Filter(List_Login,Email=PersonalMsg.Email)).FactoryName=First(Current_Normal).FactoryName)//我是该厂长
                    &&!IsBlank(First(Current_Normal).EHSView)//EHS意见不为空
                    &&IsBlank(First(Current_Normal).FactoryDirector),//厂长意见为空
                    Set(Personal_Identity,"FactoryDirector"),
                    Set(Personal_Identity,"Normal")
                    )))));
                    //Radio_OtherApprove.SelectedText,
                    
                    
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Text: ="提交"
                Visible: =Personal_Identity="OtherDeptLeader"||Personal_Identity="OpADeptLeader"
                Width: =96
                X: =520
                Y: =Gallery1.Y+Gallery1.Height
                ZIndex: =8

            Label1_610 As label:
                Height: =25
                Size: =12
                Text: |-
                    =//同意，显示同意&空白不显示&其他则为拒绝的内容
                    If(First(Current_Normal).EHSView="同意","同意"&"  [ "&First(Current_Normal).EHSName&" ]",
                    If(IsBlank(First(Current_Normal).EHSView)=true,"","拒绝:"&First(Current_Normal).EHSView&"  [ "&First(Current_Normal).EHSName&" ]"))
                Width: =313
                X: =78
                Y: =If(Gallery1.Height=0,Label1_425.Height,Gallery1.Height)+Gallery1.Y
                ZIndex: =9

            DatePicker_OPA_1 As datepicker:
                DefaultDate: =First(Current_Normal).EHSDate
                DisplayMode: =DisplayMode.View
                Format: ="yyyy/mm/dd"
                Height: =25
                PaddingLeft: =5
                PaddingTop: =5
                Size: =12
                Visible: |-
                    =//无数据就不显示
                    If(IsBlank(First(Current_Normal).EHSDate),false,true)
                Width: =110
                X: =520
                Y: =If(Gallery1.Height=0,Label1_425.Height,Gallery1.Height)+If(Gallery1_1.Height=0,Label1_423.Height,Gallery1_1.Height)+Label1_421.Height
                ZIndex: =10

            "Gal_OtherApproverName As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                DelayItemLoading: =true
                Height: =Self.AllItemsCount*25
                Items: =Split(First(Current_Normal).OtherDeptApprovalName,";")
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                Selectable: =If(Not(Personal_Identity="Normal"),true,false)
                TemplatePadding: =0
                TemplateSize: =25
                Visible: |-
                    =!IsEmpty(Filter(OtherDeptMsg,!IsBlank(View)))
                    //If(First(Current_Normal).OpALeaderView="同意",true,false)
                Width: =159
                X: =273
                Y: =If(Gallery1_1.Height=0,Label1_423.Height,Gallery1_1.Height)+Label1_421.Height
                ZIndex: =11

                Title2_3 As label:
                    FontWeight: =If(Personal_Identity="OtherDeptMsg",FontWeight.Semibold)
                    Height: =25
                    OnSelect: =Select(Parent)
                    Size: =12
                    Text: ="  [ "&ThisItem.Value&" ]"
                    Visible: |-
                        =If(ThisItem.Value<>"生产"&&ThisItem.Value<>"印前"&&ThisItem.Value<>"印刷"&&
                        ThisItem.Value<>"复合"&&ThisItem.Value<>"分切"&&ThisItem.Value<>"维修"&&ThisItem.Value<>"仓库"&&
                        ThisItem.Value<>"质量"&&ThisItem.Value<>"WCM"&&ThisItem.Value<>"EHS"&&ThisItem.Value<>"CBRE",
                        true,false)
                    Width: =159
                    ZIndex: =2

            "Gal_ApproverName As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                DelayItemLoading: =true
                Height: =Self.AllItemsCount*25
                Items: =Split(First(Current_Normal).HoaApprovalName,";")
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                Selectable: =If(Not(Personal_Identity="Normal"),true,false)
                TemplatePadding: =0
                TemplateSize: =25
                Visible: |-
                    =//If(IsBlank(First(Current_Normal).ApplLeaderView)||First(Current_Normal).ProjState="已拒绝",false,true)
                    If(IsBlank(First(Current_Normal).ApplLeaderView)||"拒绝" in Label1_422.Text,false,true)
                Width: =159
                X: =273
                Y: =25
                ZIndex: =12

                Title2_2 As label:
                    FontWeight: =If(Personal_Identity="OpADeptLeader",FontWeight.Semibold)
                    Height: =23
                    OnSelect: =Select(Parent)
                    Size: =12
                    Text: ="  [ "&ThisItem.Value&" ]"
                    Visible: |-
                        =If(ThisItem.Value<>"生产"&&ThisItem.Value<>"印前"&&ThisItem.Value<>"印刷"&&
                        ThisItem.Value<>"复合"&&ThisItem.Value<>"分切"&&ThisItem.Value<>"维修"&&ThisItem.Value<>"仓库"&&
                        ThisItem.Value<>"质量"&&ThisItem.Value<>"WCM"&&ThisItem.Value<>"EHS"&&ThisItem.Value<>"CBRE",
                        true,false)
                    Width: =159
                    ZIndex: =2

            "Gallery1_1 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                DelayItemLoading: =true
                Height: =Self.AllItemsCount*25
                Items: |
                    =SortByColumns(Filter(HoaApprovalMsg,!IsBlank(View)),"Dept",["CBRE","EHS","WCM","仓库","分切","印刷","印前","复合"])
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                Selectable: =If(Not(Personal_Identity="Normal"),true,false)
                TemplatePadding: =0
                TemplateSize: =25
                Visible: |-
                    =//If(IsBlank(First(Current_Normal).ApplLeaderView)||First(Current_Normal).ProjState="已拒绝",false,true)
                    If(IsBlank(First(Current_Normal).ApplLeaderView)||"拒绝" in Label1_422.Text,false,true)
                Width: =412
                X: =152
                Y: =25
                ZIndex: =13

                Title2_1 As label:
                    FontWeight: =If(Personal_Identity="OpADeptLeader",FontWeight.Semibold)
                    Height: =25
                    OnSelect: =Select(Parent)
                    Size: =12
                    Text: =ThisItem.Dept
                    Width: =52
                    X: =11
                    ZIndex: =2

                Subtitle2_1 As label:
                    Height: =25
                    OnSelect: =Select(Parent)
                    Text: =ThisItem.View
                    Width: =73
                    X: =63
                    ZIndex: =3

                Radio_OtherApprove_1 As radio:
                    BorderColor: =
                    Default: =ThisItem.YesOrNo
                    FocusedBorderColor: =
                    FocusedBorderThickness: =0
                    Height: =26
                    HoverColor: =
                    Items: =["同意","拒绝"]
                    Layout: =Layout.Horizontal
                    OnSelect: |-
                        =Patch(HoaApprovalMsg,ThisItem,{YesOrNo:Radio_OtherApprove_1.Selected.Value})
                    PaddingBottom: =0
                    PaddingTop: =0
                    PressedColor: =
                    RadioSize: =24
                    Size: =11
                    Visible: =(ThisItem.isMine||ThisItem.AmIBackup)&&ThisItem.View="待审批"&&Not(Personal_Identity="Normal")&&First(Current_Normal).ProjState<>"已拒绝"&&First(Current_Normal).ApplLeaderView="同意"
                    Width: =193
                    X: =219
                    ZIndex: =7

            "Gallery1 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                DelayItemLoading: =true
                Height: =Self.AllItemsCount*25
                Items: |-
                    =
                    Filter(SortByColumns(OtherDeptMsg,"Dept",["CBRE","EHS","WCM","仓库","分切","印刷","印前","复合"]),!IsBlank(View))
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                Selectable: =If(Not(Personal_Identity="Normal"),true,false)
                TemplatePadding: =0
                TemplateSize: =25
                Visible: |-
                    =!IsEmpty(Filter(OtherDeptMsg,!IsBlank(View)))
                    //If(First(Current_Normal).OpALeaderView="同意",true,false)
                Width: =412
                X: =152
                Y: =If(Gallery1_1.Height=0,Label1_423.Height,Gallery1_1.Height)+Label1_421.Height
                ZIndex: =14

                Title2 As label:
                    FontWeight: =If(Personal_Identity="OtherDeptMsg",FontWeight.Semibold)
                    Height: =25
                    OnSelect: =Select(Parent)
                    Size: =12
                    Text: =ThisItem.Dept
                    Width: =71
                    X: =11
                    ZIndex: =2

                Subtitle2 As label:
                    Height: =25
                    OnSelect: =Select(Parent)
                    Text: =ThisItem.View
                    Visible: =!IsBlank(First(Current_Normal).OpALeaderView)//作业区域负责人审批了才出现
                    Width: =75
                    X: =63
                    ZIndex: =3

                Radio_OtherApprove As radio:
                    BorderColor: =
                    Default: =ThisItem.YesOrNo
                    FocusedBorderColor: =
                    FocusedBorderThickness: =0
                    Height: =26
                    HoverColor: =
                    Items: =["同意","拒绝"]
                    Layout: =Layout.Horizontal
                    OnSelect: |-
                        =Patch(OtherDeptMsg,ThisItem,{YesOrNo:Radio_OtherApprove.Selected.Value})
                    PaddingBottom: =0
                    PaddingTop: =0
                    PressedColor: =
                    RadioSize: =24
                    Size: =11
                    Visible: |-
                        =(ThisItem.isMine||ThisItem.AmIBackup)&&ThisItem.View="待审批"&&Not(Personal_Identity="Normal")
                        &&!IsBlank(First(Current_Normal).OpALeaderView)//作业区域负责人还没审批
                    Width: =193
                    X: =219
                    ZIndex: =7

            Label1_427 As label:
                Height: =25
                Size: =12
                Text: =First(Current_Normal).OtherDeptTotalView
                Visible: =Gallery1.AllItemsCount=0&&!IsBlank(First(Current_Normal).OpALeaderView)
                Width: =54
                X: =163
                Y: =If(Gallery1_1.Height=0,Label1_423.Height,Gallery1_1.Height)+Label1_421.Height
                ZIndex: =15

        Container_Normal_FactoryDirector As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =29
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            PaddingBottom: =2
            PaddingTop: =2
            Visible: =First(Current_Normal).NeedFactorDire
            Width: =630
            X: =5
            Y: =107
            ZIndex: =12

            Label1_626 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="厂长意见（涉及一级动火）:"
                Width: =207
                Y: =2
                ZIndex: =61

            Label1_627 As label:
                Height: =25
                Size: =12
                Text: |-
                    =//同意，显示同意&空白不显示&其他则为拒绝的内容
                    If(First(Current_Normal).FactoryDirector="同意","同意",
                    If(IsBlank(First(Current_Normal).FactoryDirector)=true,"","拒绝:"&First(Current_Normal).FactoryDirector))
                Width: =298
                X: =207
                Y: =2
                ZIndex: =77

            DatePicker_APPD_1 As datepicker:
                DefaultDate: =First(Current_Normal).FactoryDirectorTime
                DisplayMode: =DisplayMode.View
                Format: ="yyyy/mm/dd"
                Height: =25
                PaddingLeft: =5
                PaddingTop: =5
                Size: =12
                Visible: |-
                    =//无数据就不显示
                    If(IsBlank(First(Current_Normal).FactoryDirectorTime),false,true)
                Width: =110
                X: =520
                Y: =2
                ZIndex: =78

        Container_Normal_SecurityStuff As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =29
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            PaddingBottom: =2
            PaddingTop: =2
            Width: =630
            X: =5
            Y: =107
            ZIndex: =13

            Label1_633 As label:
                Height: =25
                Size: =12
                Text: ="施工牌号（保安提供）："
                Width: =189
                Y: =3
                ZIndex: =1

            Button1 As button:
                Height: =25
                OnSelect: |-
                    =Switch(Personal_Identity,
                    "SubSecurity",
                    If(IsBlank(TextInput7.Text),Notify("施工牌号不能为空",NotificationType.Error),
                    Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{ConstructionPlateID:TextInput7.Text,ProjState:"审批通过"});
                    Refresh(TPL_NormalLicence);ClearCollect(Current_Normal,Filter(TPL_NormalLicence,ProjID=SearchID));
                    
                    Set(Personal_Identity,"normal")
                    
                    ))
                RadiusBottomLeft: =1
                RadiusBottomRight: =1
                RadiusTopLeft: =1
                RadiusTopRight: =1
                Size: =12
                Text: ="提交"
                Visible: |-
                    =
                    If(//需要厂长且厂长意见不为空且施工牌号为空
                        ((First(Current_Normal).NeedFactorDire=true&&!IsBlank(First(Current_Normal).FactoryDirector)&&IsBlank(First(Current_Normal).ConstructionPlateID))
                        //不需要厂长意见且EHS意见不为空且施工牌号为空
                    ||(First(Current_Normal).NeedFactorDire=false&&!IsBlank(First(Current_Normal).EHSView)&&IsBlank(First(Current_Normal).ConstructionPlateID)))
                    &&Personal_Identity="SubSecurity"
                    ,
                    true,false)
                Width: =93
                X: =520
                Y: =2
                ZIndex: =2

            TextInput7 As text:
                BorderColor: =RGBA(214, 221, 224, 1)
                BorderThickness: =1
                Default: =If(IsBlank(First(Current_Normal).ConstructionPlateID),"",First(Current_Normal).ConstructionPlateID)
                DisplayMode: |-
                    =
                    If(//需要厂长且厂长意见不为空且施工牌号为空
                        ((First(Current_Normal).NeedFactorDire=true&&!IsBlank(First(Current_Normal).FactoryDirector)&&IsBlank(First(Current_Normal).ConstructionPlateID))
                        //不需要厂长意见且EHS意见不为空且施工牌号为空
                    ||(First(Current_Normal).NeedFactorDire=false&&!IsBlank(First(Current_Normal).EHSView)&&IsBlank(First(Current_Normal).ConstructionPlateID)))
                    &&Personal_Identity="SubSecurity"
                    ,DisplayMode.Edit,DisplayMode.View)
                Height: =27
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =12
                Width: =318
                X: =189
                Y: =1
                ZIndex: =4

        Container_Normal_FirePatrol As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =130
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Visible: ="Hot" in First(Current_Normal).OtherLicenses
            Width: =630
            X: =5
            Y: =107
            ZIndex: =14

            Label1_628 As label:
                FontWeight: =FontWeight.Bold
                Height: =25
                PaddingTop: =3
                Size: =12
                Text: ="防火巡视/热加工操作区监控："
                VerticalAlign: =VerticalAlign.Top
                Width: =264
                ZIndex: =61

            Label1_629 As label:
                Height: =102
                PaddingTop: =3
                Size: =12
                Text: |-
                    ="➢ 在整个施工期间，对热加工完成后，现场监护人必须进行防火巡视，时间为：
                     室外：30分钟持续性监视           除仓库外车间等区域：1小时持续性监视，后1小时间断性监视     仓库，1小时持续性监视，后2小时间断性监视
                    ➢ 防火巡视人必须具备使用灭火器材的能力
                    ➢ 防火巡视需要包括热加工区域上下方的邻近区域"
                VerticalAlign: =VerticalAlign.Top
                Width: =620
                Y: =25
                ZIndex: =75

        Container_PatrolSee As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label2_69.Height+Gallery_Patrol.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Visible: |
                =If(IsEmpty(Filter(TPL_Patrol,ProjID=SearchID,LicenceType="Normal")),false,Switch(TextInput_OpCountent_4.Text,"是",true,"否",false))
            Width: =Parent.Width
            ZIndex: =15

            "Gallery_Patrol As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =If(Self.AllItemsCount=0,1,Self.AllItemsCount)*30
                Items: =Filter(TPL_Patrol,ProjID=SearchID,LicenceType="Normal")
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =30
                Width: =630
                Y: =31
                ZIndex: =1

                TextInput1_9 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.InspectionStaff
                    DisplayMode: =DisplayMode.View
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =98
                    ZIndex: =7

                TextInput_PatrolTime As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: |
                        =Text(DateTimeValue(ThisItem.InspectionTime),"yyyy/mm/dd hh:mm")
                    DisplayMode: =DisplayMode.View
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =331
                    X: =98
                    ZIndex: =8

                Image_Photo_9 As image:
                    Height: =30
                    Image: =ThisItem.InspectionPhoto
                    OnSelect: |-
                        =Set(ShowPhoto,ThisItem.InspectionPhoto.Full);
                        Set(WhereBack,"Approve");
                        Navigate(PhotoGraph);
                    Width: =198
                    X: =429
                    ZIndex: =11

            Label2_69 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="巡检人"
                Width: =101
                ZIndex: =2

            Label2_70 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="巡检时间"
                Width: =321
                X: =101
                ZIndex: =3

            Label2_93 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="巡检照片"
                Width: =207
                X: =422
                ZIndex: =5

        Container_PatrolAdd As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Label2_70.Height+Gallery_PatrolAdd.Height+Btn_SubPatrol.Height+15
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Visible: |-
                =If(Personal_Identity="Patrol",true,false)
                //First(Current_Normal).IsPatrol
            Width: =Parent.Width
            ZIndex: =16

            Btn_SubPatrol As button:
                BorderThickness: =1
                FocusedBorderThickness: =1
                FontWeight: =FontWeight.Normal
                Height: =28
                OnSelect: |-
                    =ForAll(Gal_NormalPatrolNew,
                    If(ThisRecord.InspectionPhoto<>SampleImage,
                    Patch(TPL_Patrol,{ProjID:SearchID,LicenceType:"Normal",InspectionStaff:ThisRecord.InspectionStaff,InspectionPhoto:ThisRecord.InspectionPhoto,InspectionTime:ThisRecord.InspectionTime})));
                    
                    //刷新许可证信息
                    ClearCollect(Current_Normal,Filter(TPL_NormalLicence,ProjID=SearchID));
                    ClearCollect(Current_High,Filter(TPL_HighWork,ProjID=SearchID));
                    ClearCollect(Current_Lifting,Filter(TPL_LiftingWork,ProjID=SearchID));
                    ClearCollect(Current_ConfinedSpace,Filter(TPL_ConfinedSpaceWork,ProjID=SearchID));
                    ClearCollect(Current_Hot,Filter(TPL_HotWork,ProjID=SearchID));
                    ClearCollect(Current_TemporaryElectricity,Filter(TPL_TemporaryElectricityUseWork,ProjID=SearchID));
                    ClearCollect(Gal_NormalPatrolNew,{InspectionStaff:"",InspectionTime:DateTime(Year(First(Current_Normal).StartTime),Month(First(Current_Normal).StartTime),Day(First(Current_Normal).StartTime),Hour(First(Current_Normal).StartTime),Minute(First(Current_Normal).StartTime),0),InspectionPhoto:SampleImage});
                    
                    
                    Refresh(TPL_Patrol);
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Text: ="提交"
                Width: =117
                X: =483
                Y: =Label2_74.Height+Gallery_PatrolAdd.Height+10
                ZIndex: =1

            "Gallery_PatrolAdd As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =Self.AllItemsCount*30
                Items: =Gal_NormalPatrolNew
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =30
                Width: =630
                Y: =31
                ZIndex: =2

                TextInput1_11 As text:
                    Align: =Align.Center
                    BorderStyle: =BorderStyle.None
                    Default: =ThisItem.InspectionStaff
                    DisplayMode: =DisplayMode.View
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =12
                    Width: =98
                    ZIndex: =2

                Image_Photo_10 As image:
                    Height: =30
                    Image: =ThisItem.InspectionPhoto
                    OnSelect: |-
                        =Set(ShowPhoto,ThisItem.InspectionPhoto);
                        Set(WhereBack,"Approve");
                        Navigate(PhotoGraph);
                    Width: =204
                    X: =424
                    ZIndex: =3

                TakePhoto_5 As icon.Camera:
                    Height: =30
                    Icon: =Icon.Camera
                    OnSelect: |-
                        =Set(Gal_PatrolID,Gallery_PatrolAdd.Selected);
                        Set(Camera_Type,"CollectPatrolNew");
                        Navigate(Camera)
                        
                        //Set(Camera_MsgID,Gallery5_2.Selected);
                        //Set(Camera_Type,"CollectLWMsg");
                        //Navigate(Camera)
                    Visible: =If(ThisItem.InspectionPhoto=SampleImage,true,false)
                    Width: =45
                    X: =544
                    ZIndex: =4

                Icon4_24 As icon.Cancel:
                    Height: =18
                    Icon: =Icon.Cancel
                    OnSelect: =Remove(Gal_NormalPatrolNew,ThisItem)
                    Width: =20
                    X: =601
                    Y: =6
                    ZIndex: =5

                DatePicker_PatrolDate As datepicker:
                    BorderColor: =RGBA(136, 160, 209, 1)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    Color: =/*If(isTimeWrong=true,Color.DarkRed,RGBA(0, 0, 0, 1))*/
                    DefaultDate: =ThisItem.InspectionTime
                    DisabledFill: =RGBA(255, 255, 255, 1)
                    Format: ="yyyy/mm/dd"
                    Height: =30
                    OnChange: |
                        =If(DateValue(DatePicker_PatrolDate.SelectedDate)+Time(Int(Dropdown_PatrolHour.Selected.Value),Int(Dropdown_PatrolMinute.Selected.Value),0)<First(Current_Normal).StartTime||
                        DateValue(DatePicker_PatrolDate.SelectedDate)+Time(Int(Dropdown_PatrolHour.Selected.Value),Int(Dropdown_PatrolMinute.Selected.Value),0)>First(Current_Normal).EndTime
                        ,
                        Patch(Gal_NormalPatrolNew,ThisItem,{InspectionTime:DateTime(Year(First(Current_Normal).StartTime),Month(First(Current_Normal).StartTime),Day(First(Current_Normal).StartTime),Hour(First(Current_Normal).StartTime),Minute(First(Current_Normal).StartTime),0)});Reset(DatePicker_PatrolDate);Reset(Dropdown_PatrolHour);Reset(Dropdown_PatrolMinute)
                        ,
                        Patch(Gal_NormalPatrolNew,ThisItem,{InspectionTime:DateValue(DatePicker_PatrolDate.SelectedDate)+Time(Int(Dropdown_PatrolHour.Selected.Value),Int(Dropdown_PatrolMinute.Selected.Value),0)}))
                        
                        //Patch(Gal_HW_NameID,ThisItem,{ID:Self.Text});
                    PaddingLeft: =5
                    PaddingTop: =5
                    Reset: =true
                    Size: =12
                    Width: =146
                    X: =117
                    ZIndex: =7

                Label1_250 As label:
                    Height: =30
                    Size: =12
                    Text: |-
                        =":"
                    Width: =18
                    X: =341
                    ZIndex: =8

                Dropdown_PatrolHour As dropdown:
                    BorderStyle: =BorderStyle.None
                    Color: =/*If(isTimeWrong=true,Color.DarkRed,RGBA(0, 0, 0, 1))*/
                    Default: =Hour(ThisItem.InspectionTime)
                    DisabledFill: =RGBA(255, 255, 255, 1)
                    Height: =30
                    Items: |-
                        =["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15",
                        "16","17","18","19","20","21","22","23"]
                    OnChange: |
                        =
                        If(DateValue(DatePicker_PatrolDate.SelectedDate)+Time(Int(Dropdown_PatrolHour.Selected.Value),Int(Dropdown_PatrolMinute.Selected.Value),0)<First(Current_Normal).StartTime||
                        DateValue(DatePicker_PatrolDate.SelectedDate)+Time(Int(Dropdown_PatrolHour.Selected.Value),Int(Dropdown_PatrolMinute.Selected.Value),0)>First(Current_Normal).EndTime
                        ,
                        Patch(Gal_NormalPatrolNew,ThisItem,{InspectionTime:DateTime(Year(First(Current_Normal).StartTime),Month(First(Current_Normal).StartTime),Day(First(Current_Normal).StartTime),Hour(First(Current_Normal).StartTime),Minute(First(Current_Normal).StartTime),0)});Reset(DatePicker_PatrolDate);Reset(Dropdown_PatrolHour);Reset(Dropdown_PatrolMinute)
                        ,
                        Patch(Gal_NormalPatrolNew,ThisItem,{InspectionTime:DateValue(DatePicker_PatrolDate.SelectedDate)+Time(Int(Dropdown_PatrolHour.Selected.Value),Int(Dropdown_PatrolMinute.Selected.Value),0)}))
                        
                        //Patch(Gal_HW_NameID,ThisItem,{ID:Self.Text});
                    PaddingBottom: =5
                    PaddingLeft: =5
                    PaddingRight: =5
                    PaddingTop: =5
                    Reset: =true
                    Size: =12
                    Width: =78
                    X: =263
                    ZIndex: =9

                Dropdown_PatrolMinute As dropdown:
                    BorderStyle: =BorderStyle.None
                    Color: =/*If(isTimeWrong=true,Color.DarkRed,RGBA(0, 0, 0, 1))*/
                    Default: |
                        =Minute(ThisItem.InspectionTime)
                    DisabledFill: =RGBA(255, 255, 255, 1)
                    Height: =30
                    Items: =["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"]
                    OnChange: |
                        =
                        
                        If(DateValue(DatePicker_PatrolDate.SelectedDate)+Time(Int(Dropdown_PatrolHour.Selected.Value),Int(Dropdown_PatrolMinute.Selected.Value),0)<First(Current_Normal).StartTime||
                        DateValue(DatePicker_PatrolDate.SelectedDate)+Time(Int(Dropdown_PatrolHour.Selected.Value),Int(Dropdown_PatrolMinute.Selected.Value),0)>First(Current_Normal).EndTime
                        ,
                        Patch(Gal_NormalPatrolNew,ThisItem,{InspectionTime:DateTime(Year(First(Current_Normal).StartTime),Month(First(Current_Normal).StartTime),Day(First(Current_Normal).StartTime),Hour(First(Current_Normal).StartTime),Minute(First(Current_Normal).StartTime),0)});Reset(Gallery_PatrolAdd)
                        ,
                        Patch(Gal_NormalPatrolNew,ThisItem,{InspectionTime:DateValue(DatePicker_PatrolDate.SelectedDate)+Time(Int(Dropdown_PatrolHour.Selected.Value),Int(Dropdown_PatrolMinute.Selected.Value),0)}))
                        
                        //Patch(Gal_HW_NameID,ThisItem,{ID:Self.Text});
                    PaddingBottom: =5
                    PaddingLeft: =5
                    PaddingRight: =5
                    PaddingTop: =5
                    Reset: =true
                    Size: =12
                    Width: =76
                    X: =351
                    ZIndex: =11

            Label2_72 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="巡检人"
                Width: =101
                ZIndex: =3

            Label2_73 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="巡检时间"
                Width: =278
                X: =101
                ZIndex: =4

            Label2_74 As label:
                Align: =Align.Center
                Fill: =RGBA(227, 234, 243, 1)
                Height: =30
                Size: =12
                Text: ="巡检照片"
                Width: =251
                X: =379
                ZIndex: =5

            Icon1_32 As icon.Add:
                Color: =RGBA(255, 255, 255, 1)
                FocusedBorderThickness: =5
                Height: =30
                Icon: =Icon.Add
                OnSelect: |
                    =Collect(Gal_NormalPatrolNew,{InspectionStaff:"",InspectionTime:DateTime(Year(First(Current_Normal).StartTime),Month(First(Current_Normal).StartTime),Day(First(Current_Normal).StartTime),Hour(First(Current_Normal).StartTime),Minute(First(Current_Normal).StartTime),0),InspectionPhoto:SampleImage})
                Width: =30
                X: =584
                ZIndex: =6

        Container_NormalNew_CompConf As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =130
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Visible: =Switch(Personal_Identity,"Confirm",true,true)
            Width: =630
            X: =5
            Y: =107
            ZIndex: =17

            Label1_431 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="项目负责人确认:"
                VerticalAlign: =VerticalAlign.Top
                Width: =133
                Y: =45
                ZIndex: =51

            Label1_430 As label:
                Height: =25
                Size: =12
                Text: ="日期："
                VerticalAlign: =VerticalAlign.Top
                Width: =68
                X: =405
                Y: =45
                ZIndex: =52

            Label1_432 As label:
                Height: =25
                Size: =12
                Text: ="时间："
                VerticalAlign: =VerticalAlign.Top
                Width: =66
                X: =406
                Y: =69
                ZIndex: =53

            Label1_429 As label:
                FontWeight: =FontWeight.Bold
                Height: =46
                Italic: =true
                PaddingRight: =15
                Size: =12
                Text: ="完工确认：作业完毕后，对现场进行确认，包括工具是否遗留、垃圾是否清理、现场是否有破坏或其他安全隐患等。"
                VerticalAlign: =VerticalAlign.Top
                Width: =630
                ZIndex: =55

            Label1_435 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="保安确认:"
                Width: =80
                Y: =99
                ZIndex: =58

            Label1_436 As label:
                Height: =25
                Size: =12
                Text: |-
                    ="是否归还:"
                Width: =82
                X: =266
                Y: =99
                ZIndex: =62

            Label1_611 As label:
                Height: =25
                PaddingBottom: =0
                Size: =12
                Text: |-
                    =//同意，显示同意&空白不显示&其他则为拒绝的内容
                    If(IsBlank(First(Current_Normal).ProjLeaderConfirm),"",First(Current_Normal).ProjLeaderConfirm)
                VerticalAlign: =VerticalAlign.Top
                Width: =133
                X: =133
                Y: =45
                ZIndex: =64

            Label1_612 As label:
                Height: =25
                PaddingBottom: =0
                Size: =12
                Text: =Text(DateTimeValue(First(Current_Normal).ProjLeaderConfirmTime),"yyyy/mm/dd")
                VerticalAlign: =VerticalAlign.Top
                Width: =133
                X: =453
                Y: =45
                ZIndex: =65

            Label1_613 As label:
                Height: =25
                PaddingBottom: =0
                Size: =12
                Text: |-
                    =Text(DateTimeValue(First(Current_Normal).ProjLeaderConfirmTime),"hh:mm")
                VerticalAlign: =VerticalAlign.Top
                Width: =133
                X: =453
                Y: =69
                ZIndex: =66

            Label1_614 As label:
                Height: =25
                Size: =12
                Text: =If(IsBlank(First(Current_Normal).SecurityStaffConfirm),"",First(Current_Normal).SecurityStaffConfirm)
                Width: =133
                X: =80
                Y: =99
                ZIndex: =67

            TextInput1_98 As text:
                BorderColor: =RGBA(136, 160, 209, 1)
                BorderThickness: =1
                Default: =Switch(First(Current_Normal).IsReturn,true,"是",false,"否")
                DisplayMode: =DisplayMode.View
                Height: =25
                PaddingBottom: =7
                PaddingLeft: =5
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =12
                Width: =238
                X: =348
                Y: =99
                ZIndex: =68

        Label10 As label:
            Height: =1
            LayoutMinHeight: =70
            LayoutMinWidth: =560
            Size: =21
            Text: ="文本"
            Visible: =false
            Width: =Parent.Width
            ZIndex: =18

    Container_Agree As groupContainer.manualLayoutContainer:
        BorderThickness: =2
        Fill: =RGBA(255, 255, 255, 1)
        Height: =229
        Visible: =Switch(Vis_ApproveWhich,"Agree",true,"Refuse",false,"AskOtherDept",false)
        Width: =630
        X: =5
        Y: =409
        ZIndex: =14

        Label8_1 As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Semibold
            Height: =49
            Size: =18
            Text: ="是否确认"
            Width: =630
            Y: =40
            ZIndex: =1

        Btn_ApproverConfAgree As button:
            BorderThickness: =1
            FocusedBorderThickness: =1
            FontWeight: =FontWeight.Normal
            Height: =28
            OnSelect: |+
                =//同意后根据身份上传审批结果*申请负责人直接上传*区域负责人跳转询问是否会签再上传
                //设置显示窗口//设置身份
                Switch(Personal_Identity,
                "ApplDeptLeader",
                Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID = SearchID),{ApplLeaderView:"同意",ApplLeaderDate:Today(),ApplLeaderName:PersonalMsg.UserName});
                Set(Vis_ApproveWhich,"None");Set(Personal_Identity,"None");
                If(First(Filter(List_Login,Email=PersonalMsg.Email)).HasAccount=false&&(PersonalMsg.Email in First(Filter(List_Login,"CBRE" in Hod)).HodBackup||PersonalMsg.Email in First(Filter(List_Login,"CBRE" in Hoa)).HoaBackup|| PersonalMsg.Email = First(Filter(List_Login,"CBRE" in Hod)).Email||PersonalMsg.Email = First(Filter(List_Login,"CBRE" in Hoa)).Email),TPL_RAFA_WithoutAccount.Run(First(Current_Normal).ProjID),TPL_RemindApprovalFromApp.Run(First(Current_Normal).ProjID));,
                
                "OpADeptLeader",
                If("拒绝" in Concat(HoaApprovalMsg,YesOrNo,";"),     //选择后弹出确认框
                     Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{OpALeaderView:"拒绝",OpALeaderDate:Today(),ProjState:"已拒绝"});
                     ForAll(Filter(HoaApprovalMsg,(isMine=true||AmIBackup=true)&&View="待审批") As B,
                     If(!IsBlank(B.YesOrNo),
                      Switch(B.Dept,
                      "生产",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaProduce:Switch(B.YesOrNo,"同意","作业区域审批通过","拒绝","作业区域审批拒绝"),
                      HoaApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OpDept,"生产",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName,"生产",PersonalMsg.UserName))}),
                      "印前",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaPrepress:Switch(B.YesOrNo,"同意","作业区域审批通过","拒绝","作业区域审批拒绝"),
                      HoaApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OpDept,"印前",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName,"印前",PersonalMsg.UserName))}),
                      "印刷",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaPrint:Switch(B.YesOrNo,"同意","作业区域审批通过","拒绝","作业区域审批拒绝"),
                      HoaApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OpDept,"印刷",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName,"印刷",PersonalMsg.UserName))}),
                      "复合",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaComposite:Switch(B.YesOrNo,"同意","作业区域审批通过","拒绝","作业区域审批拒绝"),
                      HoaApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OpDept,"复合",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName,"复合",PersonalMsg.UserName))}),
                      "分切",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaCutting:Switch(B.YesOrNo,"同意","作业区域审批通过","拒绝","作业区域审批拒绝"),
                      HoaApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OpDept,"分切",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName,"分切",PersonalMsg.UserName))}),
                      "维修",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaMaintenance:Switch(B.YesOrNo,"同意","作业区域审批通过","拒绝","作业区域审批拒绝"),
                      HoaApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OpDept,"维修",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName,"维修",PersonalMsg.UserName))}),
                      "仓库",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaWarehouse:Switch(B.YesOrNo,"同意","作业区域审批通过","拒绝","作业区域审批拒绝"),
                      HoaApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OpDept,"仓库",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName,"仓库",PersonalMsg.UserName))}),
                      "质量",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaQuality:Switch(B.YesOrNo,"同意","作业区域审批通过","拒绝","作业区域审批拒绝"),
                      HoaApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OpDept,"质量",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName,"质量",PersonalMsg.UserName))}),
                      "WCM",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaWCM:Switch(B.YesOrNo,"同意","作业区域审批通过","拒绝","作业区域审批拒绝"),
                      HoaApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OpDept,"WCM",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName,"WCM",PersonalMsg.UserName))}),
                      "EHS",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaEHS:Switch(B.YesOrNo,"同意","作业区域审批通过","拒绝","作业区域审批拒绝"),
                      HoaApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OpDept,"EHS",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName,"EHS",PersonalMsg.UserName))}),
                      "CBRE",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaCBRE:Switch(B.YesOrNo,"同意","作业区域审批通过","拒绝","作业区域审批拒绝"),
                      HoaApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OpDept,"CBRE",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName,"CBRE",PersonalMsg.UserName))})
                      ));
                      Refresh(TPL_NormalLicence));
                      Set(Vis_ApproveWhich,"None");
                      //拒绝后刷新
                      Refresh(TPL_NormalLicence);
                ClearCollect(Current_Normal,Filter(TPL_NormalLicence,ProjID=SearchID));
                ClearCollect(HoaApprovalMsg
                ,{Dept:"生产",View:Switch(First(Current_Normal).HoaProduce,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("生产" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"生产" in Hoa)).HoaBackup}
                ,{Dept:"印前",View:Switch(First(Current_Normal).HoaPrepress,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("印前" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"印前" in Hoa)).HoaBackup}
                ,{Dept:"印刷",View:Switch(First(Current_Normal).HoaPrint,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("印刷" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"印刷" in Hoa)).HoaBackup}
                ,{Dept:"复合",View:Switch(First(Current_Normal).HoaComposite,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("复合" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"复合" in Hoa)).HoaBackup}
                ,{Dept:"分切",View:Switch(First(Current_Normal).HoaCutting,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("分切" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"分切" in Hoa)).HoaBackup}
                ,{Dept:"维修",View:Switch(First(Current_Normal).HoaMaintenance,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("维修" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"维修" in Hoa)).HoaBackup}
                ,{Dept:"仓库",View:Switch(First(Current_Normal).HoaWarehouse,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("仓库" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"仓库" in Hoa)).HoaBackup}
                ,{Dept:"质量",View:Switch(First(Current_Normal).HoaQuality,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("质量" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"质量" in Hoa)).HoaBackup}
                ,{Dept:"WCM",View:Switch(First(Current_Normal).HoaWCM,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("WCM" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"WCM" in Hoa)).HoaBackup}
                ,{Dept:"EHS",View:Switch(First(Current_Normal).HoaEHS,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("EHS" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"EHS" in Hoa)).HoaBackup}
                ,{Dept:"CBRE",View:Switch(First(Current_Normal).HoaCBRE,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("CBRE" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"CBRE" in Hoa)).HoaBackup});
                
                ,Set(Vis_ApproveWhich,"AskOtherDept"))
                /*;
                If(First(Filter(List_Login,Email=PersonalMsg.Email)).HasAccount=false&&(PersonalMsg.Email in First(Filter(List_Login,"CBRE" in Hod)).HodBackup||PersonalMsg.Email in First(Filter(List_Login,"CBRE" in Hoa)).HoaBackup|| PersonalMsg.Email = First(Filter(List_Login,"CBRE" in Hod)).Email||PersonalMsg.Email = First(Filter(List_Login,"CBRE" in Hoa)).Email),TPL_RAFA_WithoutAccount.Run(First(Current_Normal).ProjID),TPL_RemindApprovalFromApp.Run(First(Current_Normal).ProjID))*/
                ,
                
                "OtherDeptLeader",false;Set(Vis_ApproveWhich,"None"),
                
                "EHSLeader",
                Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID = SearchID),{EHSView:"同意",EHSDate:Today(),EHSName:PersonalMsg.UserName});Set(Vis_ApproveWhich,"None");Set(Personal_Identity,"None");
                If(First(Filter(List_Login,Email=PersonalMsg.Email)).HasAccount=false&&(PersonalMsg.Email in First(Filter(List_Login,"CBRE" in Hod)).HodBackup||PersonalMsg.Email in First(Filter(List_Login,"CBRE" in Hoa)).HoaBackup|| PersonalMsg.Email = First(Filter(List_Login,"CBRE" in Hod)).Email||PersonalMsg.Email = First(Filter(List_Login,"CBRE" in Hoa)).Email),TPL_RAFA_WithoutAccount.Run(First(Current_Normal).ProjID),TPL_RemindApprovalFromApp.Run(First(Current_Normal).ProjID)),
                
                "FactoryDirector",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID = SearchID),{FactoryDirector:"同意",FactoryDirectorTime:Today(),FactoryDirectorName:PersonalMsg.UserName});Set(Vis_ApproveWhich,"None");Set(Personal_Identity,"None");
                If(First(Filter(List_Login,Email=PersonalMsg.Email)).HasAccount=false&&(PersonalMsg.Email in First(Filter(List_Login,"CBRE" in Hod)).HodBackup||PersonalMsg.Email in First(Filter(List_Login,"CBRE" in Hoa)).HoaBackup|| PersonalMsg.Email = First(Filter(List_Login,"CBRE" in Hod)).Email||PersonalMsg.Email = First(Filter(List_Login,"CBRE" in Hoa)).Email),TPL_RAFA_WithoutAccount.Run(First(Current_Normal).ProjID),TPL_RemindApprovalFromApp.Run(First(Current_Normal).ProjID)),
                
                "Confirm",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID = SearchID),{ProjLeaderConfirm:"确认",ProjLeaderConfirmTime:Now()});Set(Vis_ApproveWhich,"None");Set(Personal_Identity,"None");
                If(First(Filter(List_Login,Email=PersonalMsg.Email)).HasAccount=false&&(PersonalMsg.Email in First(Filter(List_Login,"CBRE" in Hod)).HodBackup||PersonalMsg.Email in First(Filter(List_Login,"CBRE" in Hoa)).HoaBackup|| PersonalMsg.Email = First(Filter(List_Login,"CBRE" in Hod)).Email||PersonalMsg.Email = First(Filter(List_Login,"CBRE" in Hoa)).Email),TPL_RAFA_WithoutAccount.Run(First(Current_Normal).ProjID),TPL_RemindApprovalFromApp.Run(First(Current_Normal).ProjID)),
                
                "Security",Set(Vis_ApproveWhich,"AskSec")
                );
                
                /*"OtherDeptLeader",Patch(Gal_OtherDeptMsg,LookUp(Gal_OtherDeptMsg,Dept = PersonalDept),{View:"同意"});
                Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID = SearchID),{OtherDeptView:Concat(ShowColumns(Gal_OtherDeptMsg,"View"),View,";")});
                Set(Vis_ApproveWhich,"None"),*/
                
                //刷新表单
                Refresh(TPL_NormalLicence);
                ClearCollect(Current_Normal,Filter(TPL_NormalLicence,ProjID=SearchID));
                ClearCollect(Current_High,Filter(TPL_HighWork,ProjID=SearchID));
                ClearCollect(Current_Lifting,Filter(TPL_LiftingWork,ProjID=SearchID));
                ClearCollect(Current_ConfinedSpace,Filter(TPL_ConfinedSpaceWork,ProjID=SearchID));
                ClearCollect(Current_Hot,Filter(TPL_HotWork,ProjID=SearchID));
                ClearCollect(Current_TemporaryElectricity,Filter(TPL_TemporaryElectricityUseWork,ProjID=SearchID));
                
                //判断区域审批总状态
                /*Switch(Personal_Identity,
                "OpADeptLeader",
                If(!("待审批" in Concat(HoaApprovalMsg,View,";")),
                  If("拒绝" in Concat(HoaApprovalMsg,View,";"),
                    Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{OpALeaderView:"拒绝",OpALeaderDate:Today(),ProjState:"已拒绝"}),
                    Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{OpALeaderView:"同意",OpALeaderDate:Today()})
                    ),
                      If("拒绝" in Concat(HoaApprovalMsg,View,";"),
                    Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{OpALeaderView:"拒绝",OpALeaderDate:Today(),ProjState:"已拒绝"})
                    )
                ));
                */
                
                
                
                //申请部门负责人意见为同意&区域负责人意见为空&（施工单的 区域负责人 包含在我负责的区域中||我是区域负责人负责部门的备用负责人之一)
                
                
                
                //(可以在表中找到我&该施工单的 申请部门 包含在我负责的部门中||我是申请部门负责人的备用负责人之一)&申请部门负责人意见为空（如果是审批人设置可见并设置身份）
                If((PersonalMsg.Email in First(Filter(TPL_Login,First(Current_Normal).ApplicationDept in Hod)).HodBackup
                ||(Not(IsEmpty(Filter(List_Login,Email=PersonalMsg.Email)))&&First(Current_Normal).ApplicationDept in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod))&&IsBlank(First(Current_Normal).ApplLeaderView),
                Set(Personal_Identity,"ApplDeptLeader"),
                
                //申请部门负责人意见为同意&区域负责人意见为空&（施工单的 区域负责人 包含在我负责的区域中||我是区域负责人负责部门的备用负责人之一)
                If(First(Current_Normal).ApplLeaderView="同意"
                &&IsBlank(First(Current_Normal).OpALeaderView)
                &&(!IsEmpty(Filter(HoaApprovalMsg,View="待审批"&&isMine=true))
                ||!IsEmpty(Filter(HoaApprovalMsg,View="待审批"&&AmIBackup=true))),
                Set(Personal_Identity,"OpADeptLeader"),
                
                
                //需要其他部门会签&审批总状态为空白&(存在部门未审批并且isMine=true||存在部门未审批并且我是区域负责人负责部门的备用负责人之一)
                If(First(Current_Normal).IsOtherDept=true
                &&IsBlank(First(Current_Normal).OtherDeptTotalView)
                &&(!IsEmpty(Filter(OtherDeptMsg,View="待审批"&&isMine=true))
                ||!IsEmpty(Filter(OtherDeptMsg,View="待审批"&&AmIBackup=true))),
                Set(Personal_Identity,"OtherDeptLeader"),
                
                //判断EHS
                If(!IsBlank(First(Current_Normal).OtherDeptTotalView)  //OtherDeptTotalView=同意/无需
                &&IsBlank(First(Current_Normal).EHSView)   //EHS意见为空
                &&First(Current_Normal).ProjState<>"已拒绝"
                &&("EHS" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod//我是EHS负责人
                ||PersonalMsg.Email in First(Filter(List_Login,"EHS" in Hod)).HodBackup), //我是EHS备用负责人
                Set(Personal_Identity,"EHSLeader"),
                
                //判断厂长
                If(First(Current_Normal).NeedFactorDire//需要厂长
                &&(First(Filter(List_Login,Email=PersonalMsg.Email)).IsFactoryDirector//我是厂长
                &&First(Filter(List_Login,Email=PersonalMsg.Email)).FactoryName=First(Current_Normal).FactoryName)//我是该厂长
                &&!IsBlank(First(Current_Normal).EHSView)//EHS意见不为空
                &&IsBlank(First(Current_Normal).FactoryDirector),
                Set(Personal_Identity,"FactoryDirector"),//厂长意见为空
                
                //保安提供施工牌
                If(((First(Current_Normal).NeedFactorDire=true&&!IsBlank(First(Current_Normal).FactoryDirector))//需要厂长且厂长意见不为空
                ||(First(Current_Normal).NeedFactorDire=false&&!IsBlank(First(Current_Normal).EHSView))) //不需要厂长EHS意见不为空
                &&IsBlank(First(Current_Normal).ConstructionPlateID) //施工牌编号为空
                &&First(Current_Normal).ProjState<>"已拒绝"
                &&First(Filter(TPL_Login,PersonalMsg.Email=Email)).IsSecurityStaff=true, //我是保安
                Set(Personal_Identity,"SubSecurity"),
                
                //判断项目负责人
                If(First(Current_Normal).ProjState="审批通过"  //当前项目审批通过
                &&PersonalMsg.UserName=First(Current_Normal).ProjLeader  //我是项目负责人
                &&IsBlank(First(Current_Normal).ProjLeaderConfirm)  //ProjLeaderConfirm为空*项目负责人确认状态为空
                ,Set(Personal_Identity,"Confirm"),
                
                
                //判断保安
                If(!IsBlank(First(Current_Normal).ProjLeaderConfirm)  //ProjLeaderConfirm不为空*项目负责人确认状态不为空
                &&(IsBlank(First(Current_Normal).SecurityStaffConfirm)||(!IsBlank(First(Current_Normal).SecurityStaffConfirm)&&First(Current_Normal).IsReturn=false)) //SecurityStaffConfirm为空*保安状态为空
                &&First(Filter(TPL_Login,PersonalMsg.Email=Email)).IsSecurityStaff=true, //我是保安
                Set(Personal_Identity,"Security"),
                Set(Personal_Identity,"Normal")
                
                
                ))))))));
                
            RadiusBottomLeft: =2
            RadiusBottomRight: =2
            RadiusTopLeft: =2
            RadiusTopRight: =2
            Size: =12
            Text: ="确认"
            Width: =102
            X: =30
            Y: =160
            ZIndex: =3

        Btn_ApproverConfCancel As button:
            BorderThickness: =1
            Fill: =RGBA(116, 116, 116, 1)
            FocusedBorderThickness: =1
            FontWeight: =FontWeight.Normal
            Height: =28
            OnSelect: |-
                =//隐藏框
                Set(Vis_ApproveWhich,"None")
            RadiusBottomLeft: =2
            RadiusBottomRight: =2
            RadiusTopLeft: =2
            RadiusTopRight: =2
            Size: =12
            Text: ="取消"
            Width: =102
            X: =495
            Y: =160
            ZIndex: =4

    Container_Agree_OtherDept As groupContainer.manualLayoutContainer:
        BorderThickness: =2
        Fill: =RGBA(255, 255, 255, 1)
        Height: =229
        Visible: =Switch(Vis_ApproveWhich,"Agree",false,"Refuse",false,"AskOtherDept",true)
        Width: =630
        X: =5
        Y: =409
        ZIndex: =15

        Label8_2 As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Bold
            Height: =49
            Size: =14
            Text: ="是否需要其他部门会签？"
            Width: =630
            Y: =9
            ZIndex: =1

        Btn_ApproverConfAgree_1 As button:
            BorderThickness: =1
            FocusedBorderThickness: =1
            FontWeight: =FontWeight.Normal
            Height: =28
            OnSelect: |+
                =//如果不选择会签则弹出错误提示
                If(IsBlank(Radio_IsOtherDept.SelectedText.Value)
                ||(Radio_IsOtherDept.SelectedText.Value="是"&&IsEmpty(ComboBox_OtherDept.SelectedItems)),
                Error("请选择是否需要会签/会签部门！"),
                
                Switch(Personal_Identity,
                "OpADeptLeader",//区域负责人
                ForAll(Filter(HoaApprovalMsg,(isMine=true||AmIBackup=true)&&View="待审批") As B,
                   If(!IsBlank(B.YesOrNo),
                      Switch(B.Dept,
                      "生产",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaProduce:Switch(B.YesOrNo,"同意","作业区域审批通过","拒绝","作业区域审批拒绝"),
                      HoaApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OpDept,"生产",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName,"生产",PersonalMsg.UserName))}),
                      "印前",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaPrepress:Switch(B.YesOrNo,"同意","作业区域审批通过","拒绝","作业区域审批拒绝"),
                      HoaApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OpDept,"印前",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName,"印前",PersonalMsg.UserName))}),
                      "印刷",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaPrint:Switch(B.YesOrNo,"同意","作业区域审批通过","拒绝","作业区域审批拒绝"),
                      HoaApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OpDept,"印刷",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName,"印刷",PersonalMsg.UserName))}),
                      "复合",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaComposite:Switch(B.YesOrNo,"同意","作业区域审批通过","拒绝","作业区域审批拒绝"),
                      HoaApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OpDept,"复合",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName,"复合",PersonalMsg.UserName))}),
                      "分切",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaCutting:Switch(B.YesOrNo,"同意","作业区域审批通过","拒绝","作业区域审批拒绝"),
                      HoaApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OpDept,"分切",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName,"分切",PersonalMsg.UserName))}),
                      "维修",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaMaintenance:Switch(B.YesOrNo,"同意","作业区域审批通过","拒绝","作业区域审批拒绝"),
                      HoaApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OpDept,"维修",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName,"维修",PersonalMsg.UserName))}),
                      "仓库",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaWarehouse:Switch(B.YesOrNo,"同意","作业区域审批通过","拒绝","作业区域审批拒绝"),
                      HoaApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OpDept,"仓库",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName,"仓库",PersonalMsg.UserName))}),
                      "质量",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaQuality:Switch(B.YesOrNo,"同意","作业区域审批通过","拒绝","作业区域审批拒绝"),
                      HoaApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OpDept,"质量",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName,"质量",PersonalMsg.UserName))}),
                      "WCM",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaWCM:Switch(B.YesOrNo,"同意","作业区域审批通过","拒绝","作业区域审批拒绝"),
                      HoaApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OpDept,"WCM",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName,"WCM",PersonalMsg.UserName))}),
                      "EHS",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaEHS:Switch(B.YesOrNo,"同意","作业区域审批通过","拒绝","作业区域审批拒绝"),
                      HoaApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OpDept,"EHS",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName,"EHS",PersonalMsg.UserName))}),
                      "CBRE",Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{HoaCBRE:Switch(B.YesOrNo,"同意","作业区域审批通过","拒绝","作业区域审批拒绝"),
                      HoaApprovalName:If(IsBlank(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).OpDept,"CBRE",PersonalMsg.UserName),Substitute(First(Filter(TPL_NormalLicence,ProjID=SearchID)).HoaApprovalName,"CBRE",PersonalMsg.UserName))})
                      ));
                      Refresh(TPL_NormalLicence)
                      );
                      If(Switch(Radio_IsOtherDept.Selected.Value,"是",true,"否",false),
                     //需要会签
                          Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID = SearchID),
                          {IsOtherDept:true,
                          OtherProduce:If(IsBlank(First(Current_Normal).OtherProduce),If("生产" in Concat(ComboBox_OtherDept.SelectedItems,Value,";"),"待审批"),First(Current_Normal).OtherProduce),
                          OtherPrepress:If(IsBlank(First(Current_Normal).OtherPrepress),If("印前" in Concat(ComboBox_OtherDept.SelectedItems,Value,";"),"待审批"),First(Current_Normal).OtherPrepress),
                          OtherPrint:If(IsBlank(First(Current_Normal).OtherPrint),If("印刷" in Concat(ComboBox_OtherDept.SelectedItems,Value,";"),"待审批"),First(Current_Normal).OtherPrint),
                          OtherComposite:If(IsBlank(First(Current_Normal).OtherComposite),If("复合" in Concat(ComboBox_OtherDept.SelectedItems,Value,";"),"待审批"),First(Current_Normal).OtherComposite),
                          OtherCutting:If(IsBlank(First(Current_Normal).OtherCutting),If("分切" in Concat(ComboBox_OtherDept.SelectedItems,Value,";"),"待审批"),First(Current_Normal).OtherCutting),
                          OtherMaintenance:If(IsBlank(First(Current_Normal).OtherMaintenance),If("维修" in Concat(ComboBox_OtherDept.SelectedItems,Value,";"),"待审批"),First(Current_Normal).OtherMaintenance),
                          OtherWarehouse:If(IsBlank(First(Current_Normal).OtherWarehouse),If("仓库" in Concat(ComboBox_OtherDept.SelectedItems,Value,";"),"待审批"),First(Current_Normal).OtherWarehouse),
                          OtherQuality:If(IsBlank(First(Current_Normal).OtherQuality),If("质量" in Concat(ComboBox_OtherDept.SelectedItems,Value,";"),"待审批"),First(Current_Normal).OtherQuality),
                          OtherWCM:If(IsBlank(First(Current_Normal).OtherWCM),If("WCM" in Concat(ComboBox_OtherDept.SelectedItems,Value,";"),"待审批"),First(Current_Normal).OtherWCM),
                          OtherCBRE:If(IsBlank(First(Current_Normal).OtherCBRE),If("CBRE" in Concat(ComboBox_OtherDept.SelectedItems,Value,";"),"待审批"),First(Current_Normal).OtherCBRE)
                          }
                          ),
                          //无需会签
                          Refresh(TPL_NormalLicence);
                /*
                          If(First(Filter(List_Login,Email=PersonalMsg.Email)).HasAccount=false&&(PersonalMsg.Email in First(Filter(List_Login,"CBRE" in Hod)).HodBackup||PersonalMsg.Email in First(Filter(List_Login,"CBRE" in Hoa)).HoaBackup|| PersonalMsg.Email = First(Filter(List_Login,"CBRE" in Hod)).Email||PersonalMsg.Email = First(Filter(List_Login,"CBRE" in Hoa)).Email),TPL_RAFA_WithoutAccount.Run(First(Current_Normal).ProjID),TPL_RemindApprovalFromApp.Run(First(Current_Normal).ProjID));*/
                          
                          ClearCollect(Current_Normal,Filter(TPL_NormalLicence,ProjID=SearchID));
                          Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID = SearchID),
                          {IsOtherDept:If(First(Current_Normal).IsOtherDept=true,true,
                          Switch(Radio_IsOtherDept.Selected.Value,"是",true,"否",false))
                          })
                          ));
                
                
                //刷新表单
                Refresh(TPL_NormalLicence);
                ClearCollect(Current_Normal,Filter(TPL_NormalLicence,ProjID=SearchID));
                ClearCollect(Current_High,Filter(TPL_HighWork,ProjID=SearchID));
                ClearCollect(Current_Lifting,Filter(TPL_LiftingWork,ProjID=SearchID));
                ClearCollect(Current_ConfinedSpace,Filter(TPL_ConfinedSpaceWork,ProjID=SearchID));
                ClearCollect(Current_Hot,Filter(TPL_HotWork,ProjID=SearchID));
                ClearCollect(Current_TemporaryElectricity,Filter(TPL_TemporaryElectricityUseWork,ProjID=SearchID));
                
                //哪些会签部门需要审批&我是该会签部门审批人
                ClearCollect(OtherDeptMsg
                ,{Dept:"生产",View:First(Current_Normal).OtherProduce,isMine:If("生产" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"生产" in Hod)).HodBackup}
                ,{Dept:"印前",View:First(Current_Normal).OtherPrepress,isMine:If("印前" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"印前" in Hod)).HodBackup}
                ,{Dept:"印刷",View:First(Current_Normal).OtherPrint,isMine:If("印刷" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"印刷" in Hod)).HodBackup}
                ,{Dept:"复合",View:First(Current_Normal).OtherComposite,isMine:If("复合" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"复合" in Hod)).HodBackup}
                ,{Dept:"分切",View:First(Current_Normal).OtherCutting,isMine:If("分切" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"分切" in Hod)).HodBackup}
                ,{Dept:"维修",View:First(Current_Normal).OtherMaintenance,isMine:If("维修" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"维修" in Hod)).HodBackup}
                ,{Dept:"仓库",View:First(Current_Normal).OtherWarehouse,isMine:If("仓库" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"仓库" in Hod)).HodBackup}
                ,{Dept:"质量",View:First(Current_Normal).OtherQuality,isMine:If("质量" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"质量" in Hod)).HodBackup}
                ,{Dept:"WCM",View:First(Current_Normal).OtherWCM,isMine:If("WCM" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"WCM" in Hod)).HodBackup}
                ,{Dept:"CBRE",View:First(Current_Normal).OtherCBRE,isMine:If("CBRE" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"CBRE" in Hod)).HodBackup});
                //区域负责人审批表
                ClearCollect(HoaApprovalMsg
                ,{Dept:"生产",View:Switch(First(Current_Normal).HoaProduce,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("生产" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"生产" in Hoa)).HoaBackup}
                ,{Dept:"印前",View:Switch(First(Current_Normal).HoaPrepress,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("印前" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"印前" in Hoa)).HoaBackup}
                ,{Dept:"印刷",View:Switch(First(Current_Normal).HoaPrint,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("印刷" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"印刷" in Hoa)).HoaBackup}
                ,{Dept:"复合",View:Switch(First(Current_Normal).HoaComposite,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("复合" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"复合" in Hoa)).HoaBackup}
                ,{Dept:"分切",View:Switch(First(Current_Normal).HoaCutting,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("分切" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"分切" in Hoa)).HoaBackup}
                ,{Dept:"维修",View:Switch(First(Current_Normal).HoaMaintenance,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("维修" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"维修" in Hoa)).HoaBackup}
                ,{Dept:"仓库",View:Switch(First(Current_Normal).HoaWarehouse,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("仓库" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"仓库" in Hoa)).HoaBackup}
                ,{Dept:"质量",View:Switch(First(Current_Normal).HoaQuality,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("质量" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"质量" in Hoa)).HoaBackup}
                ,{Dept:"WCM",View:Switch(First(Current_Normal).HoaWCM,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("WCM" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"WCM" in Hoa)).HoaBackup}
                ,{Dept:"EHS",View:Switch(First(Current_Normal).HoaEHS,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("EHS" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"EHS" in Hoa)).HoaBackup}
                ,{Dept:"CBRE",View:Switch(First(Current_Normal).HoaCBRE,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("CBRE" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"CBRE" in Hoa)).HoaBackup});
                
                //统计会签部门审批状态
                
                Switch(Personal_Identity,
                "OpADeptLeader",//区域负责人
                If(!("待审批" in Concat(HoaApprovalMsg,View,";")),
                  If("拒绝" in Concat(HoaApprovalMsg,View,";"),
                    Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{OpALeaderView:"拒绝",OpALeaderDate:Today(),ProjState:"已拒绝"}),
                    Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{OpALeaderView:"同意",OpALeaderDate:Today(),OtherDept:Concat(Sort(Filter(OtherDeptMsg,View="待审批"),Dept,SortOrder.Ascending),ThisRecord.Dept,";")});
                    Refresh(TPL_NormalLicence);
                    Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{OtherDeptTotalView:If(IsBlank(LookUp(TPL_NormalLicence,ProjID=SearchID).OtherDept),"无需","")}); 
                    If(First(Filter(List_Login,Email=PersonalMsg.Email)).HasAccount=false&&(PersonalMsg.Email in First(Filter(List_Login,"CBRE" in Hod)).HodBackup||PersonalMsg.Email in First(Filter(List_Login,"CBRE" in Hoa)).HoaBackup|| PersonalMsg.Email = First(Filter(List_Login,"CBRE" in Hod)).Email||PersonalMsg.Email = First(Filter(List_Login,"CBRE" in Hoa)).Email),TPL_RAFA_WithoutAccount.Run(First(Current_Normal).ProjID),TPL_RemindApprovalFromApp.Run(First(Current_Normal).ProjID));
                );
                    ),
                  If("拒绝" in Concat(HoaApprovalMsg,View,";"),
                    Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID=SearchID),{OpALeaderView:"拒绝",OpALeaderDate:Today(),ProjState:"已拒绝"})
                    )
                )
                ;
                
                
                
                Refresh(TPL_NormalLicence);
                ClearCollect(Current_Normal,Filter(TPL_NormalLicence,ProjID=SearchID));
                
                
                //更新我的身份
                //(可以在表中找到我&该施工单的 申请部门 包含在我负责的部门中||我是申请部门负责人的备用负责人之一)&申请部门负责人意见为空（如果是审批人设置可见并设置身份）
                If((PersonalMsg.Email in First(Filter(TPL_Login,First(Current_Normal).ApplicationDept in Hod)).HodBackup
                ||(Not(IsEmpty(Filter(List_Login,Email=PersonalMsg.Email)))&&First(Current_Normal).ApplicationDept in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod))
                &&IsBlank(First(Current_Normal).ApplLeaderView),
                Set(Personal_Identity,"ApplDeptLeader"),
                
                //申请部门负责人意见为同意&区域负责人意见为空&施工单的 区域负责人 包含在我负责的区域中
                If(First(Current_Normal).ApplLeaderView="同意"
                &&IsBlank(First(Current_Normal).OpALeaderView)
                &&(First(Current_Normal).OpDept in First(Filter(List_Login,UserName=PersonalMsg.UserName)).Hoa
                ||PersonalMsg.Email in First(Filter(TPL_Login,First(Current_Normal).OpDept in Hoa)).HoaBackup),
                Set(Personal_Identity,"OpADeptLeader"),
                
                //需要其他部门会签&审批总状态为空白&(存在部门未审批并且isMine=true||存在部门未审批并且我是区域负责人负责部门的备用负责人之一)
                If(First(Current_Normal).IsOtherDept=true
                &&!IsBlank(First(Current_Normal).OpALeaderView)  //区域审批总状态不为空
                &&IsBlank(First(Current_Normal).OtherDeptTotalView)
                &&(!IsEmpty(Filter(OtherDeptMsg,View="待审批"&&isMine=true))
                ||!IsEmpty(Filter(OtherDeptMsg,View="待审批"&&AmIBackup=true))),
                Set(Personal_Identity,"OtherDeptLeader"),
                
                //判断EHS
                If(!IsBlank(First(Current_Normal).OtherDeptTotalView)  //OtherDeptTotalView=同意/无需
                &&IsBlank(First(Current_Normal).EHSView)   //EHS意见为空
                &&First(Current_Normal).ProjState<>"已拒绝"
                &&("EHS" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod//我是EHS负责人
                ||PersonalMsg.Email in First(Filter(List_Login,"EHS" in Hod)).HodBackup), //我是EHS备用负责人
                Set(Personal_Identity,"EHSLeader"),
                
                //判断厂长
                If(First(Current_Normal).NeedFactorDire//需要厂长
                &&First(Filter(List_Login,UserName=PersonalMsg.UserName)).IsFactoryDirector//我是厂长
                &&!IsBlank(First(Current_Normal).EHSView)//EHS意见不为空
                ,Set(Personal_Identity,"FactoryDirector"),
                
                //保安提供施工牌
                If(((First(Current_Normal).NeedFactorDire=true&&!IsBlank(First(Current_Normal).FactoryDirector))//需要厂长且厂长意见不为空
                ||(First(Current_Normal).NeedFactorDire=false&&!IsBlank(First(Current_Normal).EHSView))) //不需要厂长EHS意见不为空
                &&IsBlank(First(Current_Normal).ConstructionPlateID) //施工牌编号为空
                &&First(Current_Normal).ProjState<>"已拒绝"
                &&First(Filter(TPL_Login,PersonalMsg.Email=Email)).IsSecurityStaff=true, //我是保安
                Set(Personal_Identity,"SubSecurity"),
                
                //判断项目负责人
                If(First(Current_Normal).ProjState="审批通过"  //当前项目审批通过
                &&PersonalMsg.UserName=First(Current_Normal).ProjLeader  //我是项目负责人
                &&IsBlank(First(Current_Normal).ProjLeaderConfirm)  //ProjLeaderConfirm为空*项目负责人确认状态为空
                ,Set(Personal_Identity,"Confirm"),
                //判断保安
                If(!IsBlank(First(Current_Normal).ProjLeaderConfirm)  //ProjLeaderConfirm不为空*项目负责人确认状态不为空
                &&(IsBlank(First(Current_Normal).SecurityStaffConfirm)||(!IsBlank(First(Current_Normal).SecurityStaffConfirm)&&First(Current_Normal).IsReturn=false)),  //SecurityStaffConfirm为空*保安全人状态为空
                Set(Personal_Identity,"Security"),
                Set(Personal_Identity,"Normal")
                ))))))));
                
                Set(Vis_ApproveWhich,"None")
                );
                
                
                
                
                
            RadiusBottomLeft: =2
            RadiusBottomRight: =2
            RadiusTopLeft: =2
            RadiusTopRight: =2
            Size: =12
            Text: ="确认"
            Width: =102
            X: =30
            Y: =160
            ZIndex: =3

        Btn_ApproverConfCancel_1 As button:
            BorderThickness: =1
            Fill: =RGBA(116, 116, 116, 1)
            FocusedBorderThickness: =1
            FontWeight: =FontWeight.Normal
            Height: =28
            OnSelect: |-
                =//隐藏框
                Set(Vis_ApproveWhich,"None")
            RadiusBottomLeft: =2
            RadiusBottomRight: =2
            RadiusTopLeft: =2
            RadiusTopRight: =2
            Size: =12
            Text: ="取消"
            Width: =102
            X: =495
            Y: =160
            ZIndex: =4

        Radio_IsOtherDept As radio:
            BorderColor: =
            Default: =""
            FocusedBorderColor: =
            FocusedBorderThickness: =0
            Height: =48
            HoverColor: =
            Items: =["是","否"]
            Layout: =Layout.Horizontal
            PressedColor: =
            RadioSize: =24
            Size: =14
            Width: =153
            X: =233
            Y: =58
            ZIndex: =5

        ComboBox_OtherDept As combobox:
            BorderThickness: =1
            ChevronBackground: =RGBA(50, 86, 160, 1)
            DefaultSelectedItems: =
            DisplayFields: =["Value"]
            DisplayMode: |-
                =//选是显示部门，否和不选不显示
                Switch(Radio_IsOtherDept.Selected.Value,"是",DisplayMode.Edit,"否",DisplayMode.Disabled,DisplayMode.Disabled)
            Height: =30
            InputTextPlaceholder: ="选择会签部门"
            IsSearchable: =false
            Items: =Filter(Col_TotalDept,Value<>Dropdown_AppliDept_1.SelectedText.Value&&!(Value in TextInput_OpUnit_4.Text)&&Value<>"EHS")
            PaddingBottom: =0
            PaddingTop: =0
            SearchFields: =["Value"]
            SearchItems: =[]
            SelectionColor: =RGBA(0, 0, 0, 0)
            Size: =14
            Width: =360
            X: =129
            Y: =106
            ZIndex: =6

    Container_Refuse As groupContainer.manualLayoutContainer:
        BorderThickness: =2
        Fill: =RGBA(255, 255, 255, 1)
        Height: =229
        Visible: =Switch(Vis_ApproveWhich,"Agree",false,"Refuse",true,"AskOtherDept",false)
        Width: =630
        X: =5
        Y: =409
        ZIndex: =16

        Label8 As label:
            Height: =49
            PaddingLeft: =15
            Size: =14
            Text: ="请输入拒绝理由"
            Width: =617
            ZIndex: =1

        TextInput2 As text:
            Default: =""
            Height: =49
            HintText: ="文本输入"
            Size: =14
            Width: =560
            X: =30
            Y: =70
            ZIndex: =2

        Btn_ApproverRefuConf As button:
            BorderThickness: =1
            FocusedBorderThickness: =1
            FontWeight: =FontWeight.Normal
            Height: =28
            OnSelect: |-
                =//拒绝理由为空时弹出错误提示，不为空时上传后台&隐藏
                //同意后根据身份上传审批结果
                Switch(Personal_Identity,
                "ApplDeptLeader",If(IsBlank(TextInput2.Text)=true,Notify("拒绝理由不能为空！"),Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID = SearchID),{ApplLeaderView:TextInput2.Text,ApplLeaderDate:Today(),ProjState:"已拒绝",ApplLeaderName:PersonalMsg.UserName});Set(Vis_ApproveWhich,"None")),
                "OpADeptLeader",If(IsBlank(TextInput2.Text)=true,Notify("拒绝理由不能为空！"),Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID = SearchID),{OpALeaderView:TextInput2.Text,OpALeaderDate:Today(),ProjState:"已拒绝"});Set(Vis_ApproveWhich,"None");),
                "EHSLeader",If(IsBlank(TextInput2.Text)=true,Notify("拒绝理由不能为空！"),Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID = SearchID),{EHSView:TextInput2.Text,EHSDate:Today(),ProjState:"已拒绝",EHSName:PersonalMsg.UserName});Set(Vis_ApproveWhich,"None")),
                "FactoryDirector",If(IsBlank(TextInput2.Text)=true,Notify("拒绝理由不能为空！"),Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID = SearchID),{FactoryDirector:TextInput2.Text,FactoryDirectorTime:Today(),ProjState:"已拒绝"});Set(Vis_ApproveWhich,"None")));
                
                
                If(IsBlank(TextInput2.Text)=true,Notify("拒绝理由不能为空！"));
                //刷新表单
                Refresh(TPL_NormalLicence);
                ClearCollect(Current_Normal,Filter(TPL_NormalLicence,ProjID=SearchID));
                ClearCollect(Current_High,Filter(TPL_HighWork,ProjID=SearchID));
                ClearCollect(Current_Lifting,Filter(TPL_LiftingWork,ProjID=SearchID));
                ClearCollect(Current_ConfinedSpace,Filter(TPL_ConfinedSpaceWork,ProjID=SearchID));
                ClearCollect(Current_Hot,Filter(TPL_HotWork,ProjID=SearchID));
                ClearCollect(Current_TemporaryElectricity,Filter(TPL_TemporaryElectricityUseWork,ProjID=SearchID));
                
                
                
                //更新我的身份
                //(可以在表中找到我&该施工单的 申请部门 包含在我负责的部门中||我是申请部门负责人的备用负责人之一)&申请部门负责人意见为空（如果是审批人设置可见并设置身份）
                If((PersonalMsg.Email in First(Filter(TPL_Login,First(Current_Normal).ApplicationDept in Hod)).HodBackup
                ||(Not(IsEmpty(Filter(List_Login,Email=PersonalMsg.Email)))&&First(Current_Normal).ApplicationDept in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod))
                &&IsBlank(First(Current_Normal).ApplLeaderView),
                Set(Personal_Identity,"ApplDeptLeader"),
                
                //申请部门负责人意见为同意&区域负责人意见为空&施工单的 区域负责人 包含在我负责的区域中
                If(First(Current_Normal).ApplLeaderView="同意"
                &&IsBlank(First(Current_Normal).OpALeaderView)
                &&(First(Current_Normal).OpDept in First(Filter(List_Login,UserName=PersonalMsg.UserName)).Hoa
                ||PersonalMsg.Email in First(Filter(TPL_Login,First(Current_Normal).OpDept in Hoa)).HoaBackup),
                Set(Personal_Identity,"OpADeptLeader"),
                
                //需要其他部门会签&审批总状态为空白&存在部门未审批并且isMine=true
                If(First(Current_Normal).IsOtherDept=true
                &&IsBlank(First(Current_Normal).OtherDeptTotalView)
                &&!IsEmpty(Filter(OtherDeptMsg,View="待审批"&&isMine=true)),
                Set(Personal_Identity,"OtherDeptLeader"),
                
                //判断EHS
                If(!IsBlank(First(Current_Normal).OtherDeptTotalView)  //OtherDeptTotalView=同意/无需
                &&IsBlank(First(Current_Normal).EHSView)   //EHS意见为空
                &&First(Current_Normal).ProjState<>"已拒绝"
                &&("EHS" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod//我是EHS负责人
                ||PersonalMsg.Email in First(Filter(List_Login,Email=PersonalMsg.Email)).HodBackup), //我是EHS备用负责人
                Set(Personal_Identity,"EHSLeader"),
                
                //判断厂长
                If(First(Current_Normal).NeedFactorDire//需要厂长
                &&(First(Filter(List_Login,Email=PersonalMsg.Email)).IsFactoryDirector//我是厂长
                &&First(Filter(List_Login,Email=PersonalMsg.Email)).FactoryName=First(Current_Normal).FactoryName)//我是该厂长
                &&!IsBlank(First(Current_Normal).EHSView)//EHS意见不为空
                &&IsBlank(First(Current_Normal).FactoryDirector),//厂长意见为空,
                Set(Personal_Identity,"FactoryDirector"),
                //判断项目负责人
                If(Gallery2.Selected.ProjState="审批通过"  //当前项目审批通过
                &&PersonalMsg.UserName=Gallery2.Selected.ProjLeader  //我是项目负责人
                &&IsBlank(Gallery2.Selected.ProjLeaderConfirm)  //ProjLeaderConfirm 为空*项目负责人确认状态为空
                ,Set(Personal_Identity,"Confirm"),
                Set(Personal_Identity,"Normal")
                ))))));
            RadiusBottomLeft: =2
            RadiusBottomRight: =2
            RadiusTopLeft: =2
            RadiusTopRight: =2
            Size: =12
            Text: ="确认"
            Width: =102
            X: =30
            Y: =160
            ZIndex: =3

        Btn_ApproverRefuCancel As button:
            BorderThickness: =1
            Fill: =RGBA(116, 116, 116, 1)
            FocusedBorderThickness: =1
            FontWeight: =FontWeight.Normal
            Height: =28
            OnSelect: |-
                =//隐藏拒绝框
                Set(Vis_ApproveWhich,"None")
            RadiusBottomLeft: =2
            RadiusBottomRight: =2
            RadiusTopLeft: =2
            RadiusTopRight: =2
            Size: =12
            Text: ="取消"
            Width: =102
            X: =488
            Y: =160
            ZIndex: =4

    Container_Agree_Security As groupContainer.manualLayoutContainer:
        BorderThickness: =2
        Fill: =RGBA(255, 255, 255, 1)
        Height: =229
        Visible: =Switch(Vis_ApproveWhich,"Agree",false,"Refuse",false,"AskOtherDept",false,"AskSec",true)
        Width: =630
        X: =5
        Y: =409
        ZIndex: =17

        Btn_ApproverConfAgree_4 As button:
            BorderThickness: =1
            FocusedBorderThickness: =1
            FontWeight: =FontWeight.Normal
            Height: =28
            OnSelect: |+
                =//如果不输入内容则报错
                If(IsBlank(Radio_IsOtherDept_2.Selected.Value),Notify("请选择是否归还！"),
                Switch(Personal_Identity,"Security",
                Patch(TPL_NormalLicence,LookUp(TPL_NormalLicence,ProjID = SearchID),
                {SecurityStaffConfirm:"确认",
                IsReturn:Switch(Radio_IsOtherDept_2.Selected.Value,"是",true,"否",false),
                ProjState:"已完成"}
                );
                //Set(Personal_Identity,"Normal")
                );
                //隐藏框
                Set(Vis_ApproveWhich,"None");
                //刷新表单
                Refresh(TPL_NormalLicence);
                ClearCollect(Current_Normal,Filter(TPL_NormalLicence,ProjID=SearchID));
                ClearCollect(Current_High,Filter(TPL_HighWork,ProjID=SearchID));
                ClearCollect(Current_Lifting,Filter(TPL_LiftingWork,ProjID=SearchID));
                ClearCollect(Current_ConfinedSpace,Filter(TPL_ConfinedSpaceWork,ProjID=SearchID));
                ClearCollect(Current_Hot,Filter(TPL_HotWork,ProjID=SearchID));
                ClearCollect(Current_TemporaryElectricity,Filter(TPL_TemporaryElectricityUseWork,ProjID=SearchID));
                
                //哪些会签部门需要审批&我是该会签部门审批人
                ClearCollect(OtherDeptMsg
                ,{Dept:"生产",View:First(Current_Normal).OtherProduce,isMine:If("生产" in First(Filter(List_Login,UserName=PersonalMsg.UserName)).Hod,true,false),YesOrNo:""}
                ,{Dept:"印前",View:First(Current_Normal).OtherPrepress,isMine:If("印前" in First(Filter(List_Login,UserName=PersonalMsg.UserName)).Hod,true,false),YesOrNo:""}
                ,{Dept:"印刷",View:First(Current_Normal).OtherPrint,isMine:If("印刷" in First(Filter(List_Login,UserName=PersonalMsg.UserName)).Hod,true,false),YesOrNo:""}
                ,{Dept:"复合",View:First(Current_Normal).OtherComposite,isMine:If("复合" in First(Filter(List_Login,UserName=PersonalMsg.UserName)).Hod,true,false),YesOrNo:""}
                ,{Dept:"分切",View:First(Current_Normal).OtherCutting,isMine:If("分切" in First(Filter(List_Login,UserName=PersonalMsg.UserName)).Hod,true,false),YesOrNo:""}
                ,{Dept:"维修",View:First(Current_Normal).OtherMaintenance,isMine:If("维修" in First(Filter(List_Login,UserName=PersonalMsg.UserName)).Hod,true,false),YesOrNo:""}
                ,{Dept:"仓库",View:First(Current_Normal).OtherWarehouse,isMine:If("仓库" in First(Filter(List_Login,UserName=PersonalMsg.UserName)).Hod,true,false),YesOrNo:""}
                ,{Dept:"质量",View:First(Current_Normal).OtherQuality,isMine:If("质量" in First(Filter(List_Login,UserName=PersonalMsg.UserName)).Hod,true,false),YesOrNo:""}
                ,{Dept:"WCM",View:First(Current_Normal).OtherWCM,isMine:If("WCM" in First(Filter(List_Login,UserName=PersonalMsg.UserName)).Hod,true,false),YesOrNo:""}
                ,{Dept:"CBRE",View:First(Current_Normal).OtherCBRE,isMine:If("CBRE" in First(Filter(List_Login,UserName=PersonalMsg.UserName)).Hod,true,false),YesOrNo:""});
                
                
                );
                
                //(可以在表中找到我&该施工单的 申请部门 包含在我负责的部门中||我是申请部门负责人的备用负责人之一)&申请部门负责人意见为空（如果是审批人设置可见并设置身份）
                If((PersonalMsg.Email in First(Filter(TPL_Login,First(Current_Normal).ApplicationDept in Hod)).HodBackup
                ||(Not(IsEmpty(Filter(List_Login,Email=PersonalMsg.Email)))&&First(Current_Normal).ApplicationDept in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod))&&IsBlank(First(Current_Normal).ApplLeaderView),
                Set(Personal_Identity,"ApplDeptLeader"),
                
                //申请部门负责人意见为同意&区域负责人意见为空&（施工单的 区域负责人 包含在我负责的区域中||我是区域负责人负责部门的备用负责人之一)
                If(First(Current_Normal).ApplLeaderView="同意"
                &&IsBlank(First(Current_Normal).OpALeaderView)
                &&(First(Current_Normal).OpDept in First(Filter(List_Login,UserName=PersonalMsg.UserName)).Hoa
                ||PersonalMsg.Email in First(Filter(TPL_Login,First(Current_Normal).OpDept in Hoa)).HoaBackup),
                Set(Personal_Identity,"OpADeptLeader"),
                
                //需要其他部门会签&审批总状态为空白&(存在部门未审批并且isMine=true||存在部门未审批并且我是区域负责人负责部门的备用负责人之一)
                If(First(Current_Normal).IsOtherDept=true
                &&IsBlank(First(Current_Normal).OtherDeptTotalView)
                &&(!IsEmpty(Filter(OtherDeptMsg,View="待审批"&&isMine=true))||!IsEmpty(Filter(OtherDeptMsg,View="待审批"&&AmIBackup=true))),
                Set(Personal_Identity,"OtherDeptLeader"),
                
                //判断EHS
                If(!IsBlank(First(Current_Normal).OtherDeptTotalView)  //OtherDeptTotalView=同意/无需
                &&IsBlank(First(Current_Normal).EHSView)   //EHS意见为空
                &&First(Current_Normal).ProjState<>"已拒绝"
                &&("EHS" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod//我是EHS负责人
                ||PersonalMsg.Email in First(Filter(List_Login,"EHS" in Hod)).HodBackup), //我是EHS备用负责人
                Set(Personal_Identity,"EHSLeader"),
                
                //判断厂长
                If(First(Current_Normal).NeedFactorDire//需要厂长
                &&(First(Filter(List_Login,Email=PersonalMsg.Email)).IsFactoryDirector//我是厂长
                &&First(Filter(List_Login,Email=PersonalMsg.Email)).FactoryName=First(Current_Normal).FactoryName)//我是该厂长
                &&!IsBlank(First(Current_Normal).EHSView)//EHS意见不为空
                &&IsBlank(First(Current_Normal).FactoryDirector),//厂长意见为空
                Set(Personal_Identity,"FactoryDirector"),
                
                //保安提供施工牌
                If(((First(Current_Normal).NeedFactorDire=true&&!IsBlank(First(Current_Normal).FactoryDirector))//需要厂长且厂长意见不为空
                ||(First(Current_Normal).NeedFactorDire=false&&!IsBlank(First(Current_Normal).EHSView))) //不需要厂长EHS意见不为空
                &&IsBlank(First(Current_Normal).ConstructionPlateID) //施工牌编号为空
                &&First(Filter(TPL_Login,PersonalMsg.Email=Email)).IsSecurityStaff=true, //我是保安
                Set(Personal_Identity,"SubSecurity"),
                
                //判断项目负责人
                If(First(Current_Normal).ProjState="审批通过"  //当前项目审批通过
                &&PersonalMsg.UserName=First(Current_Normal).ProjLeader  //我是项目负责人
                &&IsBlank(First(Current_Normal).ProjLeaderConfirm)  //ProjLeaderConfirm为空*项目负责人确认状态为空
                ,Set(Personal_Identity,"Confirm"),
                
                //判断保安
                If(!IsBlank(First(Current_Normal).ProjLeaderConfirm)  //ProjLeaderConfirm不为空*项目负责人确认状态不为空
                &&(IsBlank(First(Current_Normal).SecurityStaffConfirm)||(!IsBlank(First(Current_Normal).SecurityStaffConfirm)&&First(Current_Normal).IsReturn=false)) //SecurityStaffConfirm为空*保安状态为空
                &&First(Filter(TPL_Login,PersonalMsg.Email=Email)).IsSecurityStaff=true, //我是保安
                Set(Personal_Identity,"Security"),
                Set(Personal_Identity,"Normal")
                
                ))))))));
                
                
                
            RadiusBottomLeft: =2
            RadiusBottomRight: =2
            RadiusTopLeft: =2
            RadiusTopRight: =2
            Size: =12
            Text: ="确认"
            Width: =102
            X: =30
            Y: =160
            ZIndex: =2

        Btn_ApproverConfCancel_4 As button:
            BorderThickness: =1
            Fill: =RGBA(116, 116, 116, 1)
            FocusedBorderThickness: =1
            FontWeight: =FontWeight.Normal
            Height: =28
            OnSelect: |-
                =//隐藏框
                Set(Vis_ApproveWhich,"None")
            RadiusBottomLeft: =2
            RadiusBottomRight: =2
            RadiusTopLeft: =2
            RadiusTopRight: =2
            Size: =12
            Text: ="取消"
            Width: =102
            X: =495
            Y: =160
            ZIndex: =3

        Label8_7 As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Bold
            Height: =49
            Size: =14
            Text: ="是否归还："
            Width: =165
            Y: =56
            ZIndex: =4

        Label9 As label:
            Height: =49
            Size: =14
            Text: =""
            Width: =380
            X: =165
            Y: =8
            ZIndex: =5

        Radio_IsOtherDept_2 As radio:
            BorderColor: =
            Default: =""
            FocusedBorderColor: =
            FocusedBorderThickness: =0
            Height: =51
            HoverColor: =
            Items: =["是","否"]
            Layout: =Layout.Horizontal
            PaddingBottom: =12
            PaddingTop: =12
            PressedColor: =
            RadioSize: =24
            Size: =14
            Width: =356
            X: =132
            Y: =57
            ZIndex: =6

