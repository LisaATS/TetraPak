DraftSearch As screen:
    OnVisible: |+
        =Set(SearchID,Gal_SearchDraft.Selected.ProjID);
        
        //刷新数据源
        Refresh(TPL_Login);
        ClearCollect(List_Login,TPL_Login);
        Refresh(TPL_NormalLicence);
        ClearCollect(Gal_Search_NormalLicence,TPL_NormalLicence);
        
        //刷新会签部门信息
        ClearCollect(Current_Normal,Filter(TPL_NormalLicence,ProjID=SearchID));
        ClearCollect(OtherDeptMsg
        ,{Dept:"生产",View:First(Current_Normal).OtherProduce,isMine:If("生产" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"生产" in Hod)).HodBackup}
        ,{Dept:"印前",View:First(Current_Normal).OtherPrepress,isMine:If("印前" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"印前" in Hod)).HodBackup}
        ,{Dept:"印刷",View:First(Current_Normal).OtherPrint,isMine:If("印刷" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"印刷" in Hod)).HodBackup}
        ,{Dept:"复合",View:First(Current_Normal).OtherComposite,isMine:If("复合" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"复合" in Hod)).HodBackup}
        ,{Dept:"分切",View:First(Current_Normal).OtherCutting,isMine:If("分切" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"分切" in Hod)).HodBackup}
        ,{Dept:"维修",View:First(Current_Normal).OtherMaintenance,isMine:If("维修" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"维修" in Hod)).HodBackup}
        ,{Dept:"仓库",View:First(Current_Normal).OtherWarehouse,isMine:If("仓库" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"仓库" in Hod)).HodBackup}
        ,{Dept:"质量",View:First(Current_Normal).OtherQuality,isMine:If("质量" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"质量" in Hod)).HodBackup}
        ,{Dept:"WCM",View:First(Current_Normal).OtherWCM,isMine:If("WCM" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"WCM" in Hod)).HodBackup}
        ,{Dept:"CBRE",View:First(Current_Normal).OtherCBRE,isMine:If("CBRE" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"CBRE" in Hod)).HodBackup});
        //区域负责人审批表
        ClearCollect(HoaApprovalMsg
        ,{Dept:"生产",View:Switch(First(Current_Normal).HoaProduce,"作业区域需审批","待审批"),isMine:If("生产" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"生产" in Hoa)).HoaBackup}
        ,{Dept:"印前",View:Switch(First(Current_Normal).HoaPrepress,"作业区域需审批","待审批"),isMine:If("印前" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"印前" in Hoa)).HoaBackup}
        ,{Dept:"印刷",View:Switch(First(Current_Normal).HoaPrint,"作业区域需审批","待审批"),isMine:If("印刷" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"印刷" in Hoa)).HoaBackup}
        ,{Dept:"复合",View:Switch(First(Current_Normal).HoaComposite,"作业区域需审批","待审批"),isMine:If("复合" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"复合" in Hoa)).HoaBackup}
        ,{Dept:"分切",View:Switch(First(Current_Normal).HoaCutting,"作业区域需审批","待审批"),isMine:If("分切" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"分切" in Hoa)).HoaBackup}
        ,{Dept:"维修",View:Switch(First(Current_Normal).HoaMaintenance,"作业区域需审批","待审批"),isMine:If("维修" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"维修" in Hoa)).HoaBackup}
        ,{Dept:"仓库",View:Switch(First(Current_Normal).HoaWarehouse,"作业区域需审批","待审批"),isMine:If("仓库" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"仓库" in Hoa)).HoaBackup}
        ,{Dept:"质量",View:Switch(First(Current_Normal).HoaQuality,"作业区域需审批","待审批"),isMine:If("质量" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"质量" in Hoa)).HoaBackup}
        ,{Dept:"WCM",View:Switch(First(Current_Normal).HoaWCM,"作业区域需审批","待审批"),isMine:If("WCM" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"WCM" in Hoa)).HoaBackup}
        ,{Dept:"EHS",View:Switch(First(Current_Normal).HoaEHS,"作业区域需审批","待审批"),isMine:If("EHS" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"EHS" in Hoa)).HoaBackup}
        ,{Dept:"CBRE",View:Switch(First(Current_Normal).HoaCBRE,"作业区域需审批","待审批"),isMine:If("CBRE" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"CBRE" in Hoa)).HoaBackup});
        

    Gal_SearchDraft As gallery.galleryVertical:
        BorderThickness: =1
        DelayItemLoading: =true
        Height: =832
        Items: |-
            =Filter(
            Sort(Gal_Search_NormalLicence,ProjID,SortOrder.Descending),
            (ProjState="审批中"||ProjState="草稿")
            &&PersonalMsg.UserName=ProjLeader
            &&IsBlank(ApplLeaderView)=true
            )
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        OnSelect: |-
            =Refresh(TPL_NormalLicence);
            Refresh(TPL_InfoGathering);
            Refresh(TPL_Login);
            ClearCollect(List_Login,TPL_Login);
            Set(SearchID,ThisItem.ProjID);//设置搜索ID
            
            /*
            
            //刷新会签部门信息
            
            ClearCollect(OtherDeptMsg
            ,{Dept:"生产",View:First(Current_Normal).OtherProduce,isMine:If("生产" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"生产" in Hod)).HodBackup}
            ,{Dept:"印前",View:First(Current_Normal).OtherPrepress,isMine:If("印前" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"印前" in Hod)).HodBackup}
            ,{Dept:"印刷",View:First(Current_Normal).OtherPrint,isMine:If("印刷" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"印刷" in Hod)).HodBackup}
            ,{Dept:"复合",View:First(Current_Normal).OtherComposite,isMine:If("复合" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"复合" in Hod)).HodBackup}
            ,{Dept:"分切",View:First(Current_Normal).OtherCutting,isMine:If("分切" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"分切" in Hod)).HodBackup}
            ,{Dept:"维修",View:First(Current_Normal).OtherMaintenance,isMine:If("维修" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"维修" in Hod)).HodBackup}
            ,{Dept:"仓库",View:First(Current_Normal).OtherWarehouse,isMine:If("仓库" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"仓库" in Hod)).HodBackup}
            ,{Dept:"质量",View:First(Current_Normal).OtherQuality,isMine:If("质量" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"质量" in Hod)).HodBackup}
            ,{Dept:"WCM",View:First(Current_Normal).OtherWCM,isMine:If("WCM" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"WCM" in Hod)).HodBackup}
            ,{Dept:"CBRE",View:First(Current_Normal).OtherCBRE,isMine:If("CBRE" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hod,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"CBRE" in Hod)).HodBackup});
            //区域负责人审批表
            ClearCollect(HoaApprovalMsg
            ,{Dept:"生产",View:Switch(First(Current_Normal).HoaProduce,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("生产" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"生产" in Hoa)).HoaBackup}
            ,{Dept:"印前",View:Switch(First(Current_Normal).HoaPrepress,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("印前" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"印前" in Hoa)).HoaBackup}
            ,{Dept:"印刷",View:Switch(First(Current_Normal).HoaPrint,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("印刷" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"印刷" in Hoa)).HoaBackup}
            ,{Dept:"复合",View:Switch(First(Current_Normal).HoaComposite,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("复合" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"复合" in Hoa)).HoaBackup}
            ,{Dept:"分切",View:Switch(First(Current_Normal).HoaCutting,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("分切" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"分切" in Hoa)).HoaBackup}
            ,{Dept:"维修",View:Switch(First(Current_Normal).HoaMaintenance,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("维修" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"维修" in Hoa)).HoaBackup}
            ,{Dept:"仓库",View:Switch(First(Current_Normal).HoaWarehouse,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("仓库" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"仓库" in Hoa)).HoaBackup}
            ,{Dept:"质量",View:Switch(First(Current_Normal).HoaQuality,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("质量" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"质量" in Hoa)).HoaBackup}
            ,{Dept:"WCM",View:Switch(First(Current_Normal).HoaWCM,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("WCM" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"WCM" in Hoa)).HoaBackup}
            ,{Dept:"EHS",View:Switch(First(Current_Normal).HoaEHS,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("EHS" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"EHS" in Hoa)).HoaBackup}
            ,{Dept:"CBRE",View:Switch(First(Current_Normal).HoaCBRE,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("CBRE" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"CBRE" in Hoa)).HoaBackup});
            
            
            */
        TemplateFill: =If(ThisItem.IsSelected,ColorFade(Color,0.8),RGBA(0, 0, 0, 0))
        TemplateSize: =31
        Width: =604
        X: =18
        Y: =190
        ZIndex: =3

        Label2_30 As label:
            Align: =Align.Center
            Height: =31
            OnSelect: =Select(Parent)
            Size: =11
            Text: =ThisItem.ProjID
            Width: =60
            ZIndex: =1

        Label2_31 As label:
            Align: =Align.Center
            Height: =30
            OnSelect: |
                =Select(Parent)
            Size: =11
            Text: =ThisItem.ProjLeader
            Width: =86
            X: =60
            ZIndex: =2

        Label2_35 As label:
            Align: =Align.Center
            Height: =31
            OnSelect: =Select(Parent)
            Size: =11
            Text: =ThisItem.ProjState
            Width: =69
            X: =520
            ZIndex: =3

        Rectangle3_19 As rectangle:
            Height: =30
            OnSelect: =Select(Parent)
            Visible: =ThisItem.IsSelected
            Width: =4
            ZIndex: =4

        Label2_32 As label:
            Height: =31
            OnSelect: |
                =Select(Parent)
            Size: =11
            Text: =ThisItem.ProjName
            Width: =243
            X: =146
            ZIndex: =5

        Label2_47 As label:
            Align: =Align.Center
            Height: =31
            OnSelect: =Select(Parent)
            Size: =11
            Text: =If(ThisItem.IsBackUp=true,"是","否")
            Width: =69
            X: =436
            ZIndex: =6

    ComboBox1_3 As combobox:
        BorderThickness: =1
        DisplayFields: =["ProjName"]
        FocusedBorderThickness: =1
        Height: =30
        InputTextPlaceholder: ="输入项目名称以搜索"
        IsSearchable: =false
        Items: |-
            =ShowColumns(Filter(TPL_NormalLicence,(ProjState="审批中"||ProjState="草稿")
            &&PersonalMsg.UserName=ProjLeader
            &&ApplLeaderView=Blank()),"ProjName")
        OnChange: =
        PaddingBottom: =0
        PaddingTop: =0
        SearchFields: =["ProjName"]
        SearchItems: =[]
        SelectMultiple: =false
        Size: =12
        Tooltip: =
        Width: =604
        X: =18
        Y: =42
        ZIndex: =4

    Label1_2 As label:
        Height: =28
        Size: =12
        Text: ="项目名称"
        Width: =235
        X: =18
        Y: =14
        ZIndex: =6

    Label1_8 As label:
        Height: =28
        Size: =12
        Text: ="项目状态"
        Width: =167
        X: =293
        Y: =73
        ZIndex: =10

    Dropdown1_3 As dropdown:
        BorderThickness: =1
        FocusedBorderThickness: =1
        Height: =30
        Items: =["草稿","审批中"]
        Size: =12
        Tooltip: =
        Width: =211
        X: =293
        Y: =101
        ZIndex: =11

    Btn_Search_1 As button:
        BorderThickness: =1
        FocusedBorderThickness: =1
        FontWeight: =FontWeight.Normal
        Height: =30
        OnSelect: |
            =ClearCollect(Gal_Search_NormalLicence,
            If(IsBlank(First(ComboBox1_3.SelectedItems).ProjName),
            Filter(TPL_NormalLicence,
            ProjState=Dropdown1_3.SelectedText.Value
            &&IsBackUp=Switch(Dropdown_IsBackUp_1.Selected.Value,"是",true,"否",false)),
            Filter(TPL_NormalLicence,
            ProjState=Dropdown1_3.SelectedText.Value
            &&ProjName=First(ComboBox1_3.SelectedItems).ProjName
            &&IsBackUp=Switch(Dropdown_IsBackUp_1.Selected.Value,"是",true,"否",false)
            )))
        RadiusBottomLeft: =2
        RadiusBottomRight: =2
        RadiusTopLeft: =2
        RadiusTopRight: =2
        Size: =12
        Text: ="搜索"
        Width: =102
        X: =520
        Y: =101
        ZIndex: =12

    Label1_9 As label:
        Height: =28
        Size: =11
        Text: ="项目编号"
        Width: =70
        X: =18
        Y: =162
        ZIndex: =13

    Label1_10 As label:
        Height: =28
        Size: =11
        Text: ="项目负责人"
        Width: =127
        X: =88
        Y: =162
        ZIndex: =14

    Label1_11 As label:
        Align: =Align.Center
        Height: =28
        Size: =11
        Text: ="项目状态"
        Width: =79
        X: =538
        Y: =162
        ZIndex: =15

    Btn_Look_1 As button:
        BorderThickness: =1
        DisplayMode: =If(Gal_SearchDraft.Selected.ProjState="草稿",DisplayMode.Edit,DisplayMode.Disabled)
        FocusedBorderThickness: =1
        FontWeight: =FontWeight.Normal
        Height: =30
        OnSelect: |+
            =Set(SearchID,Gal_SearchDraft.Selected.ProjID);//设置搜索ID
            
            
            
            
            Reset(DataCardValue_ConstructionSchemeTemporaryElectricity_1);
            Reset(DataCardValue_ConstructionSchemeHot_1);
            Reset(DataCardValue_ConstructionSchemeConfined_1);
            Reset(DataCardValue_ConstructionSchemeLifting_1);
            Reset(DataCardValue_ConstructionSchemeHigh_1);
            Reset(DataCardValue17_2);
            Reset(DataCardValue17_3);
            
            
            Reset(TextInput_ProjLeder_4);
            Reset(TextInput_OpUnit_7);
            Reset(Dropdown_AppliDept_2);
            Reset(TextInput_OpUnit_2);
            Reset(TextInput_ProjLeder_5);
            Reset('TextInput_ProjLederM/P_2');
            Reset(TextInput_OpDirector_3);
            Reset('TextInput_OpDirectorM/P_2');
            Reset(TextInput_OpDirector_4);
            Reset('TextInputTextInput_OnSiteGuardianM/P_2');
            Reset(DatePicker_StartDate_1);
            Reset(Dropdown_StartTime_3);
            Reset(Dropdown_StartTime_2);
            Reset(DatePicker_EndDate_1);
            Reset(Dropdown_EndTime_3);
            Reset(Dropdown_EndTime_2);
            Reset(ComboBox1_1);
            Reset(TextInput_OpAr_2);
            Reset(TextInput_MainTools_3);
            Reset(Checkbox_Heights_1);
            Reset(Checkbox_Hoisting_1);
            Reset(Checkbox_Limited_1);
            Reset(Checkbox_HotWork_1);
            Reset(Checkbox_TemporaryElectricity_1);
            Reset(TextInput_OpCountent_2);
            Reset(TextInput_OtherCoWoker_1);
            Reset(Radio_IsPatrol_1);
            Reset(TextInput_OpUnit1_2);
            Reset(TextInput_OnSiteGuardian1_2);
            Reset(TextInput_OpAr1_14);
            Reset(TextInput_OpAr1_15);
            Reset(TextInput_OpAr1_16);
            Reset(TextInput_OpCountent1_2);
            Reset(Radio_HWLevel_1);
            Reset(TextInput_HWHazard1_2);
            Reset(TextInput_HWHazard2_2);
            Reset(TextInput_HWHazard3_2);
            Reset(Checkbox_Tools1_1);
            Reset(Checkbox_Tools2_1);
            Reset(Checkbox_Tools3_1);
            Reset(TextInput_HWOtherTools_2);
            Reset(TextInput_SuspendedObject_2);
            Reset(TextInput_SuspendedObjectWeight_2);
            Reset(TextInput_LiftingCapacity_2);
            Reset(TextInput_LWHazard1_2);
            Reset(TextInput_LWHazard2_2);
            Reset(TextInput_LWHazard3_2);
            Reset(TextInput_CSW_Worker_2);
            Reset(TextInput_CSWHazard1_2);
            Reset(TextInput_CSWHazard2_2);
            Reset(TextInput_CSWHazard3_2);
            Reset(TextInput_Ventilation_1);
            Reset(TextInput_FWTools_2);
            Reset(TextInput_FWHazard1_2);
            Reset(TextInput_FWHazard2_2);
            Reset(TextInput_FWHazard3_3);
            Reset(Radio_FWLevel_2);
            Reset(Dropdown_OpDept_5);
            Reset(TextInput_FWHazard1_10);
            Reset(TextInput_FWHazard1_11);
            Reset(TextInput_FWHazard1_12);
            Reset(TextInput_FWOtherTool_2);
            Reset(TextInput_FWOtherToolNumber_2);
            Reset(TextInput_TotalLoad_2);
            Reset(TextInput_WorkingVoltage_2);
            Reset(TextInput_PowerAccessPoint_2);
            Reset(TextInput_TEUHazard1_2);
            Reset(TextInput_TEUHazard2_2);
            Reset(TextInput_TEUHazard3_2);
            
            Set(SearchID,Gal_SearchDraft.Selected.ProjID);
            Set(Personal_Identity,"Normal");//当点击查看时身份设置为普通
            Set(Vis_ApproveWhich,"None");//关闭确认和拒绝的弹窗
            Set(Vis_PDF,true);
            Set(Vis_Current,"Normal");
            Refresh(TPL_Login);
            ClearCollect(List_Login,TPL_Login);
            
            
            Refresh(TPL_NormalLicence);
            Refresh(TPL_HighWork);
            Refresh(TPL_HotWork);
            Refresh(TPL_LiftingWork);
            Refresh(TPL_ConfinedSpaceWork);
            Refresh(TPL_TemporaryElectricityUseWork);
            Refresh(TPL_InfoGathering);
            Refresh(TPL_Login);
            
            
            ClearCollect(List_Login,TPL_Login);
            
            ClearCollect(Current_Normal,Filter(TPL_NormalLicence,ProjID=SearchID));
            ClearCollect(Current_High,Filter(TPL_HighWork,ProjID=SearchID));
            ClearCollect(Current_Lifting,Filter(TPL_LiftingWork,ProjID=SearchID));
            ClearCollect(Current_ConfinedSpace,Filter(TPL_ConfinedSpaceWork,ProjID=SearchID));
            ClearCollect(Current_Hot,Filter(TPL_HotWork,ProjID=SearchID));
            ClearCollect(Current_TemporaryElectricity,Filter(TPL_TemporaryElectricityUseWork,ProjID=SearchID));
            
            
            
            Set(IsFirstDraft,true);
              
            Navigate(DraftEdit);
            /*
            //区域负责人审批表
            ClearCollect(HoaApprovalMsg
            ,{Dept:"生产",View:Switch(First(Current_Normal).HoaProduce,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("生产" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"生产" in Hoa)).HoaBackup}
            ,{Dept:"印前",View:Switch(First(Current_Normal).HoaPrepress,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("印前" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"印前" in Hoa)).HoaBackup}
            ,{Dept:"印刷",View:Switch(First(Current_Normal).HoaPrint,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("印刷" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"印刷" in Hoa)).HoaBackup}
            ,{Dept:"复合",View:Switch(First(Current_Normal).HoaComposite,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("复合" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"复合" in Hoa)).HoaBackup}
            ,{Dept:"分切",View:Switch(First(Current_Normal).HoaCutting,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("分切" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"分切" in Hoa)).HoaBackup}
            ,{Dept:"维修",View:Switch(First(Current_Normal).HoaMaintenance,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("维修" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"维修" in Hoa)).HoaBackup}
            ,{Dept:"仓库",View:Switch(First(Current_Normal).HoaWarehouse,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("仓库" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"仓库" in Hoa)).HoaBackup}
            ,{Dept:"质量",View:Switch(First(Current_Normal).HoaQuality,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("质量" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"质量" in Hoa)).HoaBackup}
            ,{Dept:"WCM",View:Switch(First(Current_Normal).HoaWCM,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("WCM" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"WCM" in Hoa)).HoaBackup}
            ,{Dept:"EHS",View:Switch(First(Current_Normal).HoaEHS,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("EHS" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"EHS" in Hoa)).HoaBackup}
            ,{Dept:"CBRE",View:Switch(First(Current_Normal).HoaCBRE,"作业区域需审批","待审批","作业区域审批通过","同意","作业区域审批拒绝","拒绝"),isMine:If("CBRE" in First(Filter(List_Login,Email=PersonalMsg.Email)).Hoa,true,false),YesOrNo:"",AmIBackup:PersonalMsg.Email in First(Filter(TPL_Login,"CBRE" in Hoa)).HoaBackup});
            
            */
            
            
            
            
            
        RadiusBottomLeft: =2
        RadiusBottomRight: =2
        RadiusTopLeft: =2
        RadiusTopRight: =2
        Size: =12
        Text: ="编辑草稿"
        Width: =102
        X: =520
        Y: =1038
        ZIndex: =16

    Btn_ReturnHome_1 As button:
        BorderThickness: =1
        FocusedBorderThickness: =1
        FontWeight: =FontWeight.Normal
        Height: =30
        OnSelect: =Navigate(home)
        RadiusBottomLeft: =2
        RadiusBottomRight: =2
        RadiusTopLeft: =2
        RadiusTopRight: =2
        Size: =12
        Text: ="返回主页"
        Width: =102
        X: =18
        Y: =1082
        ZIndex: =19

    Label1_15 As label:
        Height: =28
        Size: =11
        Text: ="项目名称"
        Width: =185
        X: =171
        Y: =162
        ZIndex: =21

    Btn_BackToDraft As button:
        BorderThickness: =1
        DisplayMode: =If(Gal_SearchDraft.Selected.ProjState="审批中",DisplayMode.Edit,DisplayMode.Disabled)
        FocusedBorderThickness: =1
        FontWeight: =FontWeight.Normal
        Height: =30
        OnSelect: |
            =Patch(TPL_NormalLicence,
            LookUp(TPL_NormalLicence,
            ID=Gal_SearchDraft.Selected.ID                         //所选的
            &&PersonalMsg.UserName=Gal_SearchDraft.Selected.ProjLeader     //我是申请人
            &&Gal_SearchDraft.Selected.ApplLeaderView=Blank()//申请部门负责人意见为空
            &&Gal_SearchDraft.Selected.ProjState="审批中"
            ),{ProjState:"草稿"});
            Refresh(TPL_NormalLicence);
            ClearCollect(Gal_Search_NormalLicence,TPL_NormalLicence);
        RadiusBottomLeft: =2
        RadiusBottomRight: =2
        RadiusTopLeft: =2
        RadiusTopRight: =2
        Size: =12
        Text: ="退回至草稿状态"
        Width: =135
        X: =18
        Y: =1038
        ZIndex: =22

    Label1_13 As label:
        Height: =28
        Size: =11
        Text: ="是否备案"
        Width: =79
        X: =459
        Y: =162
        ZIndex: =23

    Label1_16 As label:
        Height: =28
        Size: =12
        Text: ="是否备案"
        Width: =167
        X: =18
        Y: =72
        ZIndex: =24

    Dropdown_IsBackUp_1 As dropdown:
        BorderThickness: =1
        FocusedBorderThickness: =1
        Height: =29
        Items: =["是","否"]
        Size: =12
        Tooltip: =
        Width: =255
        X: =18
        Y: =101
        ZIndex: =25

